import{r as C,j as e}from"./vendor-react-wuMqdllU.js";import{J as R,n as S,e as A,a as o,B as c,k as f,F as T,G as z,H as O}from"./index-JZoliObr.js";import{C as k,c as D,a as E,b as U}from"./card-ByB4Hy19.js";import{b as B,g as G,d as I}from"./markdown-DZSA0cWY.js";import{a6 as N,d as b,b as F,Q as q,z as L,ab as h,n as w,o as u,ap as y,U as $,aq as v,ar as H,as as _,C as J,E as Q}from"./vendor-icons-CHGo4Fp8.js";import{d as W,a as K}from"./vendor-router-Cm8Qzw9U.js";import{f as j}from"./vendor-date-fns-D0ugVOfH.js";import"./vendor-markdown-C3iCDuOK.js";import"./vendor-recharts-tRgwS7-V.js";import"./vendor-radix-BCh4MJnw.js";import"./vendor-floating-ui-BD6aHMKr.js";const V={draft:"bg-gray-500/10 text-gray-700 border-gray-200",review:"bg-blue-500/10 text-blue-700 border-blue-200",approved:"bg-green-500/10 text-green-700 border-green-200",in_progress:"bg-yellow-500/10 text-yellow-700 border-yellow-200",completed:"bg-purple-500/10 text-purple-700 border-purple-200",implemented:"bg-emerald-500/10 text-emerald-700 border-emerald-200"},X={critical:"bg-red-500/10 text-red-700 border-red-200",high:"bg-orange-500/10 text-orange-700 border-orange-200",medium:"bg-yellow-500/10 text-yellow-700 border-yellow-200",low:"bg-gray-500/10 text-gray-700 border-gray-200"};function l({title:t,icon:n,children:s,defaultOpen:i=!0,badge:d}){const[m,p]=C.useState(i);return e.jsx(T,{open:m,onOpenChange:p,children:e.jsxs(k,{children:[e.jsx(z,{asChild:!0,children:e.jsx(E,{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(U,{className:"text-base sm:text-lg",children:t}),d!==void 0&&e.jsx(c,{variant:"secondary",className:"ml-2",children:d})]}),m?e.jsx(J,{className:"h-5 w-5 text-muted-foreground"}):e.jsx(Q,{className:"h-5 w-5 text-muted-foreground"})]})})}),e.jsx(O,{children:e.jsx(D,{className:"pt-0",children:s})})]})})}function Y({story:t,index:n}){return e.jsx("div",{className:"p-4 rounded-lg border bg-card",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 text-primary flex items-center justify-center text-sm font-medium",children:n+1}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"As a"})," ",t.persona,","," ",e.jsx("span",{className:"font-medium",children:"I want"})," ",t.action,","," ",e.jsx("span",{className:"font-medium",children:"so that"})," ",t.benefit]}),t.acceptanceCriteria&&t.acceptanceCriteria.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Acceptance Criteria"}),e.jsx("ul",{className:"space-y-1",children:t.acceptanceCriteria.map((s,i)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(u,{className:"h-4 w-4 text-green-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:s})]},i))})]})]})]})})}function Z({req:t}){return e.jsx("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx(c,{variant:"outline",className:"text-xs capitalize",children:t.type}),e.jsx(c,{variant:"outline",className:`text-xs ${X[t.priority]}`,children:t.priority})]}),e.jsx("p",{className:"text-sm",children:t.description})]})})}function ee({milestone:t,index:n}){return e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary/10 text-primary flex items-center justify-center text-xs font-medium",children:n+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm",children:t.title}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.description}),t.targetDate&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Target: ",j(new Date(t.targetDate),"MMM d, yyyy")]})]})]})}function oe(){const{id:t}=W(),n=K(),s=R(t||""),{initialize:i,deletePRD:d,isLoaded:m}=S(),{projects:p,initialize:g}=A();C.useEffect(()=>{i(),g()},[i,g]);const x=s!=null&&s.projectId?p.find(a=>a.id===s.projectId):null,M=()=>{if(!s)return;const a=B(s,{project:x||void 0}),r=`PRD-${G(s.featureName)}`;I(a,r),f.success("PRD exported to markdown")},P=async()=>{s&&confirm(`Delete PRD "${s.featureName}"?`)&&(await d(s.id),f.success("PRD deleted"),n("/prd"))};return e.jsx(e.Fragment,{children:m?s?e.jsxs("div",{className:"space-y-6 pb-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(o,{variant:"ghost",className:"w-fit -ml-2",onClick:()=>n("/prd"),children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Back to PRDs"]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:s.featureName}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap text-sm text-muted-foreground",children:[x&&e.jsx("span",{children:x.name}),x&&e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:s.area}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["v",s.version]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["by ",s.author]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(c,{variant:"outline",className:V[s.status],children:s.status.replace("_"," ")}),s.assignee&&e.jsx(c,{variant:"secondary",className:"capitalize",children:s.assignee}),s.estimatedEffort&&e.jsxs(c,{variant:"outline",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),s.estimatedEffort]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:M,children:[e.jsx(q,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export"})]}),e.jsxs(o,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive",onClick:P,children:[e.jsx(L,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Created ",j(new Date(s.createdAt),"MMM d, yyyy 'at' h:mm a")]}),s.updatedAt!==s.createdAt&&e.jsxs("span",{children:["• Updated ",j(new Date(s.updatedAt),"MMM d, yyyy 'at' h:mm a")]})]}),s.problemStatement&&e.jsx(l,{title:"Problem Statement",icon:h,defaultOpen:!0,children:e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:s.problemStatement})}),s.goals&&s.goals.length>0&&e.jsx(l,{title:"Goals",icon:w,badge:s.goals.length,children:e.jsx("ul",{className:"space-y-2",children:s.goals.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(u,{className:"h-4 w-4 text-green-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:a})]},r))})}),s.nonGoals&&s.nonGoals.length>0&&e.jsx(l,{title:"Non-Goals",icon:y,badge:s.nonGoals.length,defaultOpen:!1,children:e.jsx("ul",{className:"space-y-2",children:s.nonGoals.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(y,{className:"h-4 w-4 text-gray-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:a})]},r))})}),s.targetUsers&&e.jsx(l,{title:"Target Users",icon:$,defaultOpen:!0,children:e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:s.targetUsers})}),s.userStories&&s.userStories.length>0&&e.jsx(l,{title:"User Stories",icon:v,badge:s.userStories.length,children:e.jsx("div",{className:"space-y-4",children:s.userStories.map((a,r)=>e.jsx(Y,{story:a,index:r},a.id||r))})}),s.requirements&&s.requirements.length>0&&e.jsx(l,{title:"Requirements",icon:v,badge:s.requirements.length,children:e.jsx("div",{className:"space-y-3",children:s.requirements.map((a,r)=>e.jsx(Z,{req:a},a.id||r))})}),s.technicalApproach&&e.jsx(l,{title:"Technical Approach",icon:H,defaultOpen:!1,children:e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:s.technicalApproach})}),s.dependencies&&s.dependencies.length>0&&e.jsx(l,{title:"Dependencies",icon:b,badge:s.dependencies.length,defaultOpen:!1,children:e.jsx("ul",{className:"space-y-2",children:s.dependencies.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx("span",{children:a})]},r))})}),s.risks&&s.risks.length>0&&e.jsx(l,{title:"Risks",icon:h,badge:s.risks.length,defaultOpen:!1,children:e.jsx("ul",{className:"space-y-2",children:s.risks.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(h,{className:"h-4 w-4 text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:a})]},r))})}),s.milestones&&s.milestones.length>0&&e.jsx(l,{title:"Milestones",icon:_,badge:s.milestones.length,children:e.jsx("div",{className:"space-y-3",children:s.milestones.map((a,r)=>e.jsx(ee,{milestone:a,index:r},a.id||r))})}),s.successMetrics&&s.successMetrics.length>0&&e.jsx(l,{title:"Success Metrics",icon:w,badge:s.successMetrics.length,defaultOpen:!1,children:e.jsx("ul",{className:"space-y-2",children:s.successMetrics.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(u,{className:"h-4 w-4 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:a})]},r))})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(o,{variant:"ghost",onClick:()=>n("/prd"),children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Back to PRDs"]}),e.jsx(k,{className:"text-center",children:e.jsxs(D,{className:"pt-12 pb-12",children:[e.jsx(b,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"PRD not found"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"This PRD may have been deleted or doesn't exist."})]})})]}):e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})})})}export{oe as PrdDetailPage};
