import{r as b,j as e}from"./vendor-react-wuMqdllU.js";import{C as r,c}from"./card-BOU-q13f.js";import{S as C,a as M,b as _,c as I,d as m}from"./select-DW4QIkWb.js";import{i as w}from"./index-BJ9hpEov.js";import{j as g,q as F,v as S,aq as q,T as R,c as $}from"./vendor-icons-ssgfUAX_.js";function j(l){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(l)}function E(l){const a=new Date,x=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59);let n;switch(l){case"month":n=new Date(a.getFullYear(),a.getMonth(),1);break;case"quarter":{const u=Math.floor(a.getMonth()/3)*3;n=new Date(a.getFullYear(),u,1);break}case"year":n=new Date(a.getFullYear(),0,1);break;case"all":default:n=new Date(2e3,0,1);break}return{from:n,to:x}}function O(l){return{month:"Dieser Monat",quarter:"Dieses Quartal",year:"Dieses Jahr",all:"Gesamt"}[l]}function U({transactions:l,isLoading:a,className:x}){const[n,u]=b.useState("month"),t=b.useMemo(()=>{const o=E(n),d=l.filter(s=>{const i=new Date(s.booking_date);return i>=o.from&&i<=o.to}),h=d.length,f=d.filter(s=>s.match_status==="manual_matched"||s.match_status==="auto_matched"||s.match_status==="booked").length,v=d.filter(s=>s.match_status==="unmatched").length,y=d.filter(s=>s.match_status==="ignored").length,D=d.filter(s=>s.match_status==="auto_matched").length,k=h>0?f/h*100:0,N=d.filter(s=>s.amount>0).reduce((s,i)=>s+i.amount,0),p=d.filter(s=>s.amount<0).reduce((s,i)=>s+Math.abs(i.amount),0);return{total:h,matched:f,unmatched:v,ignored:y,autoMatched:D,matchRate:k,totalIncoming:N,totalOutgoing:p,net:N-p}},[l,n]);return e.jsxs("div",{className:w("space-y-4",x),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Kontenabstimmung"})]}),e.jsxs(C,{value:n,onValueChange:o=>u(o),children:[e.jsx(M,{className:"w-44",children:e.jsx(_,{})}),e.jsxs(I,{children:[e.jsx(m,{value:"month",children:"Dieser Monat"}),e.jsx(m,{value:"quarter",children:"Dieses Quartal"}),e.jsx(m,{value:"year",children:"Dieses Jahr"}),e.jsx(m,{value:"all",children:"Gesamt"})]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsx(r,{children:e.jsxs(c,{className:"pt-4 pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wider",children:"Transaktionen"}),e.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx("p",{className:"text-2xl font-bold",children:t.total}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:O(n)})]})}),e.jsx(r,{children:e.jsxs(c,{className:"pt-4 pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wider",children:"Zuordnungsrate"}),e.jsx(F,{className:"h-4 w-4 text-green-500"})]}),e.jsxs("p",{className:"text-2xl font-bold",children:[t.matchRate.toFixed(1),"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[t.matched," von ",t.total," zugeordnet"]})]})}),e.jsx(r,{children:e.jsxs(c,{className:"pt-4 pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wider",children:"Offen"}),e.jsx(S,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:t.unmatched}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Noch zuzuordnen"})]})}),e.jsx(r,{children:e.jsxs(c,{className:"pt-4 pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wider",children:"Ignoriert"}),e.jsx(q,{className:"h-4 w-4 text-gray-400"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-500",children:t.ignored}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Irrelevante Umsätze"})]})})]}),e.jsx(r,{children:e.jsxs(c,{className:"py-4",children:[e.jsx("div",{className:"flex items-center gap-4 mb-3",children:e.jsx("span",{className:"text-sm font-medium",children:"Zuordnungsstatus"})}),e.jsx("div",{className:"h-4 bg-gray-100 rounded-full overflow-hidden flex",children:t.total>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-green-500 transition-all duration-500",style:{width:`${t.matched/t.total*100}%`},title:`Zugeordnet: ${t.matched}`}),e.jsx("div",{className:"bg-yellow-400 transition-all duration-500",style:{width:`${t.unmatched/t.total*100}%`},title:`Offen: ${t.unmatched}`}),e.jsx("div",{className:"bg-gray-300 transition-all duration-500",style:{width:`${t.ignored/t.total*100}%`},title:`Ignoriert: ${t.ignored}`})]})}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500"}),"Zugeordnet (",t.matched,")"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-yellow-400"}),"Offen (",t.unmatched,")"]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-gray-300"}),"Ignoriert (",t.ignored,")"]})]})]})}),e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3",children:[e.jsx(r,{children:e.jsxs(c,{className:"py-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(R,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:"Eingänge"})]}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:j(t.totalIncoming)})]})}),e.jsx(r,{children:e.jsxs(c,{className:"py-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx($,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:"Ausgänge"})]}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:j(t.totalOutgoing)})]})}),e.jsx(r,{children:e.jsxs(c,{className:"py-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(g,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:"Netto"})]}),e.jsx("p",{className:w("text-xl font-bold",t.net>=0?"text-green-600":"text-red-600"),children:j(t.net)})]})})]})]})}export{U as B};
