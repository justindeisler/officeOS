import{r,j as e}from"./vendor-react-wuMqdllU.js";import{e as H,f as te,B as _,a as h,m as Q,u as le,L as x,I as k,k as ne}from"./index-BJ9hpEov.js";import{S as p,a as j,b as f,c as v,d as n}from"./select-DW4QIkWb.js";import{C as re,c as ie}from"./card-BOU-q13f.js";import{D as de,a as ce,b as oe,c as R,d as me}from"./dropdown-menu-Dz1PdlGq.js";import{C as Y}from"./confirm-delete-dialog-D3P6PPsQ.js";import{D as xe,Q as he,V as ue,a1 as ge,a6 as pe,G as q,W as je,t as W,F as fe}from"./vendor-icons-ssgfUAX_.js";import{L as K}from"./vendor-router-Cm8Qzw9U.js";import{f as S,o as ve}from"./vendor-date-fns-D0ugVOfH.js";import{D as we,a as ye,b as Ne,c as be,d as De,e as Ce}from"./dialog-BPcAFwmD.js";import{T as Se}from"./textarea-D5YM9rKe.js";import{a as Pe,g as Ee,d as ke}from"./markdown-DZSA0cWY.js";import"./vendor-markdown-C3iCDuOK.js";import"./vendor-recharts-tRgwS7-V.js";import"./vendor-radix-DqeMb71O.js";import"./vendor-floating-ui-BD6aHMKr.js";import"./alert-dialog-CMM_3WOV.js";const Ie={pipeline:"bg-blue-500/10 text-blue-500 border-blue-500/20",active:"bg-green-500/10 text-green-500 border-green-500/20",on_hold:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",completed:"bg-gray-500/10 text-gray-500 border-gray-500/20",cancelled:"bg-red-500/10 text-red-500 border-red-500/20"},Ae={pipeline:"Pipeline",active:"Active",on_hold:"On Hold",completed:"Completed",cancelled:"Cancelled"},Fe={wellfy:"bg-purple-500/10 text-purple-500 border-purple-500/20",freelance:"bg-orange-500/10 text-orange-500 border-orange-500/20",personal:"bg-cyan-500/10 text-cyan-500 border-cyan-500/20"};function Me(a,i){return new Intl.NumberFormat("de-DE",{style:"currency",currency:i}).format(a)}function Te({project:a,onEdit:i}){const{deleteProject:s}=H(),c=te(a.clientId||""),[w,d]=r.useState(!1),y=()=>{s(a.id),d(!1)};return e.jsxs(re,{className:"group",children:[e.jsx(ie,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx(K,{to:`/projects/${a.id}`,className:"font-medium truncate hover:underline hover:text-primary min-h-[44px] flex items-center",children:a.name})}),c&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2 truncate",children:c.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2 mb-3",children:[e.jsx(_,{variant:"outline",className:`${Ie[a.status]} text-xs`,children:Ae[a.status]}),e.jsx(_,{variant:"outline",className:`${Fe[a.area]} text-xs`,children:a.area})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4 text-xs text-muted-foreground",children:[a.budgetAmount&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:Me(a.budgetAmount,a.budgetCurrency)})]}),a.targetEndDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"h-3 w-3"}),e.jsx("span",{className:"whitespace-nowrap",children:S(new Date(a.targetEndDate),"MMM d, yyyy")})]})]})]}),e.jsxs(de,{children:[e.jsx(ce,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"h-10 w-10 min-h-[44px] min-w-[44px] opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity shrink-0",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsxs(oe,{align:"end",children:[e.jsx(R,{asChild:!0,children:e.jsxs(K,{to:`/projects/${a.id}`,children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"View Details"]})}),e.jsxs(R,{onClick:()=>i(a),children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx(me,{}),e.jsxs(R,{onClick:()=>d(!0),className:"text-destructive focus:text-destructive",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})}),e.jsx(Y,{open:w,onOpenChange:d,title:`Delete "${a.name}"?`,description:"This will permanently delete the project. This action cannot be undone.",onConfirm:y})]})}function Be({open:a,onOpenChange:i,project:s,onClose:c}){const{addProject:w,updateProject:d,deleteProject:y}=H(),{clients:u}=Q(),{tasks:P}=le(),[N,b]=r.useState(""),[g,D]=r.useState(""),[t,o]=r.useState("none"),[m,I]=r.useState("pipeline"),[z,A]=r.useState("freelance"),[F,M]=r.useState(""),[G,T]=r.useState("EUR"),[B,O]=r.useState(""),[V,$]=r.useState(""),[J,U]=r.useState(!1),C=!!s;r.useEffect(()=>{var l;s?(b(s.name),D(s.description||""),o(s.clientId||"none"),I(s.status),A(s.area),M(((l=s.budgetAmount)==null?void 0:l.toString())||""),T(s.budgetCurrency),O(s.startDate?S(new Date(s.startDate),"yyyy-MM-dd"):""),$(s.targetEndDate?S(new Date(s.targetEndDate),"yyyy-MM-dd"):"")):(b(""),D(""),o("none"),I("pipeline"),A("freelance"),M(""),T("EUR"),O(S(new Date,"yyyy-MM-dd")),$(S(ve(new Date,1),"yyyy-MM-dd")))},[s,a]);const X=l=>{if(l.preventDefault(),!N.trim())return;const E={name:N.trim(),description:g.trim()||void 0,clientId:t==="none"?void 0:t,status:m,area:z,budgetAmount:F?parseFloat(F):void 0,budgetCurrency:G,startDate:B?new Date(B).toISOString():void 0,targetEndDate:V?new Date(V).toISOString():void 0};C&&s?d(s.id,E):w(E),c()},Z=()=>{s&&(y(s.id),U(!1),c())},ee=()=>{if(!s)return;const l=s.clientId?u.find(L=>L.id===s.clientId):void 0,E=P.filter(L=>L.projectId===s.id),se=Pe(s,{client:l,tasks:E}),ae=Ee(s.name);ke(se,ae),ne.success(`Exported "${s.name}" to markdown`)};return e.jsx(we,{open:a,onOpenChange:i,children:e.jsxs(ye,{className:"w-[calc(100vw-2rem)] max-w-[500px] max-h-[90vh] overflow-y-auto",children:[e.jsxs("form",{onSubmit:X,children:[e.jsxs(Ne,{children:[e.jsx(be,{children:C?"Edit Project":"New Project"}),e.jsx(De,{children:C?"Update the project details below.":"Create a new project to track work and time."})]}),e.jsxs("div",{className:"grid gap-4 py-4 max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"name",children:"Name *"}),e.jsx(k,{id:"name",value:N,onChange:l=>b(l.target.value),placeholder:"Project name...",autoFocus:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"description",children:"Description"}),e.jsx(Se,{id:"description",value:g,onChange:l=>D(l.target.value),placeholder:"Project description...",rows:2})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"client",children:"Client"}),e.jsxs(p,{value:t,onValueChange:o,children:[e.jsx(j,{children:e.jsx(f,{placeholder:"Select a client..."})}),e.jsxs(v,{children:[e.jsx(n,{value:"none",children:"No client"}),u.map(l=>e.jsx(n,{value:l.id,children:l.name},l.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"status",children:"Status"}),e.jsxs(p,{value:m,onValueChange:l=>I(l),children:[e.jsx(j,{children:e.jsx(f,{})}),e.jsxs(v,{children:[e.jsx(n,{value:"pipeline",children:"Pipeline"}),e.jsx(n,{value:"active",children:"Active"}),e.jsx(n,{value:"on_hold",children:"On Hold"}),e.jsx(n,{value:"completed",children:"Completed"}),e.jsx(n,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"area",children:"Area"}),e.jsxs(p,{value:z,onValueChange:l=>A(l),children:[e.jsx(j,{children:e.jsx(f,{})}),e.jsxs(v,{children:[e.jsx(n,{value:"wellfy",children:"Wellfy"}),e.jsx(n,{value:"freelance",children:"Freelance"}),e.jsx(n,{value:"personal",children:"Personal"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"budgetAmount",children:"Budget"}),e.jsx(k,{id:"budgetAmount",type:"number",min:"0",step:"0.01",value:F,onChange:l=>M(l.target.value),placeholder:"0.00"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"currency",children:"Currency"}),e.jsxs(p,{value:G,onValueChange:T,children:[e.jsx(j,{children:e.jsx(f,{})}),e.jsxs(v,{children:[e.jsx(n,{value:"EUR",children:"EUR"}),e.jsx(n,{value:"USD",children:"USD"}),e.jsx(n,{value:"GBP",children:"GBP"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"startDate",children:"Start Date"}),e.jsx(k,{id:"startDate",type:"date",value:B,onChange:l=>O(l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"targetEndDate",children:"Target End Date"}),e.jsx(k,{id:"targetEndDate",type:"date",value:V,onChange:l=>$(l.target.value)})]})]})]}),e.jsxs(Ce,{className:"flex justify-between",children:[C&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{type:"button",variant:"destructive",size:"sm",onClick:()=>U(!0),children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),"Delete"]}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:ee,children:[e.jsx(je,{className:"h-4 w-4 mr-1"}),"Export"]})]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsx(h,{type:"button",variant:"outline",onClick:c,children:"Cancel"}),e.jsx(h,{type:"submit",children:C?"Save":"Create"})]})]})]},(s==null?void 0:s.id)??`new-${a}`),e.jsx(Y,{open:J,onOpenChange:U,title:`Delete ${s==null?void 0:s.name}?`,description:"This will permanently delete the project. This action cannot be undone.",onConfirm:Z})]})})}const Oe=[{id:"pipeline",title:"Pipeline",color:"bg-blue-500"},{id:"active",title:"Active",color:"bg-green-500"},{id:"on_hold",title:"On Hold",color:"bg-yellow-500"},{id:"completed",title:"Completed",color:"bg-gray-500"}];function es(){const{projects:a,filter:i,setFilter:s}=H(),{clients:c}=Q(),[w,d]=r.useState(!1),[y,u]=r.useState(null),P=()=>{u(null),d(!0)},N=t=>{u(t),d(!0)},b=()=>{d(!1),u(null)},g=r.useMemo(()=>{const t=a.filter(m=>!(i.area!=="all"&&m.area!==i.area||i.clientId!=="all"&&m.clientId!==i.clientId)),o={pipeline:[],active:[],on_hold:[],completed:[],cancelled:[]};return t.forEach(m=>{m.status!=="cancelled"&&o[m.status].push(m)}),o},[a,i]),D=a.filter(t=>t.status!=="cancelled").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Projects"})}),e.jsxs(h,{onClick:P,className:"w-full sm:w-auto min-h-[44px]",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"New Project"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap items-stretch sm:items-center gap-3",children:[e.jsxs(p,{value:i.area,onValueChange:t=>s({area:t}),children:[e.jsx(j,{className:"w-full sm:w-[150px] min-h-[44px]",children:e.jsx(f,{placeholder:"All Areas"})}),e.jsxs(v,{children:[e.jsx(n,{value:"all",children:"All Areas"}),e.jsx(n,{value:"wellfy",children:"Wellfy"}),e.jsx(n,{value:"freelance",children:"Freelance"}),e.jsx(n,{value:"personal",children:"Personal"})]})]}),c.length>0&&e.jsxs(p,{value:i.clientId,onValueChange:t=>s({clientId:t}),children:[e.jsx(j,{className:"w-full sm:w-[180px] min-h-[44px]",children:e.jsx(f,{placeholder:"All Clients"})}),e.jsxs(v,{children:[e.jsx(n,{value:"all",children:"All Clients"}),c.map(t=>e.jsx(n,{value:t.id,children:t.name},t.id))]})]})]}),D===0?e.jsxs("div",{className:"rounded-lg border bg-card p-8 sm:p-12 text-center",children:[e.jsx(fe,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No projects yet"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Create your first project to start tracking work."}),e.jsxs(h,{onClick:P,className:"min-h-[44px]",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"New Project"]})]}):e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 md:grid md:grid-cols-2 lg:grid-cols-4 md:overflow-visible md:pb-0",children:Oe.map(t=>e.jsxs("div",{className:"min-w-[280px] flex-shrink-0 md:min-w-0 rounded-lg border bg-muted/30 p-4 min-h-[400px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${t.color}`}),e.jsx("h3",{className:"font-medium",children:t.title})]}),e.jsx(_,{variant:"secondary",children:g[t.id].length})]}),e.jsx("div",{className:"space-y-3",children:g[t.id].length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No projects"}):g[t.id].map(o=>e.jsx(Te,{project:o,onEdit:N},o.id))})]},t.id))}),e.jsx(Be,{open:w,onOpenChange:d,project:y,onClose:b})]})}export{es as ProjectsPage};
