import{r as l,j as e}from"./vendor-react-DeR5d9Tv.js";import{c as X,m as C,a as F,n as P,a6 as b,B as y,j as S,F as A,C as $,r as Y,I as J,X as Q,a5 as W}from"./index-RJ0cNIvj.js";import{C as h,c as p}from"./card-DIHf8IPz.js";import{M as Z}from"./MarkdownRenderer-DFdYV13P.js";import{A as ee}from"./arrow-left-CLbhYuej.js";import{C as z}from"./chevron-right-CcuX3k2-.js";import{A as se,m as N}from"./vendor-framer-motion-5hIM_3P7.js";import{H as D}from"./hash-BuW8bXkS.js";import{S as te}from"./search-Tukd7Kqk.js";import{B as ae}from"./briefcase-CcyY-yMa.js";import{S as re}from"./shield-9-zPRDhl.js";import{F as E}from"./folder-open-D8bl207p.js";import{L as O}from"./lock-tGSCkSn2.js";import{n as R,f as ie}from"./vendor-date-fns-D0ugVOfH.js";import"./vendor-markdown-PIr_2kdo.js";import"./vendor-recharts-DrMJw15s.js";import"./vendor-radix-zn9KX-y8.js";import"./vendor-floating-ui-CESiY8Ey.js";import"./vendor-router-9bGSKQ4q.js";import"./link-2-BGRgx1pW.js";import"./external-link-B4yigKcm.js";import"./check-mFeD-rYu.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=X("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),k=[.16,1,.3,1],T={persona:{icon:re,label:"Persona",color:"text-blue-500"},learning:{icon:le,label:"Learning System",color:"text-purple-500"},memory:{icon:W,label:"Memory",color:"text-amber-500"},specialist:{icon:ae,label:"Specialist Docs",color:"text-emerald-500"}};function Be(){const[r,c]=l.useState([]),[a,m]=l.useState(null),[o,x]=l.useState(null),[s,d]=l.useState("grid"),[u,f]=l.useState(!0),[j,v]=l.useState(!1),[n,L]=l.useState(!1),[w,G]=l.useState(""),[H,M]=l.useState(null);l.useEffect(()=>{I()},[]);const I=async()=>{try{f(!0),M(null);const t=await C.getAgents();c(t.agents)}catch(t){console.error("Failed to load agents:",t),M("Failed to load agents.")}finally{f(!1)}},V=async t=>{try{v(!0);const i=await C.getAgentDetail(t.id);m({...t,...i,files:i.files}),d("profile")}catch(i){console.error("Failed to load agent profile:",i)}finally{v(!1)}},_=async(t,i)=>{try{L(!0);const g=await C.getAgentFileContent(t,i.category,i.name);x({content:g.content,title:g.title,category:i.category,name:i.name,encrypted:g.encrypted}),d("file")}catch(g){console.error("Failed to load file:",g)}finally{L(!1)}},q=()=>{s==="file"?(x(null),d("profile")):s==="profile"&&(m(null),d("grid"))},B=l.useMemo(()=>{if(!(a!=null&&a.files))return[];if(!w.trim())return a.files;const t=w.toLowerCase();return a.files.filter(i=>i.name.toLowerCase().includes(t)||i.title.toLowerCase().includes(t)||i.category.toLowerCase().includes(t))},[a==null?void 0:a.files,w]),K=l.useMemo(()=>{const t={};for(const i of B)t[i.category]||(t[i.category]=[]),t[i.category].push(i);return t},[B]),U=l.useMemo(()=>{const t=[{label:"Agent Space",onClick:()=>{d("grid"),m(null),x(null)}}];return a&&t.push({label:`${a.emoji} ${a.name}`,onClick:s==="file"?()=>{d("profile"),x(null)}:void 0}),o&&t.push({label:o.name}),t},[a,o,s]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s!=="grid"&&e.jsx(F,{variant:"ghost",size:"icon",onClick:q,className:"shrink-0",children:e.jsx(ee,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(P,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-1 text-sm",children:U.map((t,i)=>e.jsxs("span",{className:"flex items-center gap-1",children:[i>0&&e.jsx(z,{className:"h-3.5 w-3.5 text-muted-foreground"}),t.onClick?e.jsx("button",{onClick:t.onClick,className:"text-muted-foreground hover:text-foreground transition-colors",children:t.label}):e.jsx("span",{className:"font-medium",children:t.label})]},i))}),s==="grid"&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.length," agents in your team"]})]})]})]})}),e.jsxs(se,{mode:"wait",children:[s==="grid"&&e.jsx(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2,ease:k},children:e.jsx(ne,{agents:r,isLoading:u,error:H,isLoadingProfile:j,onSelectAgent:V,onRetry:I})},"grid"),s==="profile"&&a&&e.jsx(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:k},children:e.jsx(ce,{agent:a,groupedFiles:K,searchQuery:w,onSearchChange:G,onSelectFile:t=>_(a.id,t),isLoadingFile:n})},"profile"),s==="file"&&o&&a&&e.jsx(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2,ease:k},children:e.jsx(oe,{file:o,agent:a})},"file")]})]})}function ne({agents:r,isLoading:c,error:a,isLoadingProfile:m,onSelectAgent:o,onRetry:x}){return c?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(s=>e.jsx(h,{children:e.jsxs(p,{className:"p-6 space-y-4",children:[e.jsx(b,{className:"h-12 w-12 rounded-xl"}),e.jsx(b,{className:"h-5 w-24"}),e.jsx(b,{className:"h-4 w-32"}),e.jsx(b,{className:"h-8 w-full"})]})},s))}):a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(P,{className:"h-16 w-16 mx-auto text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a}),e.jsx(F,{variant:"outline",size:"sm",className:"mt-3",onClick:x,children:"Retry"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map(s=>e.jsx(N.div,{whileHover:{y:-2},whileTap:{scale:.98},children:e.jsxs(h,{className:"cursor-pointer hover:border-primary/30 transition-all duration-200 group relative overflow-hidden",onClick:()=>o(s),children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1",style:{backgroundColor:s.status==="active"?s.color:"transparent"}}),e.jsxs(p,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"text-3xl p-2 rounded-xl",style:{backgroundColor:`${s.color}15`},children:s.emoji}),e.jsx(y,{variant:s.status==="active"?"default":"secondary",className:S("text-xs",s.status==="active"&&"bg-green-500/10 text-green-600 border-green-500/20"),children:s.status==="active"?"● Active":"○ Idle"})]}),e.jsx("h3",{className:"font-semibold text-lg mb-0.5",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:s.role}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(D,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[s.sessionCount," sessions"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(A,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[s.fileCount," files"]})]})]}),s.lastActivity&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-3 flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),R(new Date(s.lastActivity),{addSuffix:!0})]}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity",children:m?e.jsx(Y,{className:"h-5 w-5 animate-spin text-muted-foreground"}):e.jsx(z,{className:"h-5 w-5 text-muted-foreground"})})]})]})},s.id))})}function ce({agent:r,groupedFiles:c,searchQuery:a,onSearchChange:m,onSelectFile:o,isLoadingFile:x}){var d;const s=((d=r.files)==null?void 0:d.length)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(h,{children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"text-4xl p-3 rounded-2xl shrink-0",style:{backgroundColor:`${r.color}15`},children:r.emoji}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:r.name}),e.jsx(y,{variant:r.status==="active"?"default":"secondary",className:S("text-xs",r.status==="active"&&"bg-green-500/10 text-green-600 border-green-500/20"),children:r.status==="active"?"● Active":"○ Idle"})]}),e.jsx("p",{className:"text-muted-foreground",children:r.role}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(D,{className:"h-4 w-4"}),r.sessionCount," sessions"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(A,{className:"h-4 w-4"}),s," files"]}),r.lastActivity&&e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx($,{className:"h-4 w-4"}),"Active ",R(new Date(r.lastActivity),{addSuffix:!0})]})]})]})]})})}),e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(te,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(J,{placeholder:"Search files...",value:a,onChange:u=>m(u.target.value),className:"pl-9 pr-9"}),a&&e.jsx(F,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7",onClick:()=>m(""),children:e.jsx(Q,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-6",children:[Object.entries(c).map(([u,f])=>{const j=T[u]||{icon:A,label:u,color:"text-foreground"},v=j.icon;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(v,{className:S("h-5 w-5",j.color)}),e.jsx("h3",{className:"font-semibold",children:j.label}),e.jsx(y,{variant:"secondary",className:"text-xs",children:f.length})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:f.map(n=>e.jsx(N.div,{whileHover:{y:-1},whileTap:{scale:.99},children:e.jsx(h,{className:"cursor-pointer hover:border-primary/30 transition-all duration-200 group",onClick:()=>o(n),children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(E,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx("span",{className:"text-sm font-medium truncate",children:n.title})]}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono truncate",children:n.name})]}),n.encrypted&&e.jsx(O,{className:"h-4 w-4 text-amber-500 shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[(n.size/1024).toFixed(1)," KB"]}),e.jsx("span",{children:ie(new Date(n.lastModified),"MMM d, yyyy")})]})]})})},`${n.category}-${n.name}`))})]},u)}),Object.keys(c).length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"h-12 w-12 mx-auto text-muted-foreground/30 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a?"No files match your search":"No files found for this agent"})]})]})]})}function oe({file:r,agent:c}){const a=T[r.category]||{label:r.category};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(h,{children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl p-2 rounded-xl shrink-0",style:{backgroundColor:`${c.color}15`},children:c.emoji}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold truncate",children:r.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(y,{variant:"outline",className:"text-xs capitalize",children:a.label}),e.jsx("span",{className:"text-xs text-muted-foreground font-mono",children:r.name}),r.encrypted&&e.jsxs(y,{variant:"secondary",className:"text-xs",children:[e.jsx(O,{className:"h-3 w-3 mr-1"}),"Encrypted"]})]})]})]})})}),e.jsx(h,{children:e.jsx(p,{className:"p-6 md:p-8",children:e.jsx(Z,{content:r.content})})})]})}export{Be as AgentSpacePage};
