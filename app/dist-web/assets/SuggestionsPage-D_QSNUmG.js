import{r,j as e}from"./vendor-react-nkeu7MKf.js";import{C as se,a as te,b as ae,c as re}from"./card-D8X7W2A-.js";import{c as Le,j as m,k as i,q as J,a as c,l as ze,A as ge,B as S,F as le,X as U}from"./index-BCss7V-g.js";import{T as Se,a as ke,b as E,c as O}from"./tabs-D9Phi9Ql.js";import{D as Pe,a as De,b as Ae,c as Fe,d as Te,e as Ee}from"./dialog-CM34_OL7.js";import{S as k,a as P,b as D,c as A,d,C as je}from"./select-DhlqQLw_.js";import{T as Oe}from"./textarea-HZgEQNMS.js";import{S as ce}from"./sparkles-E7b9KWVp.js";import{F as fe}from"./folder-open-CjiXQvAY.js";import{C as Ve}from"./circle-alert-Dajb761d.js";import{S as $e}from"./search-4mdeVgr5.js";import{R as He}from"./refresh-cw-B2orLsoU.js";import{C as Be}from"./circle-check-URyyGq-1.js";import{A as qe}from"./archive-CBKmBjgI.js";import{F as ne}from"./filter-CGFPy4zC.js";import{E as Ue}from"./external-link-CnG-E0dg.js";import{M as Je}from"./message-square-BjXrR5gA.js";import{T as Ke}from"./trash-2-vPxsxJ7L.js";import{S as We}from"./send-BbhmT32S.js";import{P as Xe}from"./play-attlbkPf.js";import{R as ve}from"./rotate-ccw-DR1o70_Z.js";import{a as Qe}from"./vendor-router-bCYKpmtI.js";import{f as ie,n as Ye}from"./vendor-date-fns-D0ugVOfH.js";import"./vendor-markdown-zaQAhtrl.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-DCQ-pcr5.js";import"./vendor-floating-ui-_Y3uXdsy.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=Le("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]),Ne={"32b4b44b-a6f9-46c1-bc56-0ec819d766a1":"~/projects/personal-assistant","974c45ac-82f0-4e66-9403-94071d9da454":"~/projects/wellfy","wellfy-lms":"~/projects/wellfy","aba3c4c3-cdaa-466c-a7f3-210f70dbb852":"~/projects/backend-diabetesnotes","022d19f7-e15d-4c65-ba85-528033ab5d44":"~/projects/dot1","6fa57ff7-547a-48b7-bff9-cf27c333fc82":"~/projects/supplement-webshop"};function es({isOpen:u,onClose:x,onGenerate:b}){const[h,V]=r.useState("pa-projects"),[t,F]=r.useState(null),[$,p]=r.useState(!1),[T,K]=r.useState([]),[R,G]=r.useState([]),[H,M]=r.useState(!1),[w,_]=r.useState(!1),[v,N]=r.useState(null),o=r.useCallback(async()=>{M(!0);try{const g=(await m.getProjects()).filter(j=>j.status==="active"||j.status==="pipeline");K(g)}catch{i.error("Failed to load projects")}finally{M(!1)}},[]),y=r.useCallback(async()=>{_(!0),N(null);try{const a=await m.getGitHubRepos();G(a.repos||[]),a.message&&(!a.repos||a.repos.length===0)&&N(a.message)}catch{N("Failed to fetch GitHub repos")}finally{_(!1)}},[]);r.useEffect(()=>{u&&(o(),y(),F(null),p(!1))},[u,o,y]),r.useEffect(()=>{F(null)},[h]);function I(){var a;return h==="pa-projects"?((a=T.find(g=>g.id===t))==null?void 0:a.name)??"Unknown":t??"Unknown"}function C(){if(h==="pa-projects"&&t)return Ne[t]}const B=()=>{t&&b({source:h==="pa-projects"?"pa-project":"github",projectId:t,projectName:I(),projectPath:C(),deepMode:$,count:3})},L=({id:a,name:g,description:j,extra:z})=>e.jsxs("label",{className:ze("flex items-start gap-3 rounded-lg border p-3 cursor-pointer transition-colors",t===a?"border-primary bg-primary/5 ring-1 ring-primary/30":"border-border hover:bg-muted/50"),children:[e.jsx("input",{type:"radio",name:"project-select",value:a,checked:t===a,onChange:()=>F(a),className:"mt-1 h-4 w-4 accent-primary"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-sm",children:g}),z&&e.jsx("span",{className:"text-xs text-muted-foreground",children:z})]}),j&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 line-clamp-2",children:j})]})]});return e.jsx(Pe,{open:u,onOpenChange:a=>!a&&x(),children:e.jsxs(De,{className:"max-w-lg",children:[e.jsxs(Ae,{children:[e.jsxs(Fe,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5 text-primary"}),"Generate New Suggestions"]}),e.jsx(Te,{children:"Select a project to analyze and generate 3 AI-powered improvement suggestions."})]}),e.jsxs(Se,{value:h,onValueChange:V,children:[e.jsxs(ke,{className:"grid w-full grid-cols-2",children:[e.jsxs(E,{value:"pa-projects",className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"PA Projects"]}),e.jsxs(E,{value:"github",className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),"GitHub"]})]}),e.jsx(O,{value:"pa-projects",className:"mt-3",children:H?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(J,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):T.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[e.jsx(fe,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No active projects found."]}):e.jsx("div",{className:"space-y-2 max-h-[280px] overflow-y-auto pr-1",children:T.map(a=>e.jsx(L,{id:a.id,name:a.name,description:a.description,extra:Ne[a.id]?"ðŸ“":void 0},a.id))})}),e.jsx(O,{value:"github",className:"mt-3",children:w?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(J,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):v&&R.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[e.jsx(Ve,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:v})]}):R.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[e.jsx($e,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No repos found."]}):e.jsx("div",{className:"space-y-2 max-h-[280px] overflow-y-auto pr-1",children:R.map(a=>e.jsx(L,{id:a.name,name:a.name,description:a.description||null,extra:new Date(a.updatedAt).toLocaleDateString()},a.name))})})]}),e.jsxs("label",{className:"flex items-center gap-2 mt-1 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",checked:$,onChange:a=>p(a.target.checked),className:"h-4 w-4 rounded accent-primary"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Deep Mode",e.jsx("span",{className:"ml-1 text-xs opacity-75",children:"(slower, more detailed analysis)"})]})]}),e.jsxs(Ee,{className:"gap-2 sm:gap-0",children:[e.jsx(c,{variant:"outline",onClick:x,children:"Cancel"}),e.jsxs(c,{onClick:B,disabled:!t,children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Generate (3)"]})]})]})})}const be={pending:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-400",approved:"bg-green-500/10 text-green-700 dark:text-green-400",rejected:"bg-red-500/10 text-red-700 dark:text-red-400",implemented:"bg-purple-500/10 text-purple-700 dark:text-purple-400"},we={improvement:"bg-blue-500/10 text-blue-700 dark:text-blue-400",feature:"bg-green-500/10 text-green-700 dark:text-green-400",fix:"bg-red-500/10 text-red-700 dark:text-red-400",refactor:"bg-purple-500/10 text-purple-700 dark:text-purple-400",security:"bg-orange-500/10 text-orange-700 dark:text-orange-400"},ye={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Minimal"};function Ce(u){const x=new Date(u.created_at);return(new Date().getTime()-x.getTime())/(1e3*60*60)<24}function ss(){const[u,x]=r.useState("");return r.useEffect(()=>{const b=setInterval(()=>{x(h=>h.length>=3?"":h+".")},500);return()=>clearInterval(b)},[]),e.jsx("span",{className:"inline-block w-[1.2em] text-left",children:u})}function As(){const u=Qe(),[x,b]=r.useState([]),[h,V]=r.useState(!0),[t,F]=r.useState(null),[$,p]=r.useState(!1),[T,K]=r.useState("active"),[R,G]=r.useState(!1),[H,M]=r.useState(!1),[w,_]=r.useState(!1),[v,N]=r.useState("newest"),[o,y]=r.useState("all"),[I,C]=r.useState([]),[B,L]=r.useState(!1),[a,g]=r.useState(""),[j,z]=r.useState(!1),f=async()=>{V(!0);try{const s=await m.getSuggestions({limit:100});b(s)}catch(s){console.error("Failed to fetch suggestions:",s),i.error("Failed to load suggestions")}finally{V(!1)}},oe=r.useCallback(async s=>{L(!0);try{const l=await m.getSuggestionComments(s);C(l)}catch(l){console.error("Failed to fetch comments:",l),C([])}finally{L(!1)}},[]),Re=async s=>{G(!1),M(!0);try{const l=await m.generateSuggestions(s);if(l.success){const n=l.duration?` in ${(l.duration/1e3).toFixed(1)}s`:"";i.success(`Generated 3 suggestions for ${s.projectName}${n}`),await f()}else i.error("Generation failed. Try again.")}catch(l){const n=l instanceof Error?l.message:"Unknown error";n.includes("504")||n.includes("timed out")?i.error("Generation took too long. Try without Deep Mode."):i.error(`Failed to generate suggestions: ${n}`)}finally{M(!1)}},de=async()=>{if(!(!t||!a.trim())){z(!0);try{await m.addSuggestionComment(t.id,a.trim()),g(""),await oe(t.id),i.success("Comment added")}catch{i.error("Failed to add comment")}finally{z(!1)}}},Ge=async s=>{if(t)try{await m.deleteSuggestionComment(s),C(l=>l.filter(n=>n.id!==s)),i.success("Comment deleted")}catch{i.error("Failed to delete comment")}};r.useEffect(()=>{f()},[]);const W=Array.from(new Set(x.map(s=>s.project_name).filter(Boolean))).sort(),X=s=>{let l=s;return o!=="all"&&(l=l.filter(n=>n.project_name===o)),l.sort((n,Ie)=>{const pe=new Date(n.created_at).getTime(),ue=new Date(Ie.created_at).getTime();return v==="newest"?ue-pe:pe-ue})},Q=X(x.filter(s=>s.status==="pending"||s.status==="approved")),Y=X(x.filter(s=>s.status==="implemented")),Z=X(x.filter(s=>s.status==="rejected")),me=async s=>{try{await m.approveSuggestion(s),i.success("Suggestion confirmed!"),f(),p(!1)}catch{i.error("Failed to confirm suggestion")}},q=async s=>{try{await m.rejectSuggestion(s),i.success("Suggestion archived"),f(),p(!1)}catch{i.error("Failed to archive suggestion")}},xe=async s=>{try{await m.updateSuggestion(s,{status:"pending"}),i.success("Suggestion restored"),f()}catch{i.error("Failed to restore suggestion")}},Me=async s=>{try{await m.implementSuggestion(s),i.success("Suggestion marked as implemented"),f(),p(!1)}catch{i.error("Failed to mark as implemented")}},he=async s=>{_(!0);try{const l=await m.createPrdFromSuggestion(s);l.success&&(i.success("PRD created successfully!",{description:"Click to view the generated PRD",action:{label:"View PRD",onClick:()=>u(`/prd/${l.prdId}`)},duration:8e3}),f(),p(!1))}catch(l){const n=l instanceof Error?l.message:"Unknown error";n.includes("409")||n.includes("already exists")?i.error("A PRD already exists for this suggestion"):n.includes("504")||n.includes("timed out")?i.error("PRD generation timed out. Please try again."):i.error(`Failed to create PRD: ${n}`)}finally{_(!1)}},_e=s=>{F(s),C([]),g(""),p(!0),oe(s.id)};if(h)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})});const ee=({suggestion:s,showRestore:l=!1})=>e.jsxs("div",{onClick:()=>_e(s),className:"flex items-start justify-between p-4 rounded-lg border bg-card hover:bg-muted/50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"space-y-1 flex-1 min-w-0 mr-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:s.title}),Ce(s)&&e.jsx(S,{className:"bg-primary text-primary-foreground text-[10px] px-1.5 py-0",children:"New"}),e.jsx(S,{variant:"outline",className:we[s.type]||"",children:s.type}),e.jsx(S,{variant:"outline",className:be[s.status]||"",children:s.status})]}),s.project_name&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Project: ",s.project_name]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Priority: ",ye[s.priority]||s.priority]}),e.jsxs("span",{children:["Created: ",ie(new Date(s.created_at),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex gap-2 shrink-0",children:[s.status==="pending"&&s.canImplement&&e.jsxs(e.Fragment,{children:[e.jsx(c,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 dark:hover:bg-green-950",onClick:n=>{n.stopPropagation(),me(s.id)},title:"Approve (auto-implement)",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx(c,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:n=>{n.stopPropagation(),q(s.id)},title:"Decline",children:e.jsx(U,{className:"h-4 w-4"})})]}),s.status==="pending"&&!s.canImplement&&e.jsxs(e.Fragment,{children:[e.jsx(c,{size:"sm",variant:"outline",className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-950",onClick:n=>{n.stopPropagation(),he(s.id)},title:"Create PRD",disabled:w,children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(c,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:n=>{n.stopPropagation(),q(s.id)},title:"Decline",children:e.jsx(U,{className:"h-4 w-4"})})]}),l&&e.jsx(c,{size:"sm",variant:"outline",className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-950",onClick:n=>{n.stopPropagation(),xe(s.id)},title:"Restore",children:e.jsx(ve,{className:"h-4 w-4"})})]})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight flex items-center gap-2",children:[e.jsx(ge,{className:"h-7 w-7"}),"Suggestions"]}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Review and manage James's improvement suggestions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:f,children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsx(c,{size:"sm",onClick:()=>G(!0),disabled:H,className:"min-w-[160px]",children:H?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing",e.jsx(ss,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"New Suggestions"]})})]})]}),e.jsxs(Se,{value:T,onValueChange:K,className:"w-full",children:[e.jsxs(ke,{className:"grid w-full max-w-lg grid-cols-3",children:[e.jsxs(E,{value:"active",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Active (",Q.length,")"]}),e.jsxs(E,{value:"implemented",className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Implemented (",Y.length,")"]}),e.jsxs(E,{value:"archived",className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4"}),"Archived (",Z.length,")"]})]}),e.jsx(O,{value:"active",className:"mt-6",children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(ae,{className:"text-lg",children:"Active Suggestions"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(k,{value:o,onValueChange:y,children:[e.jsxs(P,{className:"w-[180px]",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),e.jsx(D,{placeholder:"All Projects"})]}),e.jsxs(A,{children:[e.jsx(d,{value:"all",children:"All Projects"}),W.map(s=>e.jsx(d,{value:s,children:s},s))]})]}),e.jsxs(k,{value:v,onValueChange:s=>N(s),children:[e.jsx(P,{className:"w-[130px]",children:e.jsx(D,{})}),e.jsxs(A,{children:[e.jsx(d,{value:"newest",children:"Newest First"}),e.jsx(d,{value:"oldest",children:"Oldest First"})]})]})]})]})}),e.jsx(re,{children:Q.length===0?e.jsx("p",{className:"text-muted-foreground text-sm text-center py-8",children:o!=="all"?`No active suggestions for ${o}. Try a different filter.`:"No active suggestions. James will create suggestions based on project analysis."}):e.jsx("div",{className:"space-y-3",children:Q.map(s=>e.jsx(ee,{suggestion:s},s.id))})})]})}),e.jsx(O,{value:"implemented",className:"mt-6",children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(ae,{className:"text-lg",children:"Implemented Suggestions"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(k,{value:o,onValueChange:y,children:[e.jsxs(P,{className:"w-[180px]",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),e.jsx(D,{placeholder:"All Projects"})]}),e.jsxs(A,{children:[e.jsx(d,{value:"all",children:"All Projects"}),W.map(s=>e.jsx(d,{value:s,children:s},s))]})]}),e.jsxs(k,{value:v,onValueChange:s=>N(s),children:[e.jsx(P,{className:"w-[130px]",children:e.jsx(D,{})}),e.jsxs(A,{children:[e.jsx(d,{value:"newest",children:"Newest First"}),e.jsx(d,{value:"oldest",children:"Oldest First"})]})]})]})]})}),e.jsx(re,{children:Y.length===0?e.jsx("p",{className:"text-muted-foreground text-sm text-center py-8",children:o!=="all"?`No implemented suggestions for ${o}. Try a different filter.`:"No implemented suggestions yet. Completed improvements will appear here."}):e.jsx("div",{className:"space-y-3",children:Y.map(s=>e.jsx(ee,{suggestion:s},s.id))})})]})}),e.jsx(O,{value:"archived",className:"mt-6",children:e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(ae,{className:"text-lg",children:"Archived Suggestions"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(k,{value:o,onValueChange:y,children:[e.jsxs(P,{className:"w-[180px]",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),e.jsx(D,{placeholder:"All Projects"})]}),e.jsxs(A,{children:[e.jsx(d,{value:"all",children:"All Projects"}),W.map(s=>e.jsx(d,{value:s,children:s},s))]})]}),e.jsxs(k,{value:v,onValueChange:s=>N(s),children:[e.jsx(P,{className:"w-[130px]",children:e.jsx(D,{})}),e.jsxs(A,{children:[e.jsx(d,{value:"newest",children:"Newest First"}),e.jsx(d,{value:"oldest",children:"Oldest First"})]})]})]})]})}),e.jsx(re,{children:Z.length===0?e.jsx("p",{className:"text-muted-foreground text-sm text-center py-8",children:o!=="all"?`No archived suggestions for ${o}. Try a different filter.`:"No archived suggestions. Declined suggestions will appear here."}):e.jsx("div",{className:"space-y-3",children:Z.map(s=>e.jsx(ee,{suggestion:s,showRestore:!0},s.id))})})]})})]}),e.jsx(Pe,{open:$,onOpenChange:p,children:e.jsx(De,{className:"max-w-2xl max-h-[85vh] overflow-hidden p-0 sm:p-0 gap-0 flex flex-col",children:t&&e.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 sm:p-6 overscroll-contain",style:{WebkitOverflowScrolling:"touch"},children:[e.jsxs(Ae,{className:"mb-4 pr-8",children:[e.jsxs(Fe,{className:"flex items-center gap-2 flex-wrap",children:[t.title,e.jsx(S,{variant:"outline",className:we[t.type]||"",children:t.type})]}),e.jsx(Te,{children:t.project_name&&e.jsxs("span",{children:["Project: ",t.project_name]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Ce(t)&&e.jsx(S,{className:"bg-primary text-primary-foreground text-[10px] px-1.5 py-0",children:"New"}),e.jsx(S,{variant:"outline",className:be[t.status]||"",children:t.status}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Priority: ",ye[t.priority]||t.priority]})]}),t.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap max-h-48 sm:max-h-none overflow-y-auto",children:t.description})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:["Created: ",ie(new Date(t.created_at),"PPpp")]}),t.decided_at&&e.jsxs("p",{children:["Decided: ",ie(new Date(t.decided_at),"PPpp")]})]}),t.prd_id&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800 p-3",children:[e.jsx(le,{className:"h-4 w-4 text-blue-600 dark:text-blue-400 shrink-0"}),e.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300 flex-1",children:"A PRD has been generated for this suggestion."}),e.jsxs(c,{variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400",onClick:()=>{p(!1),u(`/prd/${t.prd_id}`)},children:[e.jsx(Ue,{className:"h-3.5 w-3.5 mr-1"}),"View PRD"]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h4",{className:"font-medium text-sm mb-3 flex items-center gap-2",children:[e.jsx(Je,{className:"h-4 w-4"}),"Comments ",!B&&`(${I.length})`]}),B?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-primary border-t-transparent"})}):I.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-3",children:"No comments yet"}):e.jsx("div",{className:"space-y-3 mb-4 max-h-64 overflow-y-auto overscroll-contain",children:I.map(s=>e.jsxs("div",{className:"group rounded-lg border bg-muted/30 p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap flex-1",children:s.comment_text}),e.jsx(c,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity text-muted-foreground hover:text-destructive shrink-0",onClick:()=>Ge(s.id),title:"Delete comment",children:e.jsx(Ke,{className:"h-3.5 w-3.5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:s.author}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Â· ",Ye(new Date(s.created_at),{addSuffix:!0})]})]})]},s.id))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(Oe,{placeholder:"Add implementation notes or requirements...",value:a,onChange:s=>g(s.target.value),className:"min-h-[60px] sm:min-h-[72px] resize-none text-sm flex-1",onKeyDown:s=>{s.key==="Enter"&&(s.metaKey||s.ctrlKey)&&(s.preventDefault(),de())}}),e.jsx(c,{size:"sm",variant:"outline",className:"shrink-0 sm:self-end self-stretch",disabled:!a.trim()||j,onClick:de,title:"Add comment (âŒ˜+Enter)",children:j?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-4 w-4 sm:mr-0 mr-2"}),e.jsx("span",{className:"sm:hidden",children:"Add Comment"})]})})]})]}),t.status==="pending"&&t.canImplement&&e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(c,{variant:"outline",className:"flex-1 text-green-600 hover:text-green-700 hover:bg-green-50 dark:hover:bg-green-950",onClick:()=>me(t.id),children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Approve"]}),e.jsxs(c,{variant:"outline",className:"flex-1 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:()=>q(t.id),children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Decline"]})]}),t.status==="pending"&&!t.canImplement&&e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(c,{variant:"default",className:"flex-1",onClick:()=>he(t.id),disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating PRDâ€¦"]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Create PRD"]})}),e.jsxs(c,{variant:"outline",className:"flex-1 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:()=>q(t.id),disabled:w,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Decline"]})]}),t.status==="approved"&&e.jsx("div",{className:"flex gap-2 pt-4 border-t",children:e.jsxs(c,{variant:"default",className:"flex-1",onClick:()=>Me(t.id),children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Mark as Implemented"]})}),t.status==="rejected"&&e.jsx("div",{className:"flex gap-2 pt-4 border-t",children:e.jsxs(c,{variant:"outline",className:"flex-1 text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-950",onClick:()=>{xe(t.id),p(!1)},children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Restore"]})})]})]})})}),e.jsx(es,{isOpen:R,onClose:()=>G(!1),onGenerate:Re})]})}export{As as SuggestionsPage};
