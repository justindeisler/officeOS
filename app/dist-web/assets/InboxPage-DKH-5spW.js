import{j as e,r as c}from"./vendor-react-DeR5d9Tv.js";import{E as H,B as v,s as q,o as S,G,a as j,H as K,u as U,f as X,L as N,I as Y,J as ee,K as se,Z as B,M as E}from"./index-B9wpeZVf.js";import{T as ae,a as te,b as J,c as O}from"./tabs-DfLUlg96.js";import{C as ie,c as re}from"./card-Do3Kg1xk.js";import{D as ne,a as le,b as oe,c as T,d as V}from"./dropdown-menu-B1dqlQ89.js";import{C as ce}from"./confirm-delete-dialog-LuDEhVpD.js";import{n as de}from"./vendor-date-fns-D0ugVOfH.js";import{C as R}from"./check-BOz78U_D.js";import{C as me}from"./circle-alert-DR10Pc3C.js";import{E as xe}from"./external-link-DW0qQmWJ.js";import{A as W}from"./arrow-right-MAJQ11IA.js";import{E as he}from"./ellipsis-BZkAk9tt.js";import{T as pe}from"./trash-2-BAQCKdVR.js";import{M as je}from"./message-square-BG2lzqiu.js";import{C as ge}from"./calendar-BXLbKi9j.js";import{S as ue,Q as fe}from"./QuickCaptureDialog-Bw4g0slC.js";import{L as Ne}from"./list-todo-CoAB3JnI.js";import{a as ve}from"./vendor-router-9bGSKQ4q.js";import{D as be,a as we,b as Ce,c as ke,d as ye,e as De}from"./dialog-FtNsGa4T.js";import{T as Se}from"./textarea-CZihQ_1Z.js";import{S as P,a as _,b as I,c as F,d as o}from"./select-BY8eQiQN.js";import{A as z}from"./archive-Bp1sEw5_.js";import"./vendor-markdown-PIr_2kdo.js";import"./vendor-recharts-DrMJw15s.js";import"./vendor-radix-sPo3_CXI.js";import"./vendor-floating-ui-CESiY8Ey.js";import"./chevron-right-BZ1gvvAY.js";import"./circle-2x-yILce.js";import"./alert-dialog-83Lj5Hrs.js";import"./chevron-up-Csf9Xqjr.js";const Te={task:{icon:e.jsx(Ne,{className:"h-4 w-4"}),color:"bg-blue-500/10 text-blue-500 border-blue-500/20",label:"Task"},note:{icon:e.jsx(ue,{className:"h-4 w-4"}),color:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",label:"Note"},idea:{icon:e.jsx(K,{className:"h-4 w-4"}),color:"bg-purple-500/10 text-purple-500 border-purple-500/20",label:"Idea"},meeting:{icon:e.jsx(ge,{className:"h-4 w-4"}),color:"bg-green-500/10 text-green-500 border-green-500/20",label:"Meeting"},client_request:{icon:e.jsx(je,{className:"h-4 w-4"}),color:"bg-pink-500/10 text-pink-500 border-pink-500/20",label:"Client Request"}};function Q({capture:s,onProcess:g}){const{deleteCapture:t,markProcessed:d,processWithJames:f}=H(),m=Te[s.type],[r,n]=c.useState(!1),x=ve(),h=s.processingStatus==="processing",i=s.processingStatus==="completed"||s.processed,b=s.processingStatus==="failed",C=()=>{t(s.id),n(!1)},k=()=>{d(s.id,"dismissed")},p=()=>{f(s.id)},y=()=>{s.artifactType==="task"&&s.artifactId?x(`/tasks?highlight=${s.artifactId}`):s.artifactType};return e.jsxs(ie,{className:`group ${i?"opacity-60":""}`,children:[e.jsx(re,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${m.color}`,children:m.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx(v,{variant:"outline",className:m.color,children:m.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:de(new Date(s.createdAt),{addSuffix:!0})}),h&&e.jsxs(v,{variant:"secondary",className:"text-xs bg-blue-500/10 text-blue-500 border-blue-500/20",children:[e.jsx(q,{className:"h-3 w-3 mr-1 animate-spin"}),"James is processing..."]}),i&&s.processedBy==="james"&&e.jsxs(v,{variant:"secondary",className:"text-xs bg-green-500/10 text-green-500 border-green-500/20",children:[e.jsx(S,{className:"h-3 w-3 mr-1"}),"Processed by James"]}),i&&s.processedBy!=="james"&&e.jsxs(v,{variant:"secondary",className:"text-xs",children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Processed"]}),b&&e.jsxs(v,{variant:"destructive",className:"text-xs",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"Failed"]})]}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content}),s.type==="client_request"&&s.metadata&&e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs",children:[s.metadata.client_name&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-md bg-pink-500/10 text-pink-700 dark:text-pink-400",children:[e.jsx(G,{className:"h-3 w-3"}),s.metadata.client_name]}),s.metadata.client_email&&e.jsx("span",{className:"text-muted-foreground",children:s.metadata.client_email})]}),i&&s.artifactId&&s.artifactType&&e.jsx("div",{className:"mt-2",children:e.jsxs(j,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-muted-foreground hover:text-foreground",onClick:y,children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),"View created ",s.artifactType==="calendar_event"?"calendar event":s.artifactType]})})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[!i&&!h&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>g(s),children:[e.jsx(W,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Process"})]}),e.jsxs(j,{variant:"default",size:"sm",onClick:p,className:"bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(S,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"James"})]})]}),h&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Processing..."})]}),e.jsxs(ne,{children:[e.jsx(le,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon",className:"h-10 w-10 min-h-[44px] min-w-[44px] opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsxs(oe,{align:"end",children:[!i&&!h&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{onClick:p,children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Process with James"]}),e.jsxs(T,{onClick:k,children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Mark as Done"]}),e.jsx(V,{})]}),b&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{onClick:p,children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Retry with James"]}),e.jsx(V,{})]}),e.jsxs(T,{onClick:()=>n(!0),className:"text-destructive focus:text-destructive",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]})}),e.jsx(ce,{open:r,onOpenChange:n,title:"Delete capture?",description:"This will permanently delete this capture. This action cannot be undone.",onConfirm:C})]})}function Pe({open:s,onOpenChange:g,capture:t,onClose:d}){const{markProcessed:f}=H(),{addTask:m}=U(),{projects:r}=X(),[n,x]=c.useState(""),[h,i]=c.useState(""),[b,C]=c.useState("backlog"),[k,p]=c.useState(2),[y,D]=c.useState("freelance"),[L,w]=c.useState(void 0),M=(t==null?void 0:t.type)==="client_request",u=t==null?void 0:t.metadata;c.useEffect(()=>{if(t)if(t.type==="client_request"&&t.metadata){if(x(t.metadata.original_title||""),i(t.metadata.original_description||""),t.metadata.project_id){const a=r.find(l=>l.id===t.metadata.project_id);a&&(w(a.id),D(a.area))}p(2)}else{const a=t.content.split(`
`),l=a[0]||"",A=a.slice(1).join(`
`).trim();x(l),i(A),w(void 0),t.type==="meeting"?p(1):p(2)}},[t,s,r]);const $=a=>{if(a.preventDefault(),!n.trim()||!t)return;const l={title:n.trim(),description:h.trim()||void 0,status:b,priority:k,area:y,projectId:L};M&&u&&(l.quickCapture=!0,l.createdBy=u.client_email,l.originalCapture=t.id),m(l),f(t.id,"task"),x(""),i(""),C("backlog"),p(2),D("freelance"),w(void 0),d()},Z=()=>{t&&f(t.id,"dismissed"),d()};return e.jsx(be,{open:s,onOpenChange:g,children:e.jsx(we,{className:"w-[calc(100vw-2rem)] max-w-[500px] max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:$,children:[e.jsxs(Ce,{children:[e.jsxs(ke,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"Process Capture"]}),e.jsx(ye,{children:"Convert this capture into a task or dismiss it."})]}),M&&u&&e.jsx("div",{className:"bg-pink-500/10 border border-pink-500/20 rounded-lg p-3 my-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-pink-700 dark:text-pink-400",children:[e.jsx("span",{className:"font-medium",children:"Client Request"}),u.client_name&&e.jsxs("span",{children:["from ",u.client_name]}),u.client_email&&e.jsxs("span",{className:"text-muted-foreground",children:["(",u.client_email,")"]})]})}),t&&!M&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 my-4 text-sm",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Original capture:"}),e.jsx("p",{className:"whitespace-pre-wrap",children:t.content})]}),e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"title",children:"Task Title"}),e.jsx(Y,{id:"title",value:n,onChange:a=>x(a.target.value),placeholder:"Task title...",autoFocus:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"description",children:"Description"}),e.jsx(Se,{id:"description",value:h,onChange:a=>i(a.target.value),placeholder:"Additional details...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"status",children:"Status"}),e.jsxs(P,{value:b,onValueChange:a=>C(a),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"backlog",children:"Backlog"}),e.jsx(o,{value:"queue",children:"Queue"}),e.jsx(o,{value:"in_progress",children:"In Progress"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"priority",children:"Priority"}),e.jsxs(P,{value:String(k),onValueChange:a=>p(Number(a)),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"1",children:"High"}),e.jsx(o,{value:"2",children:"Medium"}),e.jsx(o,{value:"3",children:"Low"})]})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"area",children:"Area"}),e.jsxs(P,{value:y,onValueChange:a=>D(a),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"wellfy",children:"Wellfy"}),e.jsx(o,{value:"freelance",children:"Freelance"}),e.jsx(o,{value:"personal",children:"Personal"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"project",children:"Project (optional)"}),e.jsxs(P,{value:L||"none",onValueChange:a=>{if(a==="none")w(void 0);else{w(a);const l=r.find(A=>A.id===a);l&&D(l.area)}},children:[e.jsx(_,{children:e.jsx(I,{placeholder:"Select a project..."})}),e.jsxs(F,{children:[e.jsx(o,{value:"none",children:"No project"}),r.filter(a=>a.status==="active"||a.status==="pipeline").map(a=>e.jsx(o,{value:a.id,children:a.name},a.id))]})]})]})]}),e.jsxs(De,{className:"flex justify-between mt-4",children:[e.jsx(j,{type:"button",variant:"ghost",onClick:Z,children:"Dismiss"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(j,{type:"submit",disabled:!n.trim(),children:"Create Task"})]})]})]})})})}function ns(){const[s,g]=c.useState(!1),[t,d]=c.useState(!1),[f,m]=c.useState(null),r=ee(),n=se(),x=i=>{m(i),d(!0)},h=()=>{d(!1),m(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Inbox"})}),e.jsxs(j,{onClick:()=>g(!0),className:"w-full sm:w-auto min-h-[44px]",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Quick Capture"]})]}),e.jsxs(ae,{defaultValue:"unprocessed",className:"w-full",children:[e.jsxs(te,{children:[e.jsxs(J,{value:"unprocessed",className:"gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Inbox",r.length>0&&e.jsx(v,{variant:"secondary",className:"ml-1",children:r.length})]}),e.jsxs(J,{value:"processed",className:"gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"Processed"]})]}),e.jsx(O,{value:"unprocessed",className:"mt-4",children:r.length===0?e.jsxs("div",{className:"rounded-lg border bg-card p-12 text-center",children:[e.jsx(E,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Inbox zero!"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"All captures have been processed. Nice work!"}),e.jsxs(j,{onClick:()=>g(!0),children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Capture Something"]})]}):e.jsx("div",{className:"space-y-3",children:r.map(i=>e.jsx(Q,{capture:i,onProcess:x},i.id))})}),e.jsx(O,{value:"processed",className:"mt-4",children:n.length===0?e.jsxs("div",{className:"rounded-lg border bg-card p-12 text-center",children:[e.jsx(z,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No processed captures"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Processed captures will appear here."})]}):e.jsx("div",{className:"space-y-3",children:n.map(i=>e.jsx(Q,{capture:i,onProcess:x},i.id))})})]}),e.jsx(fe,{open:s,onOpenChange:g}),e.jsx(Pe,{open:t,onOpenChange:d,capture:f,onClose:h})]})}export{ns as InboxPage};
