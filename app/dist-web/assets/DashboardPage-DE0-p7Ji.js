import{r as j,j as e}from"./vendor-react-wuMqdllU.js";import{C as p,a as g,b as N,c as v}from"./card-ByB4Hy19.js";import{u as A,B as f,a as u,b as $,c as W,d as z,e as P,f as R,g as _,h as B}from"./index-JZoliObr.js";import{n as F,A as h,o as G,p as H,b as L,T as U,q as V,r as q,D as J,s as K,t as Q}from"./vendor-icons-CHGo4Fp8.js";import{s as X,e as Y,a as Z,i as T,f as D,b as C,c as M,d as k,p as E,g as S,h as ee,j as se,k as te}from"./vendor-date-fns-D0ugVOfH.js";import{L as ae}from"./vendor-router-Cm8Qzw9U.js";import"./vendor-markdown-C3iCDuOK.js";import"./vendor-recharts-tRgwS7-V.js";import"./vendor-radix-BCh4MJnw.js";import"./vendor-floating-ui-BD6aHMKr.js";const I={1:{label:"High",color:"bg-red-500/10 text-red-500 border-red-500/20"},2:{label:"Med",color:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20"},3:{label:"Low",color:"bg-green-500/10 text-green-500 border-green-500/20"}};function re({task:s,onComplete:t}){const r=s.status==="done";return e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border transition-colors ${r?"bg-muted/50 opacity-60":"hover:bg-muted/50"}`,children:[e.jsx("button",{onClick:t,className:"mt-0.5 flex-shrink-0 min-h-[44px] min-w-[44px] flex items-center justify-center -ml-2",disabled:r,children:r?e.jsx(G,{className:"h-5 w-5 text-primary"}):e.jsx(H,{className:"h-5 w-5 text-muted-foreground hover:text-primary transition-colors"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-medium ${r?"line-through text-muted-foreground":""}`,children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(f,{variant:"outline",className:I[s.priority].color,children:I[s.priority].label}),e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:s.area})]})]})]})}function ne(){const{tasks:s,updateTask:t}=A(),r=j.useMemo(()=>s.filter(n=>n.status==="in_progress"||n.status==="queue").sort((n,c)=>n.status==="in_progress"&&c.status!=="in_progress"?-1:n.status!=="in_progress"&&c.status==="in_progress"?1:n.priority-c.priority).slice(0,3),[s]),a=j.useMemo(()=>{const n=new Date;return n.setHours(0,0,0,0),s.filter(c=>{if(!c.completedAt)return!1;const m=new Date(c.completedAt);return m.setHours(0,0,0,0),m.getTime()===n.getTime()}).length},[s]),i=n=>{n.status!=="done"&&t(n.id,{status:"done",completedAt:new Date().toISOString()})};return e.jsxs(p,{children:[e.jsx(g,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(N,{className:"text-base flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"Today's Focus"]}),a>0&&e.jsxs(f,{variant:"secondary",className:"text-xs",children:[a," done today"]})]})}),e.jsx(v,{className:"space-y-2",children:r.length===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No tasks in progress or queued."}),e.jsx(u,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:"/tasks",children:["Go to Tasks",e.jsx(h,{className:"h-4 w-4 ml-1"})]})})]}):e.jsxs(e.Fragment,{children:[r.map(n=>e.jsx(re,{task:n,onComplete:()=>i(n)},n.id)),s.filter(n=>n.status==="queue"||n.status==="in_progress").length>3&&e.jsx(u,{variant:"ghost",size:"sm",className:"w-full mt-2",asChild:!0,children:e.jsxs("a",{href:"/tasks",children:["View all tasks",e.jsx(h,{className:"h-4 w-4 ml-1"})]})})]})})]})}function w(s){const t=Math.floor(s/60),r=s%60;return t>0?`${t}h ${r}m`:`${r}m`}function ie(){const s=$(),t=W(),r=z(),a=new Date,i=X(a,{weekStartsOn:1}),n=Y(a,{weekStartsOn:1}),c=Z({start:i,end:n}),m=j.useMemo(()=>c.map(o=>{const d=r.filter(x=>T(new Date(x.startTime),o)).reduce((x,O)=>x+(O.durationMinutes||0),0);return{day:o,total:d}}),[r,c]),b=Math.max(...m.map(o=>o.total),60);return e.jsxs(p,{children:[e.jsx(g,{className:"pb-2",children:e.jsxs(N,{className:"text-base flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Time Tracked"]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-3xl font-semibold",children:w(s)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Today"})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm",children:[e.jsx(U,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"This week:"}),e.jsx("span",{className:"font-medium",children:w(t)})]}),e.jsx("div",{className:"flex items-end gap-1 h-12 mb-4",children:m.map(({day:o,total:l})=>{const d=b>0?l/b*100:0,x=T(o,a);return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"w-full h-8 flex items-end",children:e.jsx("div",{className:`w-full rounded-t transition-all ${x?"bg-primary":"bg-muted"}`,style:{height:`${Math.max(d,8)}%`},title:`${D(o,"EEEE")}: ${w(l)}`})}),e.jsx("span",{className:`text-[10px] ${x?"font-semibold text-primary":"text-muted-foreground"}`,children:D(o,"EEEEE")})]},o.toISOString())})}),e.jsx(u,{variant:"ghost",size:"sm",className:"w-full",asChild:!0,children:e.jsxs("a",{href:"/time",children:["View details",e.jsx(h,{className:"h-4 w-4 ml-1"})]})})]})]})}const le={pipeline:"bg-blue-500/10 text-blue-500 border-blue-500/20",active:"bg-green-500/10 text-green-500 border-green-500/20",on_hold:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",completed:"bg-gray-500/10 text-gray-500 border-gray-500/20",cancelled:"bg-red-500/10 text-red-500 border-red-500/20"};function ce({project:s}){const t=R(s.clientId||"");return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.name}),t&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t.name})]}),e.jsx(f,{variant:"outline",className:le[s.status],children:s.status.replace("_"," ")})]})}function oe(){const{projects:s}=P(),t=s.filter(a=>a.status==="active"||a.status==="pipeline"),r=s.filter(a=>a.status==="active").length;return e.jsxs(p,{children:[e.jsx(g,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(N,{className:"text-base flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"Projects"]}),r>0&&e.jsxs(f,{variant:"secondary",children:[r," active"]})]})}),e.jsx(v,{className:"space-y-3",children:t.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No active projects."}),e.jsx(u,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:"/projects",children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),"Add Project"]})})]}):e.jsxs(e.Fragment,{children:[t.slice(0,3).map(a=>e.jsx(ce,{project:a},a.id)),e.jsx(u,{variant:"ghost",size:"sm",className:"w-full",asChild:!0,children:e.jsxs("a",{href:"/projects",children:["View all projects",e.jsx(h,{className:"h-4 w-4 ml-1"})]})})]})})]})}function y(s){return new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(s)}function de(){const{invoices:s}=_(),t=B(),r=new Date,a=C(r),i=M(r),n=C(k(r)),c=M(k(r)),m=s.filter(l=>{if(l.status!=="paid"||!l.paidDate)return!1;const d=E(l.paidDate);return S(d,{start:a,end:i})}).reduce((l,d)=>l+d.totalAmount,0),b=s.filter(l=>{if(l.status!=="paid"||!l.paidDate)return!1;const d=E(l.paidDate);return S(d,{start:n,end:c})}).reduce((l,d)=>l+d.totalAmount,0),o=s.length>0;return e.jsxs(p,{children:[e.jsx(g,{className:"pb-2",children:e.jsxs(N,{className:"text-base flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Revenue"]})}),e.jsxs(v,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-3xl font-semibold",children:y(m)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This month"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last month"}),e.jsx("span",{className:"font-medium",children:y(b)})]}),t.pendingRevenue>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pending invoices"}),e.jsx("span",{className:"font-medium text-yellow-500",children:y(t.pendingRevenue)})]}),t.overdue>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Overdue"}),e.jsxs("span",{className:"font-medium text-destructive",children:[t.overdue," invoice",t.overdue>1?"s":""]})]})]}),!o&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2 mb-2",children:"No revenue data yet. Add invoices to track earnings."}),e.jsx(u,{variant:"ghost",size:"sm",className:"w-full",asChild:!0,children:e.jsxs(ae,{to:"/invoices",children:["View invoices",e.jsx(h,{className:"h-4 w-4 ml-1"})]})})]})]})}function me(s){if(ee(s))return{label:"Today",urgent:!0};if(se(s))return{label:"Tomorrow",urgent:!0};const t=te(s,new Date);return t<0?{label:`${Math.abs(t)}d overdue`,urgent:!0}:t<=7?{label:`${t}d`,urgent:t<=3}:{label:D(s,"MMM d"),urgent:!1}}function ue({task:s}){const t=new Date(s.dueDate),{label:r,urgent:a}=me(t);return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.area})]}),e.jsxs(f,{variant:a?"destructive":"outline",className:"",children:[a&&e.jsx(Q,{className:"h-3 w-3 mr-1"}),r]})]})}function xe(){const{tasks:s}=A(),t=j.useMemo(()=>{const a=new Date;return a.setDate(a.getDate()+7),s.filter(i=>!i.dueDate||i.status==="done"?!1:new Date(i.dueDate)<=a).sort((i,n)=>{const c=new Date(i.dueDate),m=new Date(n.dueDate);return c.getTime()-m.getTime()}).slice(0,5)},[s]),r=j.useMemo(()=>{const a=new Date;return s.filter(i=>!i.dueDate||i.status==="done"?!1:new Date(i.dueDate)<a).length},[s]);return e.jsxs(p,{children:[e.jsx(g,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(N,{className:"text-base flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Upcoming Deadlines"]}),r>0&&e.jsxs(f,{variant:"destructive",children:[r," overdue"]})]})}),e.jsx(v,{className:"space-y-2",children:t.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No upcoming deadlines in the next 7 days."}):e.jsxs(e.Fragment,{children:[t.map(a=>e.jsx(ue,{task:a},a.id)),e.jsx(u,{variant:"ghost",size:"sm",className:"w-full mt-2",asChild:!0,children:e.jsxs("a",{href:"/tasks",children:["View all tasks",e.jsx(h,{className:"h-4 w-4 ml-1"})]})})]})})]})}function he(){const s=new Date().getHours();return s<12?"Good morning":s<18?"Good afternoon":"Good evening"}function Te(){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:he()})}),e.jsxs("div",{className:"grid gap-6 @lg:grid-cols-3",children:[e.jsxs("div",{className:"@lg:col-span-2 space-y-6",children:[e.jsx(ne,{}),e.jsx(xe,{})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(ie,{}),e.jsx(oe,{}),e.jsx(de,{})]})]})]})}export{Te as DashboardPage};
