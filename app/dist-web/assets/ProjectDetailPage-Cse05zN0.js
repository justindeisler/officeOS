import{r as c,j as e}from"./vendor-react-nkeu7MKf.js";import{y as E,g as S,u as $,s as O,h as R,x as _,a as D,B as h,D as q,S as k,C as b,R as v}from"./index-DrITRpZC.js";import{C as i,a as d,b as o,c as m}from"./card-BgiI-iYU.js";import{T as F,a as H,b as f,c as N}from"./tabs-6MGZRPxm.js";import{d as K,a as Q,L as V}from"./vendor-router-bCYKpmtI.js";import{A as I}from"./arrow-left-C4slmW6s.js";import{C as P}from"./calendar-CFQSmmVU.js";import{f as j}from"./vendor-date-fns-D0ugVOfH.js";import"./vendor-markdown-zaQAhtrl.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-Oq5tdvA1.js";import"./vendor-floating-ui-_Y3uXdsy.js";const z={pipeline:"bg-blue-500/10 text-blue-500 border-blue-500/20",active:"bg-green-500/10 text-green-500 border-green-500/20",on_hold:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",completed:"bg-gray-500/10 text-gray-500 border-gray-500/20",cancelled:"bg-red-500/10 text-red-500 border-red-500/20"},G={pipeline:"Pipeline",active:"Active",on_hold:"On Hold",completed:"Completed",cancelled:"Cancelled"},J={wellfy:"bg-purple-500/10 text-purple-500 border-purple-500/20",freelance:"bg-orange-500/10 text-orange-500 border-orange-500/20",personal:"bg-cyan-500/10 text-cyan-500 border-cyan-500/20"};function g(s,r){return new Intl.NumberFormat("de-DE",{style:"currency",currency:r}).format(s)}function B(s){const r=Math.floor(s/60),a=s%60;return r===0?`${a}m`:a===0?`${r}h`:`${r}h ${a}m`}function U({task:s}){const r={1:"bg-red-500",2:"bg-yellow-500",3:"bg-blue-500"},a={backlog:"Backlog",queue:"Queue",in_progress:"In Progress",done:"Done"};return e.jsxs("div",{className:"flex items-center justify-between py-3 px-4 hover:bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r[s.priority]}`}),e.jsx("span",{className:s.status==="done"?"line-through text-muted-foreground":"",children:s.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.dueDate&&e.jsx("span",{className:"text-xs text-muted-foreground",children:j(new Date(s.dueDate),"MMM d")}),e.jsx(h,{variant:"outline",className:"text-xs",children:a[s.status]})]})]})}function W({entry:s}){const r=s.durationMinutes||0;return e.jsxs("div",{className:"flex items-center justify-between py-3 px-4 hover:bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",children:s.description||"No description"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:j(new Date(s.startTime),"MMM d, yyyy 'at' h:mm a")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"secondary",children:s.category}),e.jsx("span",{className:"text-sm font-medium",children:B(r)})]})]})}function X({invoice:s}){const r={draft:"bg-gray-500/10 text-gray-500",sent:"bg-blue-500/10 text-blue-500",paid:"bg-green-500/10 text-green-500",overdue:"bg-red-500/10 text-red-500",cancelled:"bg-red-500/10 text-red-500"};return e.jsxs("div",{className:"flex items-center justify-between py-3 px-4 hover:bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.invoiceNumber}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Issued ",j(new Date(s.issueDate),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{variant:"outline",className:r[s.status],children:s.status}),e.jsx("span",{className:"text-sm font-medium",children:g(s.totalAmount,s.currency)})]})]})}function oe(){const{id:s}=K(),r=Q(),a=E(s||""),y=S((a==null?void 0:a.clientId)||""),{tasks:w}=$(),{entries:T}=O(),{invoices:C}=R(),x=c.useMemo(()=>w.filter(t=>t.projectId===s).sort((t,n)=>t.sortOrder-n.sortOrder),[w,s]),u=c.useMemo(()=>T.filter(t=>t.projectId===s).sort((t,n)=>new Date(n.startTime).getTime()-new Date(t.startTime).getTime()),[T,s]),l=c.useMemo(()=>C.filter(t=>t.projectId===s).sort((t,n)=>new Date(n.issueDate).getTime()-new Date(t.issueDate).getTime()),[C,s]),A=c.useMemo(()=>u.reduce((t,n)=>t+(n.durationMinutes||0),0),[u]),L=c.useMemo(()=>x.filter(t=>t.status==="done").length,[x]),p=c.useMemo(()=>l.reduce((t,n)=>t+n.totalAmount,0),[l]),M=c.useMemo(()=>l.filter(t=>t.status==="paid").reduce((t,n)=>t+n.totalAmount,0),[l]);return a?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:e.jsxs(D,{variant:"ghost",onClick:()=>r("/projects"),className:"w-fit",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Back to Projects"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:a.name}),y&&e.jsx("p",{className:"text-muted-foreground mt-1",children:e.jsx(V,{to:"/clients",className:"hover:underline",children:y.name})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",className:z[a.status],children:G[a.status]}),e.jsx(h,{variant:"outline",className:J[a.area],children:a.area})]})]}),a.description&&e.jsx("p",{className:"text-muted-foreground",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[a.budgetAmount&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-4 w-4"}),"Budget: ",g(a.budgetAmount,a.budgetCurrency)]}),a.startDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"h-4 w-4"}),"Started: ",j(new Date(a.startDate),"MMM d, yyyy")]}),a.targetEndDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"h-4 w-4"}),"Due: ",j(new Date(a.targetEndDate),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsxs(i,{children:[e.jsx(d,{className:"pb-2",children:e.jsx(o,{className:"text-sm font-medium text-muted-foreground",children:"Tasks"})}),e.jsxs(m,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[L,"/",x.length]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"completed"})]})]}),e.jsxs(i,{children:[e.jsx(d,{className:"pb-2",children:e.jsx(o,{className:"text-sm font-medium text-muted-foreground",children:"Time Tracked"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:B(A)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.length," entries"]})]})]}),e.jsxs(i,{children:[e.jsx(d,{className:"pb-2",children:e.jsx(o,{className:"text-sm font-medium text-muted-foreground",children:"Invoiced"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g(p,a.budgetCurrency)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[l.length," invoices"]})]})]}),e.jsxs(i,{children:[e.jsx(d,{className:"pb-2",children:e.jsx(o,{className:"text-sm font-medium text-muted-foreground",children:"Paid"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:g(M,a.budgetCurrency)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[p>0?`${Math.round(M/p*100)}%`:"0%"," ","of invoiced"]})]})]})]}),e.jsxs(F,{defaultValue:"tasks",className:"space-y-4",children:[e.jsxs(H,{children:[e.jsxs(f,{value:"tasks",className:"gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Tasks (",x.length,")"]}),e.jsxs(f,{value:"time",className:"gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"Time (",u.length,")"]}),e.jsxs(f,{value:"invoices",className:"gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),"Invoices (",l.length,")"]})]}),e.jsx(N,{value:"tasks",children:e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg",children:"Project Tasks"})}),e.jsx(m,{children:x.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(k,{className:"h-10 w-10 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No tasks linked to this project yet."}),e.jsx("p",{className:"text-sm",children:"Create tasks and assign them to this project."})]}):e.jsx("div",{className:"divide-y",children:x.map(t=>e.jsx(U,{task:t},t.id))})})]})}),e.jsx(N,{value:"time",children:e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg",children:"Time Entries"})}),e.jsx(m,{children:u.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(b,{className:"h-10 w-10 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No time tracked for this project yet."}),e.jsx("p",{className:"text-sm",children:"Start a timer and link it to this project."})]}):e.jsx("div",{className:"divide-y",children:u.map(t=>e.jsx(W,{entry:t},t.id))})})]})}),e.jsx(N,{value:"invoices",children:e.jsxs(i,{children:[e.jsx(d,{children:e.jsx(o,{className:"text-lg",children:"Invoices"})}),e.jsx(m,{children:l.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(v,{className:"h-10 w-10 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No invoices linked to this project yet."}),e.jsx("p",{className:"text-sm",children:"Create invoices and assign them to this project."})]}):e.jsx("div",{className:"divide-y",children:l.map(t=>e.jsx(X,{invoice:t},t.id))})})]})})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] gap-4",children:[e.jsx(_,{className:"h-12 w-12 text-muted-foreground/50"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Project not found"}),e.jsx("p",{className:"text-muted-foreground",children:"The project you're looking for doesn't exist or has been deleted."}),e.jsxs(D,{onClick:()=>r("/projects"),children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Back to Projects"]})]})}export{oe as ProjectDetailPage};
