import{r,j as e}from"./vendor-react-DeR5d9Tv.js";import{C as l,c as n,a as b,b as y,d as v}from"./card-Do3Kg1xk.js";import{Z as h,a as w,B as c,C as p,m as x,n as C,l as i}from"./index-B9wpeZVf.js";import{S as k}from"./switch-t5S_kKeN.js";import{R as u}from"./refresh-cw-BMXkLT5Q.js";import{C as A}from"./calendar-BXLbKi9j.js";import{C as P}from"./circle-check-big-BcRTjbGf.js";import{P as M}from"./play-BKKAlJVr.js";import{P as S}from"./pause-08e9wRo9.js";import{f as o}from"./vendor-date-fns-D0ugVOfH.js";import"./vendor-markdown-PIr_2kdo.js";import"./vendor-recharts-DrMJw15s.js";import"./vendor-radix-sPo3_CXI.js";import"./vendor-floating-ui-CESiY8Ey.js";import"./vendor-router-9bGSKQ4q.js";const H=C("AutomationsPage"),_={cron:e.jsx(p,{className:"h-4 w-4"}),interval:e.jsx(u,{className:"h-4 w-4"}),trigger:e.jsx(h,{className:"h-4 w-4"})},B={cron:"bg-blue-500/10 text-blue-700 dark:text-blue-400",interval:"bg-purple-500/10 text-purple-700 dark:text-purple-400",trigger:"bg-orange-500/10 text-orange-700 dark:text-orange-400"};function U(){const[t,j]=r.useState([]),[g,d]=r.useState(!0),a=async()=>{d(!0);try{const s=await x.getJamesAutomations();j(s)}catch(s){H.error({err:s},"Failed to fetch automations"),i.error("Failed to load automations")}finally{d(!1)}};r.useEffect(()=>{a()},[]);const f=async(s,m)=>{try{await x.updateJamesAutomation(s,{enabled:!m}),i.success(m?"Automation disabled":"Automation enabled"),a()}catch{i.error("Failed to update automation")}};if(g)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})});const N=t.filter(s=>s.enabled).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight flex items-center gap-2",children:[e.jsx(h,{className:"h-7 w-7"}),"Automations"]}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Scheduled jobs and automated tasks that James runs"})]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:a,children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Automations"}),e.jsx("p",{className:"text-2xl font-bold",children:t.length})]}),e.jsx(A,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:N})]}),e.jsx(P,{className:"h-8 w-8 text-green-600"})]})})})]}),e.jsxs(l,{children:[e.jsxs(b,{children:[e.jsx(y,{className:"text-lg",children:"Scheduled Jobs"}),e.jsx(v,{children:"These automations run automatically based on their schedule"})]}),e.jsx(n,{children:t.length===0?e.jsx("p",{className:"text-muted-foreground text-sm text-center py-8",children:"No automations configured yet."}):e.jsx("div",{className:"space-y-4",children:t.map(s=>e.jsx("div",{className:`p-4 rounded-lg border bg-card ${s.enabled?"":"opacity-60"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs(c,{variant:"outline",className:B[s.type]||"",children:[_[s.type],e.jsx("span",{className:"ml-1",children:s.type})]}),s.enabled?e.jsxs(c,{variant:"outline",className:"bg-green-500/10 text-green-700 dark:text-green-400",children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(c,{variant:"outline",className:"bg-gray-500/10 text-gray-700 dark:text-gray-400",children:[e.jsx(S,{className:"h-3 w-3 mr-1"}),"Paused"]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"h-3 w-3"}),s.schedule_human||s.schedule]}),s.last_run&&e.jsxs("span",{children:["Last run: ",o(new Date(s.last_run),"MMM d, HH:mm")]}),s.next_run&&e.jsxs("span",{children:["Next: ",o(new Date(s.next_run),"MMM d, HH:mm")]})]})]}),e.jsx("div",{className:"flex items-center gap-2 shrink-0",children:e.jsx(k,{checked:!!s.enabled,onCheckedChange:()=>f(s.id,s.enabled)})})]})},s.id))})})]})]})}export{U as AutomationsPage};
