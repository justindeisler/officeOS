import{j as e,r as c}from"./vendor-react-nkeu7MKf.js";import{A as H,B as v,r as q,o as S,a as j,E as G,u as U,f as K,L as N,I as X,G as Y,H as ee,Z as B,J as E}from"./index-DrITRpZC.js";import{T as se,a as ae,b as J,c as O}from"./tabs-6MGZRPxm.js";import{C as te,c as ie}from"./card-BgiI-iYU.js";import{D as re,a as le,b as ne,c as T,d as V}from"./dropdown-menu-CYcu4_01.js";import{C as oe}from"./confirm-delete-dialog-CQpG7Cp6.js";import{n as ce}from"./vendor-date-fns-D0ugVOfH.js";import{C as R,S as P,a as _,b as I,c as F,d as o}from"./select-DGc7E8u9.js";import{C as de}from"./circle-alert-CpxKUFz7.js";import{B as me}from"./building-2-CTtq5g_3.js";import{E as xe}from"./external-link-DNdX8sal.js";import{A as W}from"./arrow-right-CM0peKgs.js";import{E as he}from"./ellipsis-BFw811sM.js";import{T as pe}from"./trash-2-lofomgWT.js";import{M as je}from"./message-square-CXhsR9FO.js";import{C as ge}from"./calendar-CFQSmmVU.js";import{S as ue,Q as fe}from"./QuickCaptureDialog-CNGKYsZf.js";import{L as Ne}from"./list-todo-CKdZgBSE.js";import{a as ve}from"./vendor-router-bCYKpmtI.js";import{D as be,a as we,b as Ce,c as ke,d as ye,e as De}from"./dialog-BB-bSIFe.js";import{T as Se}from"./textarea-CXvtp2xE.js";import{A as z}from"./archive-BapT5RMc.js";import"./vendor-markdown-zaQAhtrl.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-Oq5tdvA1.js";import"./vendor-floating-ui-_Y3uXdsy.js";import"./chevron-right-ft5l9QGJ.js";import"./circle-DZ7gcqCw.js";import"./alert-dialog-BaBnwxVM.js";const Te={task:{icon:e.jsx(Ne,{className:"h-4 w-4"}),color:"bg-blue-500/10 text-blue-500 border-blue-500/20",label:"Task"},note:{icon:e.jsx(ue,{className:"h-4 w-4"}),color:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",label:"Note"},idea:{icon:e.jsx(G,{className:"h-4 w-4"}),color:"bg-purple-500/10 text-purple-500 border-purple-500/20",label:"Idea"},meeting:{icon:e.jsx(ge,{className:"h-4 w-4"}),color:"bg-green-500/10 text-green-500 border-green-500/20",label:"Meeting"},client_request:{icon:e.jsx(je,{className:"h-4 w-4"}),color:"bg-pink-500/10 text-pink-500 border-pink-500/20",label:"Client Request"}};function Q({capture:s,onProcess:g}){const{deleteCapture:t,markProcessed:d,processWithJames:f}=H(),m=Te[s.type],[r,l]=c.useState(!1),x=ve(),h=s.processingStatus==="processing",i=s.processingStatus==="completed"||s.processed,b=s.processingStatus==="failed",C=()=>{t(s.id),l(!1)},k=()=>{d(s.id,"dismissed")},p=()=>{f(s.id)},y=()=>{s.artifactType==="task"&&s.artifactId?x(`/tasks?highlight=${s.artifactId}`):s.artifactType};return e.jsxs(te,{className:`group ${i?"opacity-60":""}`,children:[e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${m.color}`,children:m.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx(v,{variant:"outline",className:m.color,children:m.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ce(new Date(s.createdAt),{addSuffix:!0})}),h&&e.jsxs(v,{variant:"secondary",className:"text-xs bg-blue-500/10 text-blue-500 border-blue-500/20",children:[e.jsx(q,{className:"h-3 w-3 mr-1 animate-spin"}),"James is processing..."]}),i&&s.processedBy==="james"&&e.jsxs(v,{variant:"secondary",className:"text-xs bg-green-500/10 text-green-500 border-green-500/20",children:[e.jsx(S,{className:"h-3 w-3 mr-1"}),"Processed by James"]}),i&&s.processedBy!=="james"&&e.jsxs(v,{variant:"secondary",className:"text-xs",children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Processed"]}),b&&e.jsxs(v,{variant:"destructive",className:"text-xs",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),"Failed"]})]}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content}),s.type==="client_request"&&s.metadata&&e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs",children:[s.metadata.client_name&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-md bg-pink-500/10 text-pink-700 dark:text-pink-400",children:[e.jsx(me,{className:"h-3 w-3"}),s.metadata.client_name]}),s.metadata.client_email&&e.jsx("span",{className:"text-muted-foreground",children:s.metadata.client_email})]}),i&&s.artifactId&&s.artifactType&&e.jsx("div",{className:"mt-2",children:e.jsxs(j,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-muted-foreground hover:text-foreground",onClick:y,children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),"View created ",s.artifactType==="calendar_event"?"calendar event":s.artifactType]})})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[!i&&!h&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>g(s),children:[e.jsx(W,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Process"})]}),e.jsxs(j,{variant:"default",size:"sm",onClick:p,className:"bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(S,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"James"})]})]}),h&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 text-sm text-muted-foreground",children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Processing..."})]}),e.jsxs(re,{children:[e.jsx(le,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsxs(ne,{align:"end",children:[!i&&!h&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{onClick:p,children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Process with James"]}),e.jsxs(T,{onClick:k,children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Mark as Done"]}),e.jsx(V,{})]}),b&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{onClick:p,children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Retry with James"]}),e.jsx(V,{})]}),e.jsxs(T,{onClick:()=>l(!0),className:"text-destructive focus:text-destructive",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]})}),e.jsx(oe,{open:r,onOpenChange:l,title:"Delete capture?",description:"This will permanently delete this capture. This action cannot be undone.",onConfirm:C})]})}function Pe({open:s,onOpenChange:g,capture:t,onClose:d}){const{markProcessed:f}=H(),{addTask:m}=U(),{projects:r}=K(),[l,x]=c.useState(""),[h,i]=c.useState(""),[b,C]=c.useState("backlog"),[k,p]=c.useState(2),[y,D]=c.useState("freelance"),[M,w]=c.useState(void 0),A=(t==null?void 0:t.type)==="client_request",u=t==null?void 0:t.metadata;c.useEffect(()=>{if(t)if(t.type==="client_request"&&t.metadata){if(x(t.metadata.original_title||""),i(t.metadata.original_description||""),t.metadata.project_id){const a=r.find(n=>n.id===t.metadata.project_id);a&&(w(a.id),D(a.area))}p(2)}else{const a=t.content.split(`
`),n=a[0]||"",L=a.slice(1).join(`
`).trim();x(n),i(L),w(void 0),t.type==="meeting"?p(1):p(2)}},[t,s,r]);const $=a=>{if(a.preventDefault(),!l.trim()||!t)return;const n={title:l.trim(),description:h.trim()||void 0,status:b,priority:k,area:y,projectId:M};A&&u&&(n.quickCapture=!0,n.createdBy=u.client_email,n.originalCapture=t.id),m(n),f(t.id,"task"),x(""),i(""),C("backlog"),p(2),D("freelance"),w(void 0),d()},Z=()=>{t&&f(t.id,"dismissed"),d()};return e.jsx(be,{open:s,onOpenChange:g,children:e.jsx(we,{className:"w-[calc(100vw-2rem)] max-w-[500px] max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:$,children:[e.jsxs(Ce,{children:[e.jsxs(ke,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"Process Capture"]}),e.jsx(ye,{children:"Convert this capture into a task or dismiss it."})]}),A&&u&&e.jsx("div",{className:"bg-pink-500/10 border border-pink-500/20 rounded-lg p-3 my-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-pink-700 dark:text-pink-400",children:[e.jsx("span",{className:"font-medium",children:"Client Request"}),u.client_name&&e.jsxs("span",{children:["from ",u.client_name]}),u.client_email&&e.jsxs("span",{className:"text-muted-foreground",children:["(",u.client_email,")"]})]})}),t&&!A&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 my-4 text-sm",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Original capture:"}),e.jsx("p",{className:"whitespace-pre-wrap",children:t.content})]}),e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"title",children:"Task Title"}),e.jsx(X,{id:"title",value:l,onChange:a=>x(a.target.value),placeholder:"Task title...",autoFocus:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"description",children:"Description"}),e.jsx(Se,{id:"description",value:h,onChange:a=>i(a.target.value),placeholder:"Additional details...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"status",children:"Status"}),e.jsxs(P,{value:b,onValueChange:a=>C(a),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"backlog",children:"Backlog"}),e.jsx(o,{value:"queue",children:"Queue"}),e.jsx(o,{value:"in_progress",children:"In Progress"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"priority",children:"Priority"}),e.jsxs(P,{value:String(k),onValueChange:a=>p(Number(a)),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"1",children:"High"}),e.jsx(o,{value:"2",children:"Medium"}),e.jsx(o,{value:"3",children:"Low"})]})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"area",children:"Area"}),e.jsxs(P,{value:y,onValueChange:a=>D(a),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"wellfy",children:"Wellfy"}),e.jsx(o,{value:"freelance",children:"Freelance"}),e.jsx(o,{value:"personal",children:"Personal"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"project",children:"Project (optional)"}),e.jsxs(P,{value:M||"none",onValueChange:a=>{if(a==="none")w(void 0);else{w(a);const n=r.find(L=>L.id===a);n&&D(n.area)}},children:[e.jsx(_,{children:e.jsx(I,{placeholder:"Select a project..."})}),e.jsxs(F,{children:[e.jsx(o,{value:"none",children:"No project"}),r.filter(a=>a.status==="active"||a.status==="pipeline").map(a=>e.jsx(o,{value:a.id,children:a.name},a.id))]})]})]})]}),e.jsxs(De,{className:"flex justify-between mt-4",children:[e.jsx(j,{type:"button",variant:"ghost",onClick:Z,children:"Dismiss"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(j,{type:"submit",disabled:!l.trim(),children:"Create Task"})]})]})]})})})}function rs(){const[s,g]=c.useState(!1),[t,d]=c.useState(!1),[f,m]=c.useState(null),r=Y(),l=ee(),x=i=>{m(i),d(!0)},h=()=>{d(!1),m(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Inbox"})}),e.jsxs(j,{onClick:()=>g(!0),className:"w-full sm:w-auto",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Quick Capture"]})]}),e.jsxs(se,{defaultValue:"unprocessed",className:"w-full",children:[e.jsxs(ae,{children:[e.jsxs(J,{value:"unprocessed",className:"gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Inbox",r.length>0&&e.jsx(v,{variant:"secondary",className:"ml-1",children:r.length})]}),e.jsxs(J,{value:"processed",className:"gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"Processed"]})]}),e.jsx(O,{value:"unprocessed",className:"mt-4",children:r.length===0?e.jsxs("div",{className:"rounded-lg border bg-card p-12 text-center",children:[e.jsx(E,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Inbox zero!"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"All captures have been processed. Nice work!"}),e.jsxs(j,{onClick:()=>g(!0),children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Capture Something"]})]}):e.jsx("div",{className:"space-y-3",children:r.map(i=>e.jsx(Q,{capture:i,onProcess:x},i.id))})}),e.jsx(O,{value:"processed",className:"mt-4",children:l.length===0?e.jsxs("div",{className:"rounded-lg border bg-card p-12 text-center",children:[e.jsx(z,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No processed captures"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Processed captures will appear here."})]}):e.jsx("div",{className:"space-y-3",children:l.map(i=>e.jsx(Q,{capture:i,onProcess:x},i.id))})})]}),e.jsx(fe,{open:s,onOpenChange:g}),e.jsx(Pe,{open:t,onOpenChange:d,capture:f,onClose:h})]})}export{rs as InboxPage};
