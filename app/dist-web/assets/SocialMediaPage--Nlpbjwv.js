import{r as i,j as e}from"./vendor-react-nkeu7MKf.js";import{c as D,j as S,B as O,a as h,C as ge,X as Me,L as E,I as W,m as P,l as w,F as Pe}from"./index-DrITRpZC.js";import{T as De,a as Te,b as ae,c as ne}from"./tabs-6MGZRPxm.js";import{C as L,c as z}from"./card-BgiI-iYU.js";import{D as Ie,a as Ee,b as Le,c as $,d as ze}from"./dropdown-menu-CYcu4_01.js";import{P as V}from"./pencil-DLHpG_O_.js";import{C as _}from"./calendar-CFQSmmVU.js";import{T as _e}from"./trash-2-lofomgWT.js";import{C as le,S as re,a as ie,b as ce,c as de,d as I}from"./select-DGc7E8u9.js";import{S as G}from"./send-D96x4dJL.js";import{f as N,p as R,s as A,q as oe,b as Fe,c as Oe,a as Re,r as me,h as H,t as Be,u as $e,v as Ve,d as Ae}from"./vendor-date-fns-D0ugVOfH.js";import{D as je,a as fe,b as ve,c as ye,d as Ne,e as be}from"./dialog-BB-bSIFe.js";import{T as He}from"./textarea-CXvtp2xE.js";import{C as We}from"./chevron-right-ft5l9QGJ.js";import{R as Ge}from"./refresh-cw-DAeFkAP4.js";import{P as qe}from"./plus-CdEWzdSX.js";import{S as we}from"./sparkles-R1R_sqcb.js";import{F as Je}from"./filter-BrdDF2Bg.js";import"./vendor-markdown-zaQAhtrl.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-Oq5tdvA1.js";import"./vendor-floating-ui-_Y3uXdsy.js";import"./vendor-router-bCYKpmtI.js";import"./circle-DZ7gcqCw.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=D("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=D("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=D("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=D("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=D("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=D("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=D("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=D("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),xe={suggested:{label:"Suggested",color:"bg-amber-500/10 text-amber-700 dark:text-amber-400 border-amber-200 dark:border-amber-800"},approved:{label:"Approved",color:"bg-green-500/10 text-green-700 dark:text-green-400 border-green-200 dark:border-green-800"},scheduled:{label:"Scheduled",color:"bg-blue-500/10 text-blue-700 dark:text-blue-400 border-blue-200 dark:border-blue-800"},published:{label:"Published",color:"bg-purple-500/10 text-purple-700 dark:text-purple-400 border-purple-200 dark:border-purple-800"},rejected:{label:"Rejected",color:"bg-red-500/10 text-red-700 dark:text-red-400 border-red-200 dark:border-red-800"}},es={commits:"Git Commits",conversations:"Conversations",news:"Tech News",manual:"Manual",topics:"Topic Research"};function ss({post:s,onApprove:j,onReject:n,onEdit:f,onSchedule:r,onPublish:o,onDelete:c}){var k,T;const[u,p]=i.useState(!1),v=xe[s.status]||xe.suggested,l=s.platform==="linkedin",a=l?J:q,m=s.content_text.length>200&&!u?s.content_text.slice(0,200)+"...":s.content_text,d=((k=s.metadata)==null?void 0:k.hashtags)||[],g=((T=s.metadata)==null?void 0:T.topics)||[];return e.jsx(L,{className:S("group transition-all duration-200 hover:shadow-md",s.status==="rejected"&&"opacity-60"),children:e.jsxs(z,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:S("flex items-center justify-center w-8 h-8 rounded-lg",l?"bg-[#0077B5]/10 text-[#0077B5]":"bg-gradient-to-br from-purple-500/10 via-pink-500/10 to-orange-500/10 text-pink-600"),children:e.jsx(a,{className:"h-4 w-4"})}),e.jsx(O,{variant:"outline",className:S("text-xs font-medium",v.color),children:v.label}),s.source&&e.jsx(O,{variant:"secondary",className:"text-xs",children:es[s.source]||s.source})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:N(R(s.created_at),"MMM d, yyyy")}),e.jsxs(Ie,{children:[e.jsx(Ee,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ke,{className:"h-3.5 w-3.5"})})}),e.jsxs(Le,{align:"end",children:[e.jsxs($,{onClick:()=>f(s),children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs($,{onClick:()=>r(s),children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Schedule"]}),e.jsx(ze,{}),e.jsxs($,{className:"text-destructive",onClick:()=>c(s.id),children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]}),s.visual_path?e.jsx("div",{className:"rounded-lg overflow-hidden bg-muted border",children:e.jsx("img",{src:`/api/social-media/visuals/${s.visual_path.split("/").pop()}`,alt:`${s.visual_type||"Visual"} for ${s.platform} post`,className:"w-full aspect-video object-cover",loading:"lazy",onError:y=>{const M=y.target;M.style.display="none",M.parentElement.innerHTML=`
                  <div class="aspect-video flex items-center justify-center">
                    <span class="text-sm text-muted-foreground">‚ö†Ô∏è Visual unavailable</span>
                  </div>
                `}})}):e.jsxs("div",{className:"rounded-lg overflow-hidden bg-muted/50 aspect-video flex items-center justify-center border border-dashed",children:[e.jsx(Ye,{className:"h-6 w-6 text-muted-foreground/30"}),e.jsx("span",{className:"ml-2 text-xs text-muted-foreground/50",children:"No visual generated"})]}),e.jsxs("div",{className:S("text-sm whitespace-pre-wrap leading-relaxed cursor-pointer",s.status==="rejected"&&"line-through"),onClick:()=>p(!u),children:[m,s.content_text.length>200&&e.jsx("button",{className:"ml-1 text-xs text-primary hover:underline font-medium",onClick:y=>{y.stopPropagation(),p(!u)},children:u?"Show less":"Show more"})]}),d.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:d.map(y=>e.jsxs("span",{className:"inline-flex items-center text-xs text-primary/70 hover:text-primary",children:[e.jsx(Ue,{className:"h-3 w-3"}),y.replace(/^#/,"")]},y))}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:g.map(y=>e.jsx(O,{variant:"outline",className:"text-[10px] font-normal",children:y},y))}),s.scheduled_date&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(ge,{className:"h-3 w-3"}),"Scheduled for ",N(R(s.scheduled_date),"EEEE, MMM d 'at' h:mm a")]}),s.published_date&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-emerald-600 dark:text-emerald-400",children:[e.jsx(le,{className:"h-3 w-3"}),"Published ",N(R(s.published_date),"MMM d, yyyy 'at' h:mm a")]}),s.status==="suggested"&&e.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[e.jsxs(h,{size:"sm",variant:"default",className:"h-8 text-xs bg-green-600 hover:bg-green-700",onClick:()=>j(s.id),children:[e.jsx(le,{className:"h-3.5 w-3.5 mr-1"}),"Approve"]}),e.jsxs(h,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>f(s),children:[e.jsx(V,{className:"h-3.5 w-3.5 mr-1"}),"Edit"]}),e.jsxs(h,{size:"sm",variant:"ghost",className:"h-8 text-xs text-destructive hover:text-destructive",onClick:()=>n(s.id),children:[e.jsx(Me,{className:"h-3.5 w-3.5 mr-1"}),"Reject"]})]}),s.status==="approved"&&e.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[e.jsxs(h,{size:"sm",variant:"default",className:"h-8 text-xs",onClick:()=>r(s),children:[e.jsx(_,{className:"h-3.5 w-3.5 mr-1"}),"Schedule"]}),e.jsxs(h,{size:"sm",variant:"outline",className:"h-8 text-xs",onClick:()=>o(s.id),children:[e.jsx(G,{className:"h-3.5 w-3.5 mr-1"}),"Mark Published"]})]}),s.status==="scheduled"&&e.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[e.jsxs(h,{size:"sm",variant:"default",className:"h-8 text-xs",onClick:()=>o(s.id),children:[e.jsx(G,{className:"h-3.5 w-3.5 mr-1"}),"Mark Published"]}),e.jsxs(h,{size:"sm",variant:"ghost",className:"h-8 text-xs",onClick:()=>f(s),children:[e.jsx(V,{className:"h-3.5 w-3.5 mr-1"}),"Edit"]})]}),s.status==="rejected"&&e.jsx("div",{className:"flex items-center gap-2 pt-1",children:e.jsxs(h,{size:"sm",variant:"ghost",className:"h-8 text-xs",onClick:()=>j(s.id),children:[e.jsx(Qe,{className:"h-3.5 w-3.5 mr-1"}),"Reconsider"]})})]})})}function he({open:s,onOpenChange:j,post:n,onSave:f,defaultPlatform:r="linkedin"}){const[o,c]=i.useState(r),[u,p]=i.useState(""),[v,l]=i.useState(""),[a,m]=i.useState("manual"),[d,g]=i.useState(!1),k=!!n;i.useEffect(()=>{var x;n?(c(n.platform),p(n.content_text),l((((x=n.metadata)==null?void 0:x.hashtags)||[]).join(", ")),m(n.source||"manual")):(c(r),p(""),l(""),m("manual"))},[n,r,s]);const T=u.length,y=o==="linkedin"?3e3:2200,M=T>y,F=async()=>{if(!(!u.trim()||M)){g(!0);try{const x=v.split(",").map(b=>b.trim()).filter(Boolean).map(b=>b.startsWith("#")?b:`#${b}`);await f({platform:o,content_text:u.trim(),source:a,metadata:x.length>0?{hashtags:x}:void 0,...k?{status:n.status}:{}}),j(!1)}finally{g(!1)}}};return e.jsx(je,{open:s,onOpenChange:j,children:e.jsxs(fe,{className:"sm:max-w-[600px]",children:[e.jsxs(ve,{children:[e.jsx(ye,{children:k?"Edit Post":"Create Post"}),e.jsx(Ne,{children:k?"Edit the content and settings for this post.":"Create a new social media post draft."})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Platform"}),e.jsxs(re,{value:o,onValueChange:x=>c(x),disabled:k,children:[e.jsx(ie,{children:e.jsx(ce,{})}),e.jsxs(de,{children:[e.jsx(I,{value:"linkedin",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-[#0077B5]"}),"LinkedIn"]})}),e.jsx(I,{value:"instagram",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-pink-600"}),"Instagram"]})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{children:"Content"}),e.jsxs("span",{className:`text-xs ${M?"text-destructive font-medium":"text-muted-foreground"}`,children:[T,"/",y]})]}),e.jsx(He,{placeholder:o==="linkedin"?`Write your LinkedIn post...

Professional tone, 1-3 paragraphs, include insights...`:`Write your Instagram caption...

Concise, visual-first, emojis welcome ‚ú®`,value:u,onChange:x=>p(x.target.value),rows:8,className:"resize-none font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Hashtags (comma-separated)"}),e.jsx(W,{placeholder:"#AI, #TypeScript, #Healthtech, #FreelanceDev",value:v,onChange:x=>l(x.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Source"}),e.jsxs(re,{value:a,onValueChange:m,children:[e.jsx(ie,{children:e.jsx(ce,{})}),e.jsxs(de,{children:[e.jsx(I,{value:"manual",children:"Manual"}),e.jsx(I,{value:"commits",children:"Git Commits"}),e.jsx(I,{value:"conversations",children:"Conversations"}),e.jsx(I,{value:"news",children:"Tech News"}),e.jsx(I,{value:"topics",children:"Topic Research"})]})]})]})]}),e.jsxs(be,{children:[e.jsx(h,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(h,{onClick:F,disabled:!u.trim()||M||d,children:d?"Saving...":k?"Save Changes":"Create Draft"})]})]})})}function ts({open:s,onOpenChange:j,post:n,onSchedule:f}){const[r,o]=i.useState(""),[c,u]=i.useState("09:00"),[p,v]=i.useState(!1);i.useEffect(()=>{if(n!=null&&n.scheduled_date){const a=new Date(n.scheduled_date);o(N(a,"yyyy-MM-dd")),u(N(a,"HH:mm"))}else{const a=new Date;a.setDate(a.getDate()+1),o(N(a,"yyyy-MM-dd")),u("09:00")}},[n,s]);const l=async()=>{if(!(!n||!r)){v(!0);try{const a=new Date(`${r}T${c}:00`).toISOString();await f(n.id,a),j(!1)}finally{v(!1)}}};return n?e.jsx(je,{open:s,onOpenChange:j,children:e.jsxs(fe,{className:"sm:max-w-[400px]",children:[e.jsxs(ve,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"Schedule Post"]}),e.jsxs(Ne,{children:["Choose when to post this on ",n.platform==="linkedin"?"LinkedIn":"Instagram","."]})]}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsx("div",{className:"p-3 rounded-lg bg-muted text-sm line-clamp-3",children:n.content_text}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Date"}),e.jsx(W,{type:"date",value:r,onChange:a=>o(a.target.value),min:N(new Date,"yyyy-MM-dd")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Time"}),e.jsx(W,{type:"time",value:c,onChange:a=>u(a.target.value)})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"üí° Tip: Best posting times ‚Äî LinkedIn: Tue-Thu 8-10am, Instagram: Mon-Fri 11am-1pm"})]}),e.jsxs(be,{children:[e.jsx(h,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(h,{onClick:l,disabled:!r||p,children:p?"Scheduling...":"Schedule"})]})]})}):null}function ue({posts:s,onPostClick:j}){const[n,f]=i.useState("month"),[r,o]=i.useState(new Date),c=i.useMemo(()=>{const l=new Map;for(const a of s){const m=a.scheduled_date||a.published_date||a.created_at;if(!m)continue;const d=N(R(m),"yyyy-MM-dd"),g=l.get(d)||[];g.push(a),l.set(d,g)}return l},[s]),u=i.useMemo(()=>{if(n==="week"){const l=A(r,{weekStartsOn:1});return Array.from({length:7},(a,m)=>oe(l,m))}else{const l=Fe(r),a=Oe(r),m=A(l,{weekStartsOn:1});return Re({start:m,end:oe(m,41)}).filter(d=>me(d,r)||d<l||d>a)}},[n,r]),p=l=>{o(n==="week"?a=>l>0?Be(a,1):$e(a):a=>l>0?Ve(a,1):Ae(a))},v=()=>o(new Date);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("h3",{className:"font-semibold text-lg",children:n==="week"?`Week of ${N(A(r,{weekStartsOn:1}),"MMM d")}`:N(r,"MMMM yyyy")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:v,children:"Today"}),e.jsxs("div",{className:"flex items-center rounded-md border",children:[e.jsx(h,{variant:"ghost",size:"sm",className:S("rounded-r-none h-8",n==="week"&&"bg-muted"),onClick:()=>f("week"),children:"Week"}),e.jsx(h,{variant:"ghost",size:"sm",className:S("rounded-l-none h-8",n==="month"&&"bg-muted"),onClick:()=>f("month"),children:"Month"})]}),e.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>p(-1),children:e.jsx(Xe,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>p(1),children:e.jsx(We,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-px",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(l=>e.jsx("div",{className:"text-center text-xs font-medium text-muted-foreground py-2",children:l},l))}),e.jsx("div",{className:"grid grid-cols-7 gap-px bg-border rounded-lg overflow-hidden",children:u.map(l=>{const a=N(l,"yyyy-MM-dd"),m=c.get(a)||[],d=me(l,r);return e.jsxs("div",{className:S("bg-background min-h-[80px] p-1.5 transition-colors",n==="week"&&"min-h-[120px]",!d&&n==="month"&&"opacity-40",H(l)&&"bg-primary/5"),children:[e.jsx("div",{className:S("text-xs font-medium mb-1",H(l)?"text-primary":"text-muted-foreground"),children:H(l)?e.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-primary text-primary-foreground text-[10px]",children:N(l,"d")}):N(l,"d")}),e.jsxs("div",{className:"space-y-0.5",children:[m.slice(0,3).map(g=>e.jsxs("button",{onClick:()=>j(g),className:S("w-full text-left rounded px-1 py-0.5 text-[10px] leading-tight truncate transition-colors",g.platform==="linkedin"?"bg-[#0077B5]/10 text-[#0077B5] hover:bg-[#0077B5]/20":"bg-pink-500/10 text-pink-600 hover:bg-pink-500/20",g.status==="published"&&"opacity-60 line-through"),children:[g.platform==="linkedin"?"üîó":"üì∏"," ",g.content_text.slice(0,30)]},g.id)),m.length>3&&e.jsxs("span",{className:"text-[10px] text-muted-foreground px-1",children:["+",m.length-3," more"]})]})]},a)})}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-[#0077B5]/20"}),e.jsx("span",{children:"LinkedIn"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-pink-500/20"}),e.jsx("span",{children:"Instagram"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-muted opacity-60"}),e.jsx("span",{children:"Published"})]})]})]})}function Ms(){const[s,j]=i.useState("linkedin"),[n,f]=i.useState("posts"),[r,o]=i.useState("all"),[c,u]=i.useState([]),[p,v]=i.useState(!0),[l,a]=i.useState(!1),[m,d]=i.useState(null),[g,k]=i.useState(!1),[T,y]=i.useState(null),[M,F]=i.useState(!1),x=i.useCallback(async()=>{v(!0);try{const t=await P.getSocialMediaPosts({platform:s,status:r!=="all"?r:void 0,limit:200});u(t)}catch(t){console.error("Failed to fetch posts:",t),w.error("Failed to load posts")}finally{v(!1)}},[s,r]);i.useEffect(()=>{x()},[x]);const b=i.useMemo(()=>{const t=c;return{suggested:t.filter(C=>C.status==="suggested").length,approved:t.filter(C=>C.status==="approved").length,scheduled:t.filter(C=>C.status==="scheduled").length,published:t.filter(C=>C.status==="published").length}},[c]),X=i.useMemo(()=>c.filter(t=>t.status==="suggested"),[c]),K=i.useMemo(()=>c.filter(t=>t.status==="approved"),[c]),Q=i.useMemo(()=>c.filter(t=>t.status==="scheduled"||t.status==="published"),[c]),U=async t=>{try{await P.updateSocialMediaPost(t,{status:"approved"}),w.success("Post approved!"),x()}catch{w.error("Failed to approve post")}},Y=async t=>{try{await P.updateSocialMediaPost(t,{status:"rejected"}),w("Post rejected",{icon:"üóëÔ∏è"}),x()}catch{w.error("Failed to reject post")}},B=t=>{d(t),a(!0)},Z=t=>{y(t),k(!0)},ee=async t=>{try{await P.publishSocialMediaPost(t),w.success("Post marked as published! üéâ"),x()}catch{w.error("Failed to publish post")}},se=async t=>{try{await P.deleteSocialMediaPost(t),w("Post deleted"),x()}catch{w.error("Failed to delete post")}},ke=async t=>{m&&(await P.updateSocialMediaPost(m.id,t),w.success("Post updated!")),x()},Ce=async t=>{await P.createSocialMediaPost(t),w.success("Draft created!"),x()},Se=async(t,C)=>{await P.updateSocialMediaPost(t,{status:"scheduled",scheduled_date:C}),w.success("Post scheduled!"),x()},te=t=>{B(t)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Social Media"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Manage your LinkedIn & Instagram content pipeline"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:x,disabled:p,children:[e.jsx(Ge,{className:`h-4 w-4 mr-1 ${p?"animate-spin":""}`}),"Refresh"]}),e.jsxs(h,{size:"sm",onClick:()=>{d(null),F(!0)},children:[e.jsx(qe,{className:"h-4 w-4 mr-1"}),"New Post"]})]})]}),e.jsxs(De,{value:s,onValueChange:t=>j(t),children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs(Te,{className:"h-11",children:[e.jsxs(ae,{value:"linkedin",className:"gap-2 px-4",children:[e.jsx(J,{className:"h-4 w-4"}),"LinkedIn",b.suggested>0&&s!=="linkedin"&&e.jsx(O,{variant:"secondary",className:"h-5 px-1.5 text-[10px]",children:b.suggested})]}),e.jsxs(ae,{value:"instagram",className:"gap-2 px-4",children:[e.jsx(q,{className:"h-4 w-4"}),"Instagram"]})]}),e.jsxs("div",{className:"flex items-center rounded-md border",children:[e.jsxs(h,{variant:"ghost",size:"sm",className:`h-8 rounded-r-none ${n==="posts"?"bg-muted":""}`,onClick:()=>f("posts"),children:[e.jsx(Ze,{className:"h-4 w-4 mr-1"}),"Posts"]}),e.jsxs(h,{variant:"ghost",size:"sm",className:`h-8 rounded-l-none ${n==="calendar"?"bg-muted":""}`,onClick:()=>f("calendar"),children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),"Calendar"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4",children:[e.jsx(L,{className:"cursor-pointer hover:shadow-sm transition-shadow",onClick:()=>o("suggested"),children:e.jsxs(z,{className:"p-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-9 h-9 rounded-lg bg-amber-500/10",children:e.jsx(we,{className:"h-4 w-4 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:b.suggested}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Suggested"})]})]})}),e.jsx(L,{className:"cursor-pointer hover:shadow-sm transition-shadow",onClick:()=>o("approved"),children:e.jsxs(z,{className:"p-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-9 h-9 rounded-lg bg-green-500/10",children:e.jsx(Pe,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:b.approved}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Approved"})]})]})}),e.jsx(L,{className:"cursor-pointer hover:shadow-sm transition-shadow",onClick:()=>o("scheduled"),children:e.jsxs(z,{className:"p-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-9 h-9 rounded-lg bg-blue-500/10",children:e.jsx(ge,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:b.scheduled}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Scheduled"})]})]})}),e.jsx(L,{className:"cursor-pointer hover:shadow-sm transition-shadow",onClick:()=>o("published"),children:e.jsxs(z,{className:"p-3 flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-9 h-9 rounded-lg bg-purple-500/10",children:e.jsx(G,{className:"h-4 w-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:b.published}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Published"})]})]})})]}),e.jsx(ne,{value:"linkedin",className:"mt-4",children:n==="posts"?e.jsx(pe,{posts:r==="all"?c:c.filter(t=>t.status===r),suggestedPosts:X,approvedPosts:K,statusFilter:r,setStatusFilter:o,loading:p,onApprove:U,onReject:Y,onEdit:B,onSchedule:Z,onPublish:ee,onDelete:se}):e.jsx(ue,{posts:Q,onPostClick:te})}),e.jsx(ne,{value:"instagram",className:"mt-4",children:n==="posts"?e.jsx(pe,{posts:r==="all"?c:c.filter(t=>t.status===r),suggestedPosts:X,approvedPosts:K,statusFilter:r,setStatusFilter:o,loading:p,onApprove:U,onReject:Y,onEdit:B,onSchedule:Z,onPublish:ee,onDelete:se}):e.jsx(ue,{posts:Q,onPostClick:te})})]}),e.jsx(he,{open:l,onOpenChange:a,post:m,onSave:ke,defaultPlatform:s}),e.jsx(he,{open:M,onOpenChange:F,post:null,onSave:Ce,defaultPlatform:s}),e.jsx(ts,{open:g,onOpenChange:k,post:T,onSchedule:Se})]})}function pe({posts:s,suggestedPosts:j,approvedPosts:n,statusFilter:f,setStatusFilter:r,loading:o,onApprove:c,onReject:u,onEdit:p,onSchedule:v,onPublish:l,onDelete:a}){const m=[{value:"all",label:"All",count:s.length},{value:"suggested",label:"Suggested"},{value:"approved",label:"Approved"},{value:"scheduled",label:"Scheduled"},{value:"published",label:"Published"},{value:"rejected",label:"Rejected"}];return o?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading posts..."})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(Je,{className:"h-4 w-4 text-muted-foreground"}),m.map(d=>e.jsx("button",{onClick:()=>r(d.value),className:`inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors ${f===d.value?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:d.label},d.value))]}),s.length===0?e.jsxs("div",{className:"text-center py-16 space-y-3",children:[e.jsx(we,{className:"h-10 w-10 text-muted-foreground/40 mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-muted-foreground",children:"No posts yet"}),e.jsx("p",{className:"text-sm text-muted-foreground/70 mt-1",children:"Create a new post or wait for James to generate suggestions"})]})]}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:s.map(d=>e.jsx(ss,{post:d,onApprove:c,onReject:u,onEdit:p,onSchedule:v,onPublish:l,onDelete:a},d.id))})]})}export{Ms as SocialMediaPage};
