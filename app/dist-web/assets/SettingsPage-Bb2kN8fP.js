const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DV0Z4ueH.js","assets/core-BDPGcIsz.js","assets/index-CDjnCujr.js","assets/path-E9zjYLSN.js","assets/index-RJ0cNIvj.js","assets/vendor-react-DeR5d9Tv.js","assets/vendor-router-9bGSKQ4q.js","assets/index-B4ngvJNs.css"])))=>i.map(i=>d[i]);
var we=Object.defineProperty;var Ce=(s,a,t)=>a in s?we(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var re=(s,a,t)=>Ce(s,typeof a!="symbol"?a+"":a,t);import{r as x,j as e}from"./vendor-react-DeR5d9Tv.js";import{c as L,_ as V,N as W,O as Ee,P as de,l as d,L as h,I as v,a as f,E as Se,F as De,B as Re,C as Be,f as K,m as U,r as H}from"./index-RJ0cNIvj.js";import{getDb as X,getSchemaVersion as Ie}from"./db.web-lSIIGn2q.js";import{C as S,a as D,b as R,d as P,c as B}from"./card-DIHf8IPz.js";import{U as ue}from"./user-BIe_mpN7.js";import{F as Te}from"./folder-open-D8bl207p.js";import{S as ee,a as se,b as te,c as ae,d as T}from"./select-D2VRqISc.js";import{S as ie}from"./shield-9-zPRDhl.js";import{R as J}from"./refresh-cw-BF2wuY2y.js";import{D as me}from"./download-DwxoQ9rF.js";import{A as Pe,a as Fe,b as Oe,c as Ae,d as Le,e as Me,f as _e,g as Ue,h as He}from"./alert-dialog-loSiUfM5.js";import{D as ze}from"./database-DVcWFYzI.js";import{U as Ge}from"./upload-C75Bp5yz.js";import{T as Je}from"./trash-2-D_2eI67k.js";import{G as Q}from"./github-AQaQrZUj.js";import{C as $e}from"./check-mFeD-rYu.js";import{C as Ve}from"./circle-alert-CffvCnOw.js";import{G as We,a as qe,C as Ye}from"./git-pull-request-DGrny6_H.js";import"./vendor-markdown-PIr_2kdo.js";import"./vendor-recharts-DrMJw15s.js";import"./vendor-radix-zn9KX-y8.js";import"./vendor-floating-ui-CESiY8Ey.js";import"./vendor-router-9bGSKQ4q.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=L("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=L("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=L("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=L("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=L("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=L("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);function $(){return typeof window<"u"&&"__TAURI__"in window&&!!window.__TAURI__}let z=null,G=null;async function le(){if(!$())throw new Error("Tauri modules not available in web environment");if(!z||!G){const[s,a]=await Promise.all([V(()=>import("./index-DV0Z4ueH.js"),__vite__mapDeps([0,1])),V(()=>import("./index-CDjnCujr.js"),__vite__mapDeps([2,3,1]))]);z=s,G=a}return{save:z.save,open:z.open,writeTextFile:G.writeTextFile,readTextFile:G.readTextFile}}function ss(s,a){const t=new Blob([s],{type:"application/json"}),i=URL.createObjectURL(t),c=document.createElement("a");c.href=i,c.download=a,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i)}function ts(){return new Promise(s=>{const a=document.createElement("input");a.type="file",a.accept=".json",a.onchange=async t=>{var p;const i=(p=t.target.files)==null?void 0:p[0];if(!i){s(null);return}const c=await i.text();s(c)},a.oncancel=()=>s(null),a.click()})}function oe(s){let a=0;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);a=(a<<5)-a+i,a=a&a}return`hash:${Math.abs(a).toString(16)}`}class as{constructor(){re(this,"APP_VERSION","1.0.0")}async exportBackup(){try{const a=await X(),t=await Ie(),[i,c,p,n,l,u,k]=await Promise.all([a.select("SELECT * FROM clients"),a.select("SELECT * FROM projects"),a.select("SELECT * FROM tasks"),a.select("SELECT * FROM time_entries"),a.select("SELECT * FROM invoices"),a.select("SELECT * FROM captures"),a.select("SELECT * FROM settings")]),y={version:this.APP_VERSION,exportedAt:new Date().toISOString(),schemaVersion:t,data:{clients:i,projects:c,tasks:p,time_entries:n,invoices:l,captures:u,settings:k}},b=JSON.stringify(y.data),N=oe(b),j={...y,checksum:N},C=`personal-assistant-backup-${new Date().toISOString().split("T")[0]}.json`,E=JSON.stringify(j,null,2);if($()){const{save:M,writeTextFile:O}=await le(),I=await M({defaultPath:C,filters:[{name:"JSON",extensions:["json"]}]});return I?(await O(I,E),{success:!0,filePath:I}):{success:!1,error:"Export cancelled"}}else return ss(E,C),{success:!0,filePath:C}}catch(a){return console.error("Backup export failed:",a),{success:!1,error:a instanceof Error?a.message:"Export failed"}}}async importBackup(){try{let a;if($()){const{open:u,readTextFile:k}=await le(),y=await u({filters:[{name:"JSON",extensions:["json"]}],multiple:!1});if(!y||Array.isArray(y))return{success:!1,error:"Import cancelled"};a=await k(y)}else a=await ts();if(!a)return{success:!1,error:"Import cancelled"};const t=JSON.parse(a),i=this.validateBackup(t);if(i)return{success:!1,error:i};const c=JSON.stringify(t.data);if(oe(c)!==t.checksum)return{success:!1,error:"Backup file is corrupted (checksum mismatch)"};const n=await X();await n.execute("DELETE FROM captures"),await n.execute("DELETE FROM time_entries"),await n.execute("DELETE FROM invoices"),await n.execute("DELETE FROM tasks"),await n.execute("DELETE FROM projects"),await n.execute("DELETE FROM clients"),await n.execute("DELETE FROM settings");let l=0;for(const u of t.data.clients)await this.insertRecord(n,"clients",u),l++;for(const u of t.data.projects)await this.insertRecord(n,"projects",u),l++;for(const u of t.data.tasks)await this.insertRecord(n,"tasks",u),l++;for(const u of t.data.time_entries)await this.insertRecord(n,"time_entries",u),l++;for(const u of t.data.invoices)await this.insertRecord(n,"invoices",u),l++;for(const u of t.data.captures)await this.insertRecord(n,"captures",u),l++;for(const u of t.data.settings)await this.insertRecord(n,"settings",u),l++;return{success:!0,stats:{tables:7,records:l}}}catch(a){return console.error("Backup import failed:",a),{success:!1,error:a instanceof Error?a.message:"Import failed"}}}validateBackup(a){if(!a||typeof a!="object")return"Invalid backup file format";const t=a;if(!t.version||typeof t.version!="string")return"Missing or invalid version";if(!t.exportedAt||typeof t.exportedAt!="string")return"Missing or invalid export date";if(typeof t.schemaVersion!="number")return"Missing or invalid schema version";if(!t.data||typeof t.data!="object")return"Missing or invalid data";if(!t.checksum||typeof t.checksum!="string")return"Missing or invalid checksum";const i=t.data,c=["clients","projects","tasks","time_entries","invoices","captures","settings"];for(const p of c)if(!Array.isArray(i[p]))return`Missing or invalid table: ${p}`;return null}async insertRecord(a,t,i){const c=Object.keys(i),p=c.map(()=>"?").join(", "),n=Object.values(i);await a.execute(`INSERT INTO ${t} (${c.join(", ")}) VALUES (${p})`,n)}async getBackupStats(){var a,t,i,c,p,n;if($()){const l=await X(),[u,k,y,b,N,j]=await Promise.all([l.select("SELECT COUNT(*) as count FROM clients"),l.select("SELECT COUNT(*) as count FROM projects"),l.select("SELECT COUNT(*) as count FROM tasks"),l.select("SELECT COUNT(*) as count FROM time_entries"),l.select("SELECT COUNT(*) as count FROM invoices"),l.select("SELECT COUNT(*) as count FROM captures")]);return{clients:((a=u[0])==null?void 0:a.count)||0,projects:((t=k[0])==null?void 0:t.count)||0,tasks:((i=y[0])==null?void 0:i.count)||0,timeEntries:((c=b[0])==null?void 0:c.count)||0,invoices:((p=N[0])==null?void 0:p.count)||0,captures:((n=j[0])==null?void 0:n.count)||0}}else{const{api:l}=await V(async()=>{const{api:C}=await import("./index-RJ0cNIvj.js").then(E=>E.aj);return{api:C}},__vite__mapDeps([4,5,6,7])),[u,k,y,b,N,j]=await Promise.all([l.getClients(),l.getProjects(),l.getTasks(),l.getTimeEntries(),l.getInvoices(),l.getCaptures()]);return{clients:u.length,projects:k.length,tasks:y.length,timeEntries:b.length,invoices:N.length,captures:j.length}}}}const Z=new as;async function pe(){return W.get("/backups/status")}async function ns(){return W.post("/backups/trigger")}async function rs(){var i;const s=await W.requestBlob("/backups/download"),a=URL.createObjectURL(s),t=document.createElement("a");try{const c=await pe();t.download=((i=c.lastBackup)==null?void 0:i.filename)||"pa-backup.enc"}catch{t.download="pa-backup.enc"}t.href=a,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)}async function is(){const s=await W.requestBlob("/backups/export?format=json"),a=URL.createObjectURL(s),t=document.createElement("a"),i=new Date().toISOString().split("T")[0];t.download=`pa-export-${i}.json`,t.href=a,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)}const cs={fullName:"",jobTitle:"",email:"",phone:"",street:"",postalCode:"",city:"",country:"Deutschland",vatId:"",taxId:"",bankAccountHolder:"",bankName:"",bankIban:"",bankBic:""};function ls(){const s=Ee(),[a,t]=x.useState(s.workspacePath||""),[i,c]=x.useState(s.userName||""),[p,n]=x.useState(!1),[l,u]=x.useState(!1),[k,y]=x.useState(s.businessProfile||cs),[b,N]=x.useState(!1),[j,C]=x.useState(null),[E,M]=x.useState(null),[O,I]=x.useState(!1),[q,A]=x.useState(!1),[_,F]=x.useState(!1);x.useEffect(()=>{s.businessProfile&&y(s.businessProfile)},[s.businessProfile]),x.useEffect(()=>{async function o(){try{const m=await Z.getBackupStats();C(m)}catch(m){console.error("Failed to load data stats:",m)}}o()},[]);const r=x.useCallback(async()=>{if(de())try{const o=await pe();M(o)}catch(o){console.error("Failed to load backup status:",o)}},[]);x.useEffect(()=>{r()},[r]);const g=async()=>{var o;I(!0);try{const m=await ns();m.success?(d.success(`Backup created: ${(o=m.backup)==null?void 0:o.filename}`),await r()):d.error(m.error||"Backup failed")}catch(m){console.error("Backup trigger failed:",m),d.error("Failed to create backup")}finally{I(!1)}},Y=async()=>{A(!0);try{await rs(),d.success("Backup download started")}catch(o){console.error("Backup download failed:",o),d.error("Failed to download backup")}finally{A(!1)}},xe=async()=>{F(!0);try{await is(),d.success("JSON export download started")}catch(o){console.error("JSON export failed:",o),d.error("Failed to export data")}finally{F(!1)}},he=async()=>{a.trim()?(await s.setWorkspacePath(a.trim()),d.success("Workspace path saved")):(await s.setWorkspacePath(void 0),d.success("Workspace path cleared"))},je=async()=>{i.trim()&&(await s.setUserName(i.trim()),d.success("Name saved"))},fe=async()=>{N(!0);try{await s.setBusinessProfile(k),d.success("Business profile saved")}catch(o){console.error("Failed to save business profile:",o),d.error("Failed to save business profile")}finally{N(!1)}},ne=(o,m)=>{y(w=>({...w,[o]:m}))},ge=o=>o.replace(/\s/g,"").toUpperCase().replace(/(.{4})/g,"$1 ").trim(),ye=o=>{const m=o.replace(/\s/g,"").toUpperCase();ne("bankIban",m)},ve=async()=>{n(!0);try{const o=await Z.exportBackup();o.success?d.success("Backup exported successfully"):o.error!=="Export cancelled"&&d.error(o.error||"Export failed")}catch(o){console.error("Export failed:",o),d.error("Failed to export backup")}finally{n(!1)}},ke=async()=>{var o,m;u(!0);try{const w=await Z.importBackup();w.success?(d.success(`Backup restored: ${(o=w.stats)==null?void 0:o.records} records across ${(m=w.stats)==null?void 0:m.tables} tables`),window.location.reload()):w.error!=="Import cancelled"&&d.error(w.error||"Import failed")}catch(w){console.error("Import failed:",w),d.error("Failed to import backup")}finally{u(!1)}},Ne=async()=>{try{const{getDb:o}=await V(async()=>{const{getDb:w}=await import("./db.web-lSIIGn2q.js");return{getDb:w}},[]),m=await o();await m.execute("DELETE FROM captures"),await m.execute("DELETE FROM time_entries"),await m.execute("DELETE FROM invoices"),await m.execute("DELETE FROM tasks"),await m.execute("DELETE FROM projects"),await m.execute("DELETE FROM clients"),await m.execute("DELETE FROM settings"),d.success("All data cleared"),window.location.reload()}catch(o){console.error("Clear data failed:",o),d.error("Failed to clear data")}},be=j?j.clients+j.projects+j.tasks+j.timeEntries+j.invoices+j.captures:0;return{...s,pathInput:a,setPathInput:t,nameInput:i,setNameInput:c,profileForm:k,isSavingProfile:b,dataStats:j,totalRecords:be,isExporting:p,isImporting:l,backupStatus:E,isBackingUp:O,isDownloadingBackup:q,isExportingJson:_,handleSaveWorkspacePath:he,handleSaveUserName:je,handleSaveBusinessProfile:fe,updateProfileField:ne,formatIban:ge,handleIbanChange:ye,handleTriggerBackup:g,handleDownloadBackup:Y,handleExportJson:xe,handleExportData:ve,handleImportData:ke,handleClearAllData:Ne}}function os({nameInput:s,setNameInput:a,onSave:t}){return e.jsxs(S,{children:[e.jsxs(D,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Profile"]}),e.jsx(P,{children:"Your personal information displayed in the sidebar."})]}),e.jsx(B,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"user-name",children:"Display Name"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{id:"user-name",value:s,onChange:i=>a(i.target.value),placeholder:"Your name",className:"flex-1"}),e.jsx(f,{onClick:t,children:"Save"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This name appears next to your profile icon in the sidebar."})]})})]})}function ds({profileForm:s,isSavingProfile:a,onUpdateField:t,onIbanChange:i,formatIban:c,onSave:p}){return e.jsxs(S,{children:[e.jsxs(D,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5"}),"Business Profile"]}),e.jsx(P,{children:"Your business information for invoices and official documents."})]}),e.jsxs(B,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Personal Information"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-fullName",children:"Full Name"}),e.jsx(v,{id:"bp-fullName",value:s.fullName,onChange:n=>t("fullName",n.target.value),placeholder:"Max Mustermann"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-jobTitle",children:"Job Title"}),e.jsx(v,{id:"bp-jobTitle",value:s.jobTitle,onChange:n=>t("jobTitle",n.target.value),placeholder:"Full-Stack Developer"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-email",children:"Business Email"}),e.jsx(v,{id:"bp-email",type:"email",value:s.email,onChange:n=>t("email",n.target.value),placeholder:"kontakt@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-phone",children:"Phone (optional)"}),e.jsx(v,{id:"bp-phone",type:"tel",value:s.phone||"",onChange:n=>t("phone",n.target.value),placeholder:"+49 123 456789"})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),"Address"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-street",children:"Street Address"}),e.jsx(v,{id:"bp-street",value:s.street,onChange:n=>t("street",n.target.value),placeholder:"MusterstraÃŸe 123"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-postalCode",children:"Postal Code"}),e.jsx(v,{id:"bp-postalCode",value:s.postalCode,onChange:n=>t("postalCode",n.target.value),placeholder:"12345"})]}),e.jsxs("div",{className:"space-y-2 col-span-1 sm:col-span-2",children:[e.jsx(h,{htmlFor:"bp-city",children:"City"}),e.jsx(v,{id:"bp-city",value:s.city,onChange:n=>t("city",n.target.value),placeholder:"Berlin"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-country",children:"Country"}),e.jsx(v,{id:"bp-country",value:s.country,onChange:n=>t("country",n.target.value),placeholder:"Deutschland"})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4"}),"Tax Information"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-vatId",children:"USt-IdNr (VAT ID)"}),e.jsx(v,{id:"bp-vatId",value:s.vatId||"",onChange:n=>t("vatId",n.target.value.toUpperCase()),placeholder:"DE123456789"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Required for EU B2B invoices"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-taxId",children:"Steuernummer (Tax Number)"}),e.jsx(v,{id:"bp-taxId",value:s.taxId||"",onChange:n=>t("taxId",n.target.value),placeholder:"123/456/78901"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your local tax office number"})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Bank Details"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-bankAccountHolder",children:"Account Holder"}),e.jsx(v,{id:"bp-bankAccountHolder",value:s.bankAccountHolder,onChange:n=>t("bankAccountHolder",n.target.value),placeholder:"Max Mustermann"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-bankName",children:"Bank Name"}),e.jsx(v,{id:"bp-bankName",value:s.bankName,onChange:n=>t("bankName",n.target.value),placeholder:"Sparkasse Berlin"})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[e.jsx(h,{htmlFor:"bp-bankIban",children:"IBAN"}),e.jsx(v,{id:"bp-bankIban",value:c(s.bankIban),onChange:n=>i(n.target.value),placeholder:"DE89 3704 0044 0532 0130 00",className:"font-mono"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-bankBic",children:"BIC/SWIFT"}),e.jsx(v,{id:"bp-bankBic",value:s.bankBic,onChange:n=>t("bankBic",n.target.value.toUpperCase()),placeholder:"COBADEFFXXX",className:"font-mono"})]})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx(f,{onClick:p,disabled:a,children:a?"Saving...":"Save Business Profile"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"This information will be used in your invoice PDFs."})]})]})]})}function us({theme:s,onSetTheme:a}){return e.jsxs(S,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Appearance"}),e.jsx(P,{children:"Customize the look and feel."})]}),e.jsx(B,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Theme"}),e.jsx("div",{className:"flex gap-2",children:["light","dark","system"].map(t=>e.jsx(f,{variant:s===t?"default":"outline",size:"sm",onClick:()=>a(t),className:"capitalize",children:t},t))})]})})]})}function ms({pathInput:s,setPathInput:a,workspacePath:t,onSave:i}){return e.jsxs(S,{children:[e.jsxs(D,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5"}),"Workspace"]}),e.jsx(P,{children:"Configure your Obsidian workspace location for markdown integration."})]}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"workspace-path",children:"Workspace Path"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{id:"workspace-path",value:s,onChange:c=>a(c.target.value),placeholder:"/Users/you/Documents/Obsidian/Vault",className:"flex-1"}),e.jsx(f,{onClick:i,children:"Save"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Path to your Obsidian vault or markdown workspace. Used for exporting and linking files."})]}),t&&e.jsxs("div",{className:"rounded-lg bg-muted p-3 text-sm",children:[e.jsx("p",{className:"font-medium",children:"Current workspace:"}),e.jsx("code",{className:"text-xs text-muted-foreground",children:t})]})]})]})}function ps({defaultArea:s,defaultCurrency:a,onSetDefaultArea:t,onSetDefaultCurrency:i}){return e.jsxs(S,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Defaults"}),e.jsx(P,{children:"Set default values for new items."})]}),e.jsx(B,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Default Area"}),e.jsxs(ee,{value:s,onValueChange:c=>t(c),children:[e.jsx(se,{children:e.jsx(te,{})}),e.jsxs(ae,{children:[e.jsx(T,{value:"wellfy",children:"Wellfy"}),e.jsx(T,{value:"freelance",children:"Freelance"}),e.jsx(T,{value:"personal",children:"Personal"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Default Currency"}),e.jsxs(ee,{value:a,onValueChange:i,children:[e.jsx(se,{children:e.jsx(te,{})}),e.jsxs(ae,{children:[e.jsx(T,{value:"EUR",children:"EUR"}),e.jsx(T,{value:"USD",children:"USD"}),e.jsx(T,{value:"GBP",children:"GBP"}),e.jsx(T,{value:"CHF",children:"CHF"})]})]})]})]})})]})}function xs({backupStatus:s,isBackingUp:a,isDownloadingBackup:t,isExportingJson:i,onTriggerBackup:c,onDownloadBackup:p,onExportJson:n}){return e.jsxs(S,{children:[e.jsxs(D,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Backup & Export"]}),e.jsx(P,{children:"Automated encrypted backups and data export. Backups are encrypted with AES-256-GCM."})]}),e.jsxs(B,{className:"space-y-4",children:[s&&e.jsxs("div",{className:"rounded-lg bg-muted p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),"Backup Status"]}),e.jsx(Re,{variant:s.encryptionKeyAvailable?"default":"destructive",children:s.encryptionKeyAvailable?"ðŸ”’ Encryption Active":"âš ï¸ No Key"})]}),s.lastBackup?e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Be,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:["Last backup:"," ",e.jsx("span",{className:"text-foreground font-medium",children:new Date(s.lastBackup.date).toLocaleString("de-DE",{dateStyle:"medium",timeStyle:"short"})})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground pl-5",children:[s.lastBackup.filename," (",(s.lastBackup.sizeBytes/1024).toFixed(1)," KB)"]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No backups yet. Create your first backup below."}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ðŸ“¦ ",s.totalBackups," backup(s) stored in ",e.jsx("code",{className:"text-xs",children:s.backupDir})]})]}),s&&s.recentBackups.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Recent Backups"}),e.jsx("div",{className:"rounded-lg border divide-y",children:s.recentBackups.map(l=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(ie,{className:"h-3.5 w-3.5 text-green-500 shrink-0"}),e.jsx("span",{className:"truncate font-mono text-xs",children:l.filename})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground shrink-0",children:[e.jsxs("span",{children:[(l.sizeBytes/1024).toFixed(1)," KB"]}),e.jsx("span",{children:new Date(l.date).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]},l.filename))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(f,{variant:"default",onClick:c,disabled:a,children:[e.jsx(J,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),a?"Backing up...":"Create Backup"]}),e.jsxs(f,{variant:"outline",onClick:p,disabled:t||!(s!=null&&s.lastBackup),children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),t?"Downloading...":"Download Backup"]}),e.jsxs(f,{variant:"outline",onClick:n,disabled:i,children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),i?"Exporting...":"Export JSON"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Create Backup:"})," Encrypted backup saved on server (auto-rotated, 30 days).",e.jsx("br",{}),e.jsx("strong",{children:"Download Backup:"})," Download the latest encrypted backup file.",e.jsx("br",{}),e.jsx("strong",{children:"Export JSON:"})," Download all data as unencrypted JSON (for portability)."]})]})]})}function hs({dataStats:s,totalRecords:a,isExporting:t,isImporting:i,onExport:c,onImport:p,onClearAll:n}){return e.jsxs(S,{children:[e.jsxs(D,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-5 w-5"}),"Data Management"]}),e.jsx(P,{children:"Your data is stored locally in SQLite. Export backups to keep your data safe."})]}),e.jsxs(B,{className:"space-y-4",children:[s&&e.jsxs("div",{className:"rounded-lg bg-muted p-3 text-sm",children:[e.jsxs("p",{className:"font-medium mb-2",children:["Current Data (",a," total)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s.clients," clients"]}),e.jsxs("span",{children:[s.projects," projects"]}),e.jsxs("span",{children:[s.tasks," tasks"]}),e.jsxs("span",{children:[s.timeEntries," time entries"]}),e.jsxs("span",{children:[s.invoices," invoices"]}),e.jsxs("span",{children:[s.captures," captures"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(f,{variant:"outline",onClick:c,disabled:t,children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),t?"Exporting...":"Export Backup"]}),e.jsxs(f,{variant:"outline",onClick:p,disabled:i,children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),i?"Importing...":"Import Backup"]}),e.jsxs(Pe,{children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(f,{variant:"destructive",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Clear All Data"]})}),e.jsxs(Oe,{children:[e.jsxs(Ae,{children:[e.jsx(Le,{children:"Are you absolutely sure?"}),e.jsx(Me,{children:"This action cannot be undone. This will permanently delete all your tasks, time entries, clients, projects, invoices, and captures from the database."})]}),e.jsxs(_e,{children:[e.jsx(Ue,{children:"Cancel"}),e.jsx(He,{onClick:n,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Yes, delete everything"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Export creates a JSON backup of all your data. Import restores from a previous backup.",e.jsx("strong",{className:"block mt-1",children:"Tip: Export backups regularly to protect your data."})]})]})]})}function js(){const[s,a]=x.useState([]),[t,i]=x.useState(!1),[c,p]=x.useState(null),[n,l]=x.useState(!1),[u,k]=x.useState(null),[y,b]=x.useState(null),[N,j]=x.useState(""),{projects:C}=K(),E=x.useCallback(async()=>{i(!0);try{const r=await U.getGitHubRepos();a(r.repos||[]),p(r.authenticated!==!1)}catch{d.error("Failed to fetch GitHub repos"),p(!1)}finally{i(!1)}},[]);x.useEffect(()=>{E()},[E]);const M=async()=>{l(!0),k(null);try{const r=await U.syncAllGitHubRepos(7);k(r.results),d.success(`Synced ${r.totalRepos} repos, imported ${r.totalImported} items`)}catch{d.error("Failed to sync GitHub repos")}finally{l(!1)}},O=async r=>{l(!0);try{const g=await U.syncGitHubRepo(r,30);k([g.result]);const Y=g.result.commitsImported+g.result.prsImported+g.result.issuesImported;d.success(`Imported ${Y} items from ${r}`)}catch{d.error(`Failed to sync ${r}`)}finally{l(!1)}},I=async(r,g)=>{try{await U.linkGitHubRepo(r,g),d.success(`Linked ${g} to project`),b(null),j(""),K.getState().initialize()}catch{d.error("Failed to link repo")}},q=async r=>{try{await U.unlinkGitHubRepo(r),d.success("Unlinked GitHub repo from project"),K.getState().initialize()}catch{d.error("Failed to unlink repo")}},A=r=>{const g=r;return g.githubRepo||g.github_repo},_=C.filter(r=>A(r)),F=C.filter(r=>!A(r));return e.jsxs(S,{children:[e.jsxs(D,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"GitHub Integration"]}),e.jsx(P,{children:"Connect GitHub repositories to projects for automatic activity tracking. Commits, PRs, and issues are imported and time estimates are auto-calculated."})]}),e.jsxs(B,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:c===null?e.jsx(H,{className:"h-4 w-4 animate-spin text-muted-foreground"}):c?e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400",children:["Connected as ",e.jsx("strong",{children:"justindeisler"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"GitHub CLI not authenticated"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:E,disabled:t,children:[t?e.jsx(H,{className:"h-4 w-4 animate-spin mr-1"}):e.jsx(J,{className:"h-4 w-4 mr-1"}),"Refresh"]}),e.jsxs(f,{size:"sm",onClick:M,disabled:n||_.length===0,children:[n?e.jsx(H,{className:"h-4 w-4 animate-spin mr-1"}):e.jsx(J,{className:"h-4 w-4 mr-1"}),"Sync All"]})]})]}),_.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Linked Repositories"}),e.jsx("div",{className:"space-y-2",children:_.map(r=>{const g=A(r)||"";return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:r.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>O(g),disabled:n,children:n?e.jsx(H,{className:"h-3 w-3 animate-spin"}):e.jsx(J,{className:"h-3 w-3"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>q(r.id),children:e.jsx(es,{className:"h-3 w-3"})})]})]},r.id)})})]}),F.length>0&&s.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Link Repository to Project"}),y?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ee,{value:N,onValueChange:j,children:[e.jsx(se,{className:"flex-1",children:e.jsx(te,{placeholder:"Select a repository..."})}),e.jsx(ae,{children:s.map(r=>e.jsxs(T,{value:r.fullName,children:[r.name,r.description&&e.jsxs("span",{className:"text-muted-foreground ml-2",children:["â€” ",r.description.substring(0,50)]})]},r.fullName))})]}),e.jsxs(f,{size:"sm",onClick:()=>I(y,N),disabled:!N,children:[e.jsx(ce,{className:"h-4 w-4 mr-1"}),"Link"]}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>{b(null),j("")},children:"Cancel"})]}):e.jsxs("div",{className:"flex flex-wrap gap-2",children:[F.slice(0,8).map(r=>e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>b(r.id),children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),r.name]},r.id)),F.length>8&&e.jsxs("span",{className:"text-xs text-muted-foreground self-center",children:["+",F.length-8," more"]})]})]}),s.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-medium",children:["Available Repositories (",s.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:s.map(r=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-muted/50 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{children:r.name}),r.description&&e.jsxs("span",{className:"text-muted-foreground text-xs hidden sm:inline",children:["â€” ",r.description.substring(0,40)]})]}),e.jsx(f,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>O(r.fullName),disabled:n,children:"Sync"})]},r.fullName))})]}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Sync Results"}),e.jsx("div",{className:"space-y-2",children:u.map((r,g)=>e.jsxs("div",{className:"rounded-lg border p-3 text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:r.repo}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.duration,"ms"]})]}),e.jsxs("div",{className:"flex gap-3 text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(We,{className:"h-3 w-3"}),r.commitsImported," commits"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(qe,{className:"h-3 w-3"}),r.prsImported," PRs"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"h-3 w-3"}),r.issuesImported," issues"]})]}),r.commitsSkipped+r.prsSkipped+r.issuesSkipped>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Skipped ",r.commitsSkipped+r.prsSkipped+r.issuesSkipped," duplicates"]}),r.errors.length>0&&e.jsxs("div",{className:"text-xs text-red-500",children:[r.errors.length," error(s)"]})]},g))})]}),s.length===0&&!t&&c&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No repositories found. Make sure you have repos on GitHub."})]})]})}function fs(){return e.jsxs(S,{children:[e.jsx(D,{children:e.jsx(R,{children:"About"})}),e.jsxs(B,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Personal Assistant Dashboard v0.1.0"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Built with Tauri, React, and TypeScript"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Data stored in: ~/Library/Application Support/com.personal-assistant.app/"})]})]})}function zs(){const s=ls();return e.jsxs("div",{className:"space-y-6 max-w-2xl",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Settings"})}),e.jsx(os,{nameInput:s.nameInput,setNameInput:s.setNameInput,onSave:s.handleSaveUserName}),e.jsx(ds,{profileForm:s.profileForm,isSavingProfile:s.isSavingProfile,onUpdateField:s.updateProfileField,onIbanChange:s.handleIbanChange,formatIban:s.formatIban,onSave:s.handleSaveBusinessProfile}),e.jsx(us,{theme:s.theme,onSetTheme:s.setTheme}),e.jsx(ms,{pathInput:s.pathInput,setPathInput:s.setPathInput,workspacePath:s.workspacePath,onSave:s.handleSaveWorkspacePath}),e.jsx(ps,{defaultArea:s.defaultArea,defaultCurrency:s.defaultCurrency,onSetDefaultArea:s.setDefaultArea,onSetDefaultCurrency:s.setDefaultCurrency}),de()&&e.jsx(xs,{backupStatus:s.backupStatus,isBackingUp:s.isBackingUp,isDownloadingBackup:s.isDownloadingBackup,isExportingJson:s.isExportingJson,onTriggerBackup:s.handleTriggerBackup,onDownloadBackup:s.handleDownloadBackup,onExportJson:s.handleExportJson}),e.jsx(js,{}),e.jsx(hs,{dataStats:s.dataStats,totalRecords:s.totalRecords,isExporting:s.isExporting,isImporting:s.isImporting,onExport:s.handleExportData,onImport:s.handleImportData,onClearAll:s.handleClearAllData}),e.jsx(fs,{})]})}export{zs as SettingsPage};
