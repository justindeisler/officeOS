import{r}from"./vendor-react-wuMqdllU.js";import{l}from"./index-BJ9hpEov.js";function S(u={}){const{year:k=new Date().getFullYear(),autoFetch:i=!0}=u,[c,f]=r.useState([]),[h,P]=r.useState([]),[m,d]=r.useState(!1),[y,o]=r.useState(null),[n,p]=r.useState(k),t=r.useCallback(async()=>{d(!0),o(null);try{const e=await l.getPeriodLocks({year:n});f(e.periods||[]),P(e.locks||[])}catch(e){o(e instanceof Error?e.message:"Fehler beim Laden der Periodensperre")}finally{d(!1)}},[n]),w=r.useCallback(async(e,a)=>{o(null);try{await l.lockPeriod(e,a),await t()}catch(s){throw o(s instanceof Error?s.message:"Fehler beim Sperren"),s}},[t]),L=r.useCallback(async(e,a)=>{o(null);try{await l.unlockPeriod(e,a),await t()}catch(s){throw o(s instanceof Error?s.message:"Fehler beim Entsperren"),s}},[t]),b=r.useCallback(e=>c.some(a=>a.key===e&&a.locked),[c]);return r.useEffect(()=>{i&&t()},[i,t]),{periods:c,locks:h,isLoading:m,error:y,selectedYear:n,setSelectedYear:p,lockPeriod:w,unlockPeriod:L,refresh:t,isPeriodLocked:b}}export{S as u};
