import{j as e,r as h}from"./vendor-react-wuMqdllU.js";import{l as F,I as V,a as v,B as I,S as j,F as Y,G as Z,H as ee,i as k}from"./index-BVfXMJeG.js";import{i as T,Q as q,X as G,a5 as se,at as W,au as te,F as re,av as ae,g as ne,K as le,d as X,C as oe,E as ie}from"./vendor-icons-lkZWRnZW.js";import{A as ce,m as S}from"./vendor-framer-motion-C26rlN9R.js";import{u as me,r as de,a as ue,V as xe,b as he,v as fe,t as pe,d as ge}from"./vendor-markdown-C3iCDuOK.js";import{n as be,f as je}from"./vendor-date-fns-D0ugVOfH.js";import"./vendor-recharts-tRgwS7-V.js";import"./vendor-radix-BCh4MJnw.js";import"./vendor-floating-ui-BD6aHMKr.js";import"./vendor-router-Cm8Qzw9U.js";const O={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},we="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",J=[],K={allowDangerousHtml:!0},Ne=/^(https?|ircs?|mailto|xmpp)$/i,ye=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function ve(t){const a=ke(t),r=Se(t);return Ee(a.runSync(a.parse(r),r),t)}function ke(t){const a=t.rehypePlugins||J,r=t.remarkPlugins||J,u=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...K}:K;return me().use(de).use(r).use(ue,u).use(a)}function Se(t){const a=t.children||"",r=new xe;return typeof a=="string"&&(r.value=a),r}function Ee(t,a){const r=a.allowedElements,u=a.allowElement,s=a.components,f=a.disallowedElements,i=a.skipHtml,b=a.unwrapDisallowed,p=a.urlTransform||Ce;for(const l of ye)Object.hasOwn(a,l.from)&&he("Unexpected `"+l.from+"` prop, "+(l.to?"use `"+l.to+"` instead":"remove it")+" (see <"+we+"#"+l.id+"> for more info)");return fe(t,c),pe(t,{Fragment:e.Fragment,components:s,ignoreInvalidStyle:!0,jsx:e.jsx,jsxs:e.jsxs,passKeys:!0,passNode:!0});function c(l,x,g){if(l.type==="raw"&&g&&typeof x=="number")return i?g.children.splice(x,1):g.children[x]={type:"text",value:l.value},x;if(l.type==="element"){let o;for(o in O)if(Object.hasOwn(O,o)&&Object.hasOwn(l.properties,o)){const w=l.properties[o],N=O[o];(N===null||N.includes(l.tagName))&&(l.properties[o]=p(String(w||""),o,l))}}if(l.type==="element"){let o=r?!r.includes(l.tagName):f?f.includes(l.tagName):!1;if(!o&&u&&typeof x=="number"&&(o=!u(l,x,g)),o&&g&&typeof x=="number")return b&&l.children?g.children.splice(x,1,...l.children):g.children.splice(x,1),x}}}function Ce(t){const a=t.indexOf(":"),r=t.indexOf("?"),u=t.indexOf("#"),s=t.indexOf("/");return a===-1||s!==-1&&a>s||r!==-1&&a>r||u!==-1&&a>u||Ne.test(t.slice(0,a))?t:""}const D=[.16,1,.3,1],Fe={"":{icon:X,label:"Root",description:"Top-level documents"},journal:{icon:le,label:"Journal",description:"Daily entries and reflections"},concepts:{icon:ne,label:"Concepts",description:"Deep dives into topics"},decisions:{icon:ae,label:"Decisions",description:"Important decisions with context"},projects:{icon:re,label:"Projects",description:"Project documentation"},research:{icon:te,label:"Research",description:"Research notes and explorations"}};function Oe(){const[t,a]=h.useState(!1);return h.useEffect(()=>{const r=()=>a(window.innerWidth<768);return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),t}function Ue(){const[t,a]=h.useState([]),[r,u]=h.useState(null),[s,f]=h.useState(""),[i,b]=h.useState(""),[p,c]=h.useState(null),[l,x]=h.useState(!0),[g,o]=h.useState(!1),[w,N]=h.useState(new Set(["journal","concepts","decisions","projects","research"])),[P,R]=h.useState(null),[M,B]=h.useState("list"),L=Oe();h.useEffect(()=>{E()},[]),h.useEffect(()=>{if(!i.trim()){c(null);return}const n=setTimeout(async()=>{try{const m=await F.searchSecondBrain(i);c(m.results)}catch(m){console.error("Search failed:",m)}},300);return()=>clearTimeout(n)},[i]);const E=async()=>{try{x(!0),R(null);const n=await F.getSecondBrainDocuments();if(a(n.folders),!L){const m=n.folders.flatMap(d=>d.documents)[0];m&&await C(m,!1)}}catch(n){console.error("Failed to load documents:",n),R("Failed to load documents. Make sure the API server is running.")}finally{x(!1)}},C=async(n,m=!0)=>{try{o(!0);const d=await F.getSecondBrainDocument(n.path);u({...n,content:d.content}),f(d.content),m&&L&&B("document")}catch(d){console.error("Failed to load document:",d),f(`# Error

Failed to load document content.`)}finally{o(!1)}},$=()=>{B("list")},z=n=>{N(m=>{const d=new Set(m);return d.has(n)?d.delete(n):d.add(n),d})},A=()=>{b(""),c(null)},H=h.useMemo(()=>{if(p){const n={};for(const m of p){const d=m.folder||"";n[d]||(n[d]=[]),n[d].push(m)}return Object.entries(n).map(([m,d])=>({name:m,documents:d}))}return t},[t,p]),y=t.reduce((n,m)=>n+m.documents.length,0),U={enter:n=>({x:n>0?"100%":"-100%",opacity:0}),center:{x:0,opacity:1},exit:n=>({x:n>0?"-100%":"100%",opacity:0})};return e.jsxs("div",{className:"flex flex-col h-[calc(100vh-4rem)] -m-4 sm:-m-6 md:-m-8 overflow-hidden",children:[e.jsxs("div",{className:"hidden md:flex md:flex-col h-full",children:[e.jsx("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(T,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"James's Brain"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[y," document",y!==1?"s":""," in your knowledge base"]})]})]})}),e.jsxs("div",{className:"flex flex-1 min-h-0",children:[e.jsxs("div",{className:"w-80 flex flex-col bg-muted/30 border-r",children:[e.jsxs("div",{className:"p-3 border-b",children:[e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(V,{placeholder:"Search documents...",value:i,onChange:n=>b(n.target.value),className:"pl-9 pr-9 h-9 bg-background"}),i&&e.jsx(v,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 min-h-[32px] min-w-[32px]",onClick:A,children:e.jsx(G,{className:"h-4 w-4"})})]}),p&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[p.length," result",p.length!==1?"s":"",' for "',i,'"']})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:e.jsx(Q,{isLoading:l,error:P,displayedFolders:H,expandedFolders:w,selectedDoc:r,searchQuery:i,onToggleFolder:z,onSelectDoc:C,onRetry:E})})]}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0 bg-background",children:e.jsx(_,{selectedDoc:r,docContent:s,isLoadingDoc:g})})]})]}),e.jsx("div",{className:"flex md:hidden flex-col h-full",children:e.jsx(ce,{mode:"wait",custom:M==="document"?1:-1,children:M==="list"?e.jsxs(S.div,{custom:-1,variants:U,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3,ease:D},className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-4 border-b bg-background/95 backdrop-blur",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(T,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"James's Brain"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[y," document",y!==1?"s":""]})]})]}),e.jsxs("div",{className:"p-3 border-b bg-background",children:[e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(V,{placeholder:"Search documents...",value:i,onChange:n=>b(n.target.value),className:"pl-9 pr-9 h-10 bg-muted/50"}),i&&e.jsx(v,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 min-h-[44px] min-w-[44px]",onClick:A,children:e.jsx(G,{className:"h-4 w-4"})})]}),p&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[p.length," result",p.length!==1?"s":"",' for "',i,'"']})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 bg-muted/20",children:e.jsx(Q,{isLoading:l,error:P,displayedFolders:H,expandedFolders:w,selectedDoc:r,searchQuery:i,onToggleFolder:z,onSelectDoc:C,onRetry:E})})]},"list"):e.jsxs(S.div,{custom:1,variants:U,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3,ease:D},className:"flex flex-col h-full bg-background",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 py-3 border-b bg-background/95 backdrop-blur",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:$,className:"shrink-0 min-h-[44px] min-w-[44px]",children:e.jsx(se,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-base font-semibold tracking-tight truncate",children:(r==null?void 0:r.title)||"Document"}),(r==null?void 0:r.folder)&&e.jsx(I,{variant:"outline",className:"text-xs capitalize mt-0.5",children:r.folder})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(_,{selectedDoc:r,docContent:s,isLoadingDoc:g,isMobile:!0})})]},"document")})})]})}function Q({isLoading:t,error:a,displayedFolders:r,expandedFolders:u,selectedDoc:s,searchQuery:f,onToggleFolder:i,onSelectDoc:b,onRetry:p}){return t?e.jsx("div",{className:"space-y-3 p-2",children:[1,2,3,4].map(c=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{className:"h-6 w-24"}),e.jsx(j,{className:"h-12 w-full"}),e.jsx(j,{className:"h-12 w-full"})]},c))}):a?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx(W,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a}),e.jsx(v,{variant:"outline",size:"sm",className:"mt-3 min-h-[44px]",onClick:p,children:"Retry"})]}):r.length===0||r.every(c=>c.documents.length===0)?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx(T,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f?"No documents match your search":"No documents yet"})]}):e.jsx("div",{className:"space-y-1",children:r.map(c=>{if(c.documents.length===0)return null;const l=Fe[c.name]||{icon:X,label:c.name||"Documents"},x=l.icon,g=u.has(c.name);return e.jsxs(Y,{open:g,onOpenChange:()=>i(c.name),children:[e.jsx(Z,{asChild:!0,children:e.jsxs("button",{className:"flex items-center gap-2 w-full px-3 py-2.5 min-h-[44px] rounded-md text-sm font-medium text-muted-foreground hover:bg-accent hover:text-accent-foreground transition-colors",children:[g?e.jsx(oe,{className:"h-4 w-4 shrink-0"}):e.jsx(ie,{className:"h-4 w-4 shrink-0"}),e.jsx(x,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"flex-1 text-left truncate",children:l.label}),e.jsx(I,{variant:"secondary",className:"text-xs font-normal",children:c.documents.length})]})}),e.jsx(ee,{children:e.jsx(S.div,{className:"ml-6 mt-1 space-y-0.5",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,ease:D},children:c.documents.map(o=>e.jsx(Te,{doc:o,isSelected:(s==null?void 0:s.path)===o.path,onClick:()=>b(o)},o.path))})})]},c.name)})})}function _({selectedDoc:t,docContent:a,isLoadingDoc:r,isMobile:u=!1}){return t?e.jsxs(e.Fragment,{children:[!u&&e.jsx("div",{className:"px-8 py-4 border-b",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-2xl font-semibold tracking-tight truncate",children:t.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-muted-foreground",children:[t.folder&&e.jsx(I,{variant:"outline",className:"capitalize",children:t.folder}),e.jsxs("span",{children:["Updated ",be(new Date(t.lastModified),{addSuffix:!0})]})]})]})})}),e.jsx("div",{className:k("flex-1 overflow-y-auto",u&&"pb-safe"),children:r?e.jsxs("div",{className:k("space-y-4",u?"p-4":"p-8"),children:[e.jsx(j,{className:"h-8 w-3/4"}),e.jsx(j,{className:"h-4 w-full"}),e.jsx(j,{className:"h-4 w-full"}),e.jsx(j,{className:"h-4 w-2/3"}),e.jsx(j,{className:"h-32 w-full mt-6"})]}):e.jsx("article",{className:k("prose prose-neutral dark:prose-invert max-w-none",u?"p-4":"p-8"),children:e.jsx(ve,{remarkPlugins:[ge],components:{h1:({children:s})=>e.jsx("h1",{className:"text-3xl font-bold tracking-tight mt-8 mb-4 first:mt-0 pb-2 border-b",children:s}),h2:({children:s})=>e.jsx("h2",{className:"text-2xl font-semibold tracking-tight mt-8 mb-3 pb-1 border-b border-border/50",children:s}),h3:({children:s})=>e.jsx("h3",{className:"text-xl font-semibold tracking-tight mt-6 mb-2",children:s}),h4:({children:s})=>e.jsx("h4",{className:"text-lg font-semibold mt-4 mb-2",children:s}),p:({children:s})=>e.jsx("p",{className:"leading-7 [&:not(:first-child)]:mt-4",children:s}),ul:({children:s})=>e.jsx("ul",{className:"my-4 ml-6 list-disc [&>li]:mt-2",children:s}),ol:({children:s})=>e.jsx("ol",{className:"my-4 ml-6 list-decimal [&>li]:mt-2",children:s}),li:({children:s})=>e.jsx("li",{className:"leading-7",children:s}),blockquote:({children:s})=>e.jsx("blockquote",{className:"mt-4 border-l-4 border-primary/30 pl-4 italic text-muted-foreground",children:s}),code:({className:s,children:f,...i})=>/language-(\w+)/.exec(s||"")?e.jsx("code",{className:s,...i,children:f}):e.jsx("code",{className:"relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono text-sm",...i,children:f}),pre:({children:s})=>e.jsx("pre",{className:"mt-4 mb-4 overflow-x-auto rounded-lg bg-muted/50 border p-4 font-mono text-sm",children:s}),a:({href:s,children:f})=>e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors",children:f}),hr:()=>e.jsx("hr",{className:"my-8 border-border"}),table:({children:s})=>e.jsx("div",{className:"my-6 w-full overflow-auto",children:e.jsx("table",{className:"w-full border-collapse border border-border",children:s})}),th:({children:s})=>e.jsx("th",{className:"border border-border bg-muted/50 px-4 py-2 text-left font-semibold",children:s}),td:({children:s})=>e.jsx("td",{className:"border border-border px-4 py-2",children:s}),img:({src:s,alt:f})=>e.jsx("img",{src:s,alt:f||"",className:"rounded-lg border my-4 max-w-full"})},children:a})})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{className:"h-16 w-16 mx-auto text-muted-foreground/30 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-muted-foreground",children:"Select a document to view"}),e.jsx("p",{className:"text-sm text-muted-foreground/70 mt-1",children:"Choose from the list on the left"})]})})}function Te({doc:t,isSelected:a,onClick:r}){return e.jsxs(S.button,{onClick:r,className:k("flex flex-col w-full px-3 py-2.5 min-h-[44px] rounded-md text-left transition-colors",a?"bg-primary/10 text-primary":"hover:bg-accent active:bg-accent/80"),whileTap:{scale:.98},transition:{duration:.1},children:[e.jsx("span",{className:"text-sm font-medium truncate",children:t.title}),e.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:je(new Date(t.lastModified),"MMM d, yyyy")})]})}export{Ue as SecondBrainPage};
