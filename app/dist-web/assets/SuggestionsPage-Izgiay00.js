import{r as l,j as e}from"./vendor-react-nkeu7MKf.js";import{c as Pe,m as j,l as x,B as A,a as p,X as E,F as U,r as $,j as ke,E as Z}from"./index-BOpLVEFI.js";import{T as le,a as ie,b as I,c as L}from"./tabs-CqZSqn6p.js";import{a as De}from"./vendor-router-bCYKpmtI.js";import{C as J,S as ee,a as te,b as se,c as ae,d as z}from"./select-Cw7tJKA2.js";import{T as Fe}from"./textarea-hmc_AYY0.js";import{D as oe,a as ce,b as de,c as me,d as xe,e as Re}from"./dialog-Bj0QQkc7.js";import{M as Ae}from"./message-square-lT4uiiVW.js";import{T as Te}from"./trash-2-CejOshdv.js";import{S as Me}from"./send-CO4hYyk2.js";import{f as K,n as Oe}from"./vendor-date-fns-D0ugVOfH.js";import{E as Ge}from"./external-link-DMLb5WFa.js";import{P as Ie}from"./play-gcgmes31.js";import{R as pe}from"./rotate-ccw-ge9jv2w5.js";import{C as Le,a as _e,b as ze,c as Ee}from"./card-DTxMX3rd.js";import{F as $e}from"./filter-DJ0FM8Jc.js";import{S as W}from"./sparkles-BYwgtRFs.js";import{F as re}from"./folder-open-C7twQdVs.js";import{C as qe}from"./circle-alert-BOcfHhve.js";import{S as He}from"./search-DLeO4Z_D.js";import{R as Ve}from"./refresh-cw-CIWLnc7C.js";import{C as Be}from"./circle-check-CVYOdwtD.js";import{A as Ue}from"./archive-DxgoIKlk.js";import"./vendor-markdown-zaQAhtrl.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-Oq5tdvA1.js";import"./vendor-floating-ui-_Y3uXdsy.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=Pe("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]),he={pending:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-400",approved:"bg-green-500/10 text-green-700 dark:text-green-400",rejected:"bg-red-500/10 text-red-700 dark:text-red-400",implemented:"bg-purple-500/10 text-purple-700 dark:text-purple-400"},ue={improvement:"bg-blue-500/10 text-blue-700 dark:text-blue-400",feature:"bg-green-500/10 text-green-700 dark:text-green-400",fix:"bg-red-500/10 text-red-700 dark:text-red-400",refactor:"bg-purple-500/10 text-purple-700 dark:text-purple-400",security:"bg-orange-500/10 text-orange-700 dark:text-orange-400"},ge={1:"Critical",2:"High",3:"Medium",4:"Low",5:"Minimal"};function je(t){const i=new Date(t.created_at);return(new Date().getTime()-i.getTime())/(1e3*60*60)<24}function Ke(){const t=De(),[i,s]=l.useState([]),[d,u]=l.useState(!0),[n,g]=l.useState(null),[m,c]=l.useState(!1),[v,S]=l.useState("active"),[N,b]=l.useState(!1),[P,w]=l.useState(!1),[k,f]=l.useState(!1),[T,M]=l.useState("newest"),[F,_]=l.useState("all"),[q,R]=l.useState([]),[H,O]=l.useState(!1),[r,y]=l.useState(""),[D,G]=l.useState(!1),C=async()=>{u(!0);try{const a=await j.getSuggestions({limit:100});s(a)}catch(a){console.error("Failed to fetch suggestions:",a),x.error("Failed to load suggestions")}finally{u(!1)}},X=l.useCallback(async a=>{O(!0);try{const o=await j.getSuggestionComments(a);R(o)}catch(o){console.error("Failed to fetch comments:",o),R([])}finally{O(!1)}},[]),fe=async a=>{b(!1),w(!0);try{const o=await j.generateSuggestions(a);if(o.success){const h=o.duration?` in ${(o.duration/1e3).toFixed(1)}s`:"";x.success(`Generated 3 suggestions for ${a.projectName}${h}`),await C()}else x.error("Generation failed. Try again.")}catch(o){const h=o instanceof Error?o.message:"Unknown error";h.includes("504")||h.includes("timed out")?x.error("Generation took too long. Try without Deep Mode."):x.error(`Failed to generate suggestions: ${h}`)}finally{w(!1)}},ve=async()=>{if(!(!n||!r.trim())){G(!0);try{await j.addSuggestionComment(n.id,r.trim()),y(""),await X(n.id),x.success("Comment added")}catch{x.error("Failed to add comment")}finally{G(!1)}}},Ne=async a=>{if(n)try{await j.deleteSuggestionComment(a),R(o=>o.filter(h=>h.id!==a)),x.success("Comment deleted")}catch{x.error("Failed to delete comment")}};l.useEffect(()=>{C()},[]);const be=Array.from(new Set(i.map(a=>a.project_name).filter(Boolean))).sort(),V=a=>{let o=a;return F!=="all"&&(o=o.filter(h=>h.project_name===F)),o.sort((h,Se)=>{const Q=new Date(h.created_at).getTime(),Y=new Date(Se.created_at).getTime();return T==="newest"?Y-Q:Q-Y})},we=V(i.filter(a=>a.status==="pending"||a.status==="approved")),ye=V(i.filter(a=>a.status==="implemented")),Ce=V(i.filter(a=>a.status==="rejected"));return{suggestions:i,isLoading:d,selectedSuggestion:n,detailOpen:m,setDetailOpen:c,activeTab:v,setActiveTab:S,generateModalOpen:N,setGenerateModalOpen:b,isGenerating:P,creatingPrd:k,sortOrder:T,setSortOrder:M,projectFilter:F,setProjectFilter:_,comments:q,commentsLoading:H,newComment:r,setNewComment:y,addingComment:D,uniqueProjects:be,activeSuggestions:we,implementedSuggestions:ye,archivedSuggestions:Ce,fetchSuggestions:C,handleGenerate:fe,handleAddComment:ve,handleDeleteComment:Ne,handleApprove:async a=>{try{await j.approveSuggestion(a),x.success("Suggestion confirmed!"),C(),c(!1)}catch{x.error("Failed to confirm suggestion")}},handleReject:async a=>{try{await j.rejectSuggestion(a),x.success("Suggestion archived"),C(),c(!1)}catch{x.error("Failed to archive suggestion")}},handleRestore:async a=>{try{await j.updateSuggestion(a,{status:"pending"}),x.success("Suggestion restored"),C()}catch{x.error("Failed to restore suggestion")}},handleImplement:async a=>{try{await j.implementSuggestion(a),x.success("Suggestion marked as implemented"),C(),c(!1)}catch{x.error("Failed to mark as implemented")}},handleCreatePrd:async a=>{f(!0);try{const o=await j.createPrdFromSuggestion(a);o.success&&(x.success("PRD created successfully!",{description:"Click to view the generated PRD",action:{label:"View PRD",onClick:()=>t(`/prd/${o.prdId}`)},duration:8e3}),C(),c(!1))}catch(o){const h=o instanceof Error?o.message:"Unknown error";h.includes("409")||h.includes("already exists")?x.error("A PRD already exists for this suggestion"):h.includes("504")||h.includes("timed out")?x.error("PRD generation timed out. Please try again."):x.error(`Failed to create PRD: ${h}`)}finally{f(!1)}},openDetail:a=>{g(a),R([]),y(""),c(!0),X(a.id)},navigate:t}}function We(){const[t,i]=l.useState("");return l.useEffect(()=>{const s=setInterval(()=>{i(d=>d.length>=3?"":d+".")},500);return()=>clearInterval(s)},[]),e.jsx("span",{className:"inline-block w-[1.2em] text-left",children:t})}function Xe({suggestion:t,showRestore:i=!1,creatingPrd:s,onOpen:d,onApprove:u,onReject:n,onRestore:g,onCreatePrd:m}){return e.jsxs("div",{onClick:()=>d(t),className:"flex items-start justify-between p-4 rounded-lg border bg-card hover:bg-muted/50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"space-y-1 flex-1 min-w-0 mr-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:t.title}),je(t)&&e.jsx(A,{className:"bg-primary text-primary-foreground text-[10px] px-1.5 py-0",children:"New"}),e.jsx(A,{variant:"outline",className:ue[t.type]||"",children:t.type}),e.jsx(A,{variant:"outline",className:he[t.status]||"",children:t.status})]}),t.project_name&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Project: ",t.project_name]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Priority: ",ge[t.priority]||t.priority]}),e.jsxs("span",{children:["Created: ",K(new Date(t.created_at),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex gap-2 shrink-0",children:[t.status==="pending"&&t.canImplement&&e.jsxs(e.Fragment,{children:[e.jsx(p,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 dark:hover:bg-green-950",onClick:c=>{c.stopPropagation(),u(t.id)},title:"Approve (auto-implement)",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(p,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:c=>{c.stopPropagation(),n(t.id)},title:"Decline",children:e.jsx(E,{className:"h-4 w-4"})})]}),t.status==="pending"&&!t.canImplement&&e.jsxs(e.Fragment,{children:[e.jsx(p,{size:"sm",variant:"outline",className:"text-green-600 hover:text-green-700 hover:bg-green-50 dark:hover:bg-green-950",onClick:c=>{c.stopPropagation(),u(t.id)},title:"Approve",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(p,{size:"sm",variant:"outline",className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-950",onClick:c=>{c.stopPropagation(),m(t.id)},title:"Create PRD",disabled:s,children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(p,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:c=>{c.stopPropagation(),n(t.id)},title:"Decline",children:e.jsx(E,{className:"h-4 w-4"})})]}),i&&e.jsx(p,{size:"sm",variant:"outline",className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-950",onClick:c=>{c.stopPropagation(),g(t.id)},title:"Restore",children:e.jsx(pe,{className:"h-4 w-4"})})]})]})}function Qe({projectFilter:t,sortOrder:i,uniqueProjects:s,onProjectFilterChange:d,onSortOrderChange:u}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ee,{value:t,onValueChange:d,children:[e.jsxs(te,{className:"w-[180px]",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),e.jsx(se,{placeholder:"All Projects"})]}),e.jsxs(ae,{children:[e.jsx(z,{value:"all",children:"All Projects"}),s.map(n=>e.jsx(z,{value:n,children:n},n))]})]}),e.jsxs(ee,{value:i,onValueChange:n=>u(n),children:[e.jsx(te,{className:"w-[130px]",children:e.jsx(se,{})}),e.jsxs(ae,{children:[e.jsx(z,{value:"newest",children:"Newest First"}),e.jsx(z,{value:"oldest",children:"Oldest First"})]})]})]})}function Ye({comments:t,commentsLoading:i,newComment:s,addingComment:d,onNewCommentChange:u,onAddComment:n,onDeleteComment:g}){return e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h4",{className:"font-medium text-sm mb-3 flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Comments ",!i&&`(${t.length})`]}),i?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-primary border-t-transparent"})}):t.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-3",children:"No comments yet"}):e.jsx("div",{className:"space-y-3 mb-4 max-h-64 overflow-y-auto overscroll-contain",children:t.map(m=>e.jsxs("div",{className:"group rounded-lg border bg-muted/30 p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:"text-sm whitespace-pre-wrap flex-1",children:m.comment_text}),e.jsx(p,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity text-muted-foreground hover:text-destructive shrink-0",onClick:()=>g(m.id),title:"Delete comment",children:e.jsx(Te,{className:"h-3.5 w-3.5"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:m.author}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Â· ",Oe(new Date(m.created_at),{addSuffix:!0})]})]})]},m.id))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(Fe,{placeholder:"Add implementation notes or requirements...",value:s,onChange:m=>u(m.target.value),className:"min-h-[60px] sm:min-h-[72px] resize-none text-sm flex-1",onKeyDown:m=>{m.key==="Enter"&&(m.metaKey||m.ctrlKey)&&(m.preventDefault(),n())}}),e.jsx(p,{size:"sm",variant:"outline",className:"shrink-0 sm:self-end self-stretch",disabled:!s.trim()||d,onClick:n,title:"Add comment (âŒ˜+Enter)",children:d?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"h-4 w-4 sm:mr-0 mr-2"}),e.jsx("span",{className:"sm:hidden",children:"Add Comment"})]})})]})]})}function Ze({open:t,onOpenChange:i,suggestion:s,creatingPrd:d,comments:u,commentsLoading:n,newComment:g,addingComment:m,onNewCommentChange:c,onAddComment:v,onDeleteComment:S,onApprove:N,onReject:b,onRestore:P,onImplement:w,onCreatePrd:k,onNavigateToPrd:f}){return e.jsx(oe,{open:t,onOpenChange:i,children:e.jsx(ce,{className:"max-w-2xl max-h-[85vh] overflow-hidden p-0 sm:p-0 gap-0 flex flex-col",children:s&&e.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 sm:p-6 overscroll-contain",style:{WebkitOverflowScrolling:"touch"},children:[e.jsxs(de,{className:"mb-4 pr-8",children:[e.jsxs(me,{className:"flex items-center gap-2 flex-wrap",children:[s.title,e.jsx(A,{variant:"outline",className:ue[s.type]||"",children:s.type})]}),e.jsx(xe,{children:s.project_name&&e.jsxs("span",{children:["Project: ",s.project_name]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[je(s)&&e.jsx(A,{className:"bg-primary text-primary-foreground text-[10px] px-1.5 py-0",children:"New"}),e.jsx(A,{variant:"outline",className:he[s.status]||"",children:s.status}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Priority: ",ge[s.priority]||s.priority]})]}),s.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap max-h-48 sm:max-h-none overflow-y-auto",children:s.description})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:["Created: ",K(new Date(s.created_at),"PPpp")]}),s.decided_at&&e.jsxs("p",{children:["Decided: ",K(new Date(s.decided_at),"PPpp")]})]}),s.prd_id&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800 p-3",children:[e.jsx(U,{className:"h-4 w-4 text-blue-600 dark:text-blue-400 shrink-0"}),e.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300 flex-1",children:"A PRD has been generated for this suggestion."}),e.jsxs(p,{variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-700 dark:text-blue-400",onClick:()=>{i(!1),f(s.prd_id)},children:[e.jsx(Ge,{className:"h-3.5 w-3.5 mr-1"}),"View PRD"]})]}),e.jsx(Ye,{comments:u,commentsLoading:n,newComment:g,addingComment:m,onNewCommentChange:c,onAddComment:v,onDeleteComment:S}),s.status==="pending"&&s.canImplement&&e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(p,{variant:"outline",className:"flex-1 text-green-600 hover:text-green-700 hover:bg-green-50 dark:hover:bg-green-950",onClick:()=>N(s.id),children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Approve"]}),e.jsxs(p,{variant:"outline",className:"flex-1 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:()=>b(s.id),children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Decline"]})]}),s.status==="pending"&&!s.canImplement&&e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(p,{variant:"default",className:"flex-1",onClick:()=>k(s.id),disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating PRDâ€¦"]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Create PRD"]})}),e.jsxs(p,{variant:"outline",className:"flex-1 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:()=>b(s.id),disabled:d,children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Decline"]})]}),s.status==="approved"&&e.jsx("div",{className:"flex gap-2 pt-4 border-t",children:e.jsxs(p,{variant:"default",className:"flex-1",onClick:()=>w(s.id),children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Mark as Implemented"]})}),s.status==="rejected"&&e.jsx("div",{className:"flex gap-2 pt-4 border-t",children:e.jsxs(p,{variant:"outline",className:"flex-1 text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-950",onClick:()=>{P(s.id),i(!1)},children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Restore"]})})]})]})})})}function B({title:t,suggestions:i,emptyMessage:s,emptyFilterMessage:d,showRestore:u=!1,creatingPrd:n,projectFilter:g,sortOrder:m,uniqueProjects:c,onProjectFilterChange:v,onSortOrderChange:S,onOpen:N,onApprove:b,onReject:P,onRestore:w,onCreatePrd:k}){return e.jsxs(Le,{children:[e.jsx(_e,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(ze,{className:"text-lg",children:t}),e.jsx(Qe,{projectFilter:g,sortOrder:m,uniqueProjects:c,onProjectFilterChange:v,onSortOrderChange:S})]})}),e.jsx(Ee,{children:i.length===0?e.jsx("p",{className:"text-muted-foreground text-sm text-center py-8",children:g!=="all"?d:s}):e.jsx("div",{className:"space-y-3",children:i.map(f=>e.jsx(Xe,{suggestion:f,showRestore:u,creatingPrd:n,onOpen:N,onApprove:b,onReject:P,onRestore:w,onCreatePrd:k},f.id))})})]})}const ne={"32b4b44b-a6f9-46c1-bc56-0ec819d766a1":"~/projects/personal-assistant","974c45ac-82f0-4e66-9403-94071d9da454":"~/projects/wellfy","wellfy-lms":"~/projects/wellfy","aba3c4c3-cdaa-466c-a7f3-210f70dbb852":"~/projects/backend-diabetesnotes","022d19f7-e15d-4c65-ba85-528033ab5d44":"~/projects/dot1","6fa57ff7-547a-48b7-bff9-cf27c333fc82":"~/projects/supplement-webshop"};function et({isOpen:t,onClose:i,onGenerate:s}){const[d,u]=l.useState("pa-projects"),[n,g]=l.useState(null),[m,c]=l.useState(!1),[v,S]=l.useState([]),[N,b]=l.useState([]),[P,w]=l.useState(!1),[k,f]=l.useState(!1),[T,M]=l.useState(null),F=l.useCallback(async()=>{w(!0);try{const y=(await j.getProjects()).filter(D=>D.status==="active"||D.status==="pipeline");S(y)}catch{x.error("Failed to load projects")}finally{w(!1)}},[]),_=l.useCallback(async()=>{f(!0),M(null);try{const r=await j.getGitHubRepos();b(r.repos||[]),r.message&&(!r.repos||r.repos.length===0)&&M(r.message)}catch{M("Failed to fetch GitHub repos")}finally{f(!1)}},[]);l.useEffect(()=>{t&&(F(),_(),g(null),c(!1))},[t,F,_]),l.useEffect(()=>{g(null)},[d]);function q(){var r;return d==="pa-projects"?((r=v.find(y=>y.id===n))==null?void 0:r.name)??"Unknown":n??"Unknown"}function R(){if(d==="pa-projects"&&n)return ne[n]}const H=()=>{n&&s({source:d==="pa-projects"?"pa-project":"github",projectId:n,projectName:q(),projectPath:R(),deepMode:m,count:3})},O=({id:r,name:y,description:D,extra:G})=>e.jsxs("label",{className:ke("flex items-start gap-3 rounded-lg border p-3 cursor-pointer transition-colors",n===r?"border-primary bg-primary/5 ring-1 ring-primary/30":"border-border hover:bg-muted/50"),children:[e.jsx("input",{type:"radio",name:"project-select",value:r,checked:n===r,onChange:()=>g(r),className:"mt-1 h-4 w-4 accent-primary"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-sm",children:y}),G&&e.jsx("span",{className:"text-xs text-muted-foreground",children:G})]}),D&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 line-clamp-2",children:D})]})]});return e.jsx(oe,{open:t,onOpenChange:r=>!r&&i(),children:e.jsxs(ce,{className:"max-w-lg",children:[e.jsxs(de,{children:[e.jsxs(me,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),"Generate New Suggestions"]}),e.jsx(xe,{children:"Select a project to analyze and generate 3 AI-powered improvement suggestions."})]}),e.jsxs(le,{value:d,onValueChange:u,children:[e.jsxs(ie,{className:"grid w-full grid-cols-2",children:[e.jsxs(I,{value:"pa-projects",className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"PA Projects"]}),e.jsxs(I,{value:"github",className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-4 w-4"}),"GitHub"]})]}),e.jsx(L,{value:"pa-projects",className:"mt-3",children:P?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx($,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):v.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[e.jsx(re,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No active projects found."]}):e.jsx("div",{className:"space-y-2 max-h-[280px] overflow-y-auto pr-1",children:v.map(r=>e.jsx(O,{id:r.id,name:r.name,description:r.description,extra:ne[r.id]?"ðŸ“":void 0},r.id))})}),e.jsx(L,{value:"github",className:"mt-3",children:k?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx($,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):T&&N.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[e.jsx(qe,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:T})]}):N.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground text-sm",children:[e.jsx(He,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),"No repos found."]}):e.jsx("div",{className:"space-y-2 max-h-[280px] overflow-y-auto pr-1",children:N.map(r=>e.jsx(O,{id:r.name,name:r.name,description:r.description||null,extra:new Date(r.updatedAt).toLocaleDateString()},r.name))})})]}),e.jsxs("label",{className:"flex items-center gap-2 mt-1 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:r=>c(r.target.checked),className:"h-4 w-4 rounded accent-primary"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Deep Mode",e.jsx("span",{className:"ml-1 text-xs opacity-75",children:"(slower, more detailed analysis)"})]})]}),e.jsxs(Re,{className:"gap-2 sm:gap-0",children:[e.jsx(p,{variant:"outline",onClick:i,children:"Cancel"}),e.jsxs(p,{onClick:H,disabled:!n,children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Generate (3)"]})]})]})})}function Ot(){const t=Ke();return e.jsx(e.Fragment,{children:t.isLoading?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight flex items-center gap-2",children:[e.jsx(Z,{className:"h-7 w-7"}),"Suggestions"]}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Review and manage James's improvement suggestions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:t.fetchSuggestions,children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsx(p,{size:"sm",onClick:()=>t.setGenerateModalOpen(!0),disabled:t.isGenerating,className:"min-w-[160px]",children:t.isGenerating?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing",e.jsx(We,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"New Suggestions"]})})]})]}),e.jsxs(le,{value:t.activeTab,onValueChange:t.setActiveTab,className:"w-full",children:[e.jsxs(ie,{className:"grid w-full max-w-lg grid-cols-3",children:[e.jsxs(I,{value:"active",className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Active (",t.activeSuggestions.length,")"]}),e.jsxs(I,{value:"implemented",className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Implemented (",t.implementedSuggestions.length,")"]}),e.jsxs(I,{value:"archived",className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Archived (",t.archivedSuggestions.length,")"]})]}),e.jsx(L,{value:"active",className:"mt-6",children:e.jsx(B,{title:"Active Suggestions",suggestions:t.activeSuggestions,emptyMessage:"No active suggestions. James will create suggestions based on project analysis.",emptyFilterMessage:`No active suggestions for ${t.projectFilter}. Try a different filter.`,creatingPrd:t.creatingPrd,projectFilter:t.projectFilter,sortOrder:t.sortOrder,uniqueProjects:t.uniqueProjects,onProjectFilterChange:t.setProjectFilter,onSortOrderChange:t.setSortOrder,onOpen:t.openDetail,onApprove:t.handleApprove,onReject:t.handleReject,onRestore:t.handleRestore,onCreatePrd:t.handleCreatePrd})}),e.jsx(L,{value:"implemented",className:"mt-6",children:e.jsx(B,{title:"Implemented Suggestions",suggestions:t.implementedSuggestions,emptyMessage:"No implemented suggestions yet. Completed improvements will appear here.",emptyFilterMessage:`No implemented suggestions for ${t.projectFilter}. Try a different filter.`,creatingPrd:t.creatingPrd,projectFilter:t.projectFilter,sortOrder:t.sortOrder,uniqueProjects:t.uniqueProjects,onProjectFilterChange:t.setProjectFilter,onSortOrderChange:t.setSortOrder,onOpen:t.openDetail,onApprove:t.handleApprove,onReject:t.handleReject,onRestore:t.handleRestore,onCreatePrd:t.handleCreatePrd})}),e.jsx(L,{value:"archived",className:"mt-6",children:e.jsx(B,{title:"Archived Suggestions",suggestions:t.archivedSuggestions,emptyMessage:"No archived suggestions. Declined suggestions will appear here.",emptyFilterMessage:`No archived suggestions for ${t.projectFilter}. Try a different filter.`,showRestore:!0,creatingPrd:t.creatingPrd,projectFilter:t.projectFilter,sortOrder:t.sortOrder,uniqueProjects:t.uniqueProjects,onProjectFilterChange:t.setProjectFilter,onSortOrderChange:t.setSortOrder,onOpen:t.openDetail,onApprove:t.handleApprove,onReject:t.handleReject,onRestore:t.handleRestore,onCreatePrd:t.handleCreatePrd})})]}),e.jsx(Ze,{open:t.detailOpen,onOpenChange:t.setDetailOpen,suggestion:t.selectedSuggestion,creatingPrd:t.creatingPrd,comments:t.comments,commentsLoading:t.commentsLoading,newComment:t.newComment,addingComment:t.addingComment,onNewCommentChange:t.setNewComment,onAddComment:t.handleAddComment,onDeleteComment:t.handleDeleteComment,onApprove:t.handleApprove,onReject:t.handleReject,onRestore:t.handleRestore,onImplement:t.handleImplement,onCreatePrd:t.handleCreatePrd,onNavigateToPrd:i=>t.navigate(`/prd/${i}`)}),e.jsx(et,{isOpen:t.generateModalOpen,onClose:()=>t.setGenerateModalOpen(!1),onGenerate:t.handleGenerate})]})})}export{Ot as SuggestionsPage};
