import{r as i,j as e}from"./vendor-react-nkeu7MKf.js";import{c as E,m as M,a4 as C,I as G,a as v,X as q,B as D,a5 as h,x as X,E as Y,F as Q,$ as Z,a0 as $,Y as ee,a1 as se,j as y}from"./index-Bq9JOXc-.js";import{S as J}from"./search-DSVa55tI.js";import{A as te,m as w}from"./vendor-framer-motion-Dlt2pHhV.js";import{A as ae}from"./arrow-left-_N9uZQu1.js";import{C as re}from"./calendar-BNREcHMx.js";import{C as ne}from"./chevron-right-AmDUNzkM.js";import{M as le,r as oe}from"./vendor-markdown-zaQAhtrl.js";import{n as ce,f as ie}from"./vendor-date-fns-D0ugVOfH.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-Oq5tdvA1.js";import"./vendor-floating-ui-_Y3uXdsy.js";import"./vendor-router-bCYKpmtI.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=E("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=E("GitFork",[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=E("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]),F=[.16,1,.3,1],xe={"":{icon:Q,label:"Root",description:"Top-level documents"},journal:{icon:re,label:"Journal",description:"Daily entries and reflections"},concepts:{icon:Y,label:"Concepts",description:"Deep dives into topics"},decisions:{icon:de,label:"Decisions",description:"Important decisions with context"},projects:{icon:X,label:"Projects",description:"Project documentation"},research:{icon:me,label:"Research",description:"Research notes and explorations"}};function ue(){const[l,x]=i.useState(!1);return i.useEffect(()=>{const a=()=>x(window.innerWidth<768);return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),l}function Fe(){const[l,x]=i.useState([]),[a,u]=i.useState(null),[s,m]=i.useState(""),[o,f]=i.useState(""),[d,c]=i.useState(null),[j,g]=i.useState(!0),[b,p]=i.useState(!1),[I,K]=i.useState(new Set(["journal","concepts","decisions","projects","research"])),[B,L]=i.useState(null),[R,T]=i.useState("list"),z=ue();i.useEffect(()=>{k()},[]),i.useEffect(()=>{if(!o.trim()){c(null);return}const t=setTimeout(async()=>{try{const r=await M.searchSecondBrain(o);c(r.results)}catch(r){console.error("Search failed:",r)}},300);return()=>clearTimeout(t)},[o]);const k=async()=>{try{g(!0),L(null);const t=await M.getSecondBrainDocuments();if(x(t.folders),!z){const r=t.folders.flatMap(n=>n.documents)[0];r&&await S(r,!1)}}catch(t){console.error("Failed to load documents:",t),L("Failed to load documents. Make sure the API server is running.")}finally{g(!1)}},S=async(t,r=!0)=>{try{p(!0);const n=await M.getSecondBrainDocument(t.path);u({...t,content:n.content}),m(n.content),r&&z&&T("document")}catch(n){console.error("Failed to load document:",n),m(`# Error

Failed to load document content.`)}finally{p(!1)}},W=()=>{T("list")},V=t=>{K(r=>{const n=new Set(r);return n.has(t)?n.delete(t):n.add(t),n})},O=()=>{f(""),c(null)},A=i.useMemo(()=>{if(d){const t={};for(const r of d){const n=r.folder||"";t[n]||(t[n]=[]),t[n].push(r)}return Object.entries(t).map(([r,n])=>({name:r,documents:n}))}return l},[l,d]),N=l.reduce((t,r)=>t+r.documents.length,0),P={enter:t=>({x:t>0?"100%":"-100%",opacity:0}),center:{x:0,opacity:1},exit:t=>({x:t>0?"-100%":"100%",opacity:0})};return e.jsxs("div",{className:"flex flex-col h-[calc(100vh-4rem)] -m-4 sm:-m-6 md:-m-8 overflow-hidden",children:[e.jsxs("div",{className:"hidden md:flex md:flex-col h-full",children:[e.jsx("div",{className:"flex items-center justify-between px-6 py-4 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(C,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"James's Brain"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[N," document",N!==1?"s":""," in your knowledge base"]})]})]})}),e.jsxs("div",{className:"flex flex-1 min-h-0",children:[e.jsxs("div",{className:"w-80 flex flex-col bg-muted/30 border-r",children:[e.jsxs("div",{className:"p-3 border-b",children:[e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(G,{placeholder:"Search documents...",value:o,onChange:t=>f(t.target.value),className:"pl-9 pr-9 h-9 bg-background"}),o&&e.jsx(v,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 min-h-[32px] min-w-[32px]",onClick:O,children:e.jsx(q,{className:"h-4 w-4"})})]}),d&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[d.length," result",d.length!==1?"s":"",' for "',o,'"']})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:e.jsx(_,{isLoading:j,error:B,displayedFolders:A,expandedFolders:I,selectedDoc:a,searchQuery:o,onToggleFolder:V,onSelectDoc:S,onRetry:k})})]}),e.jsx("div",{className:"flex-1 flex flex-col min-w-0 bg-background",children:e.jsx(H,{selectedDoc:a,docContent:s,isLoadingDoc:b})})]})]}),e.jsx("div",{className:"flex md:hidden flex-col h-full",children:e.jsx(te,{mode:"wait",custom:R==="document"?1:-1,children:R==="list"?e.jsxs(w.div,{custom:-1,variants:P,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3,ease:F},className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-4 border-b bg-background/95 backdrop-blur",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(C,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold tracking-tight",children:"James's Brain"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[N," document",N!==1?"s":""]})]})]}),e.jsxs("div",{className:"p-3 border-b bg-background",children:[e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(G,{placeholder:"Search documents...",value:o,onChange:t=>f(t.target.value),className:"pl-9 pr-9 h-10 bg-muted/50"}),o&&e.jsx(v,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 min-h-[44px] min-w-[44px]",onClick:O,children:e.jsx(q,{className:"h-4 w-4"})})]}),d&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[d.length," result",d.length!==1?"s":"",' for "',o,'"']})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 bg-muted/20",children:e.jsx(_,{isLoading:j,error:B,displayedFolders:A,expandedFolders:I,selectedDoc:a,searchQuery:o,onToggleFolder:V,onSelectDoc:S,onRetry:k})})]},"list"):e.jsxs(w.div,{custom:1,variants:P,initial:"enter",animate:"center",exit:"exit",transition:{duration:.3,ease:F},className:"flex flex-col h-full bg-background",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 py-3 border-b bg-background/95 backdrop-blur",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:W,className:"shrink-0 min-h-[44px] min-w-[44px]",children:e.jsx(ae,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-base font-semibold tracking-tight truncate",children:(a==null?void 0:a.title)||"Document"}),(a==null?void 0:a.folder)&&e.jsx(D,{variant:"outline",className:"text-xs capitalize mt-0.5",children:a.folder})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(H,{selectedDoc:a,docContent:s,isLoadingDoc:b,isMobile:!0})})]},"document")})})]})}function _({isLoading:l,error:x,displayedFolders:a,expandedFolders:u,selectedDoc:s,searchQuery:m,onToggleFolder:o,onSelectDoc:f,onRetry:d}){return l?e.jsx("div",{className:"space-y-3 p-2",children:[1,2,3,4].map(c=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-6 w-24"}),e.jsx(h,{className:"h-12 w-full"}),e.jsx(h,{className:"h-12 w-full"})]},c))}):x?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx(U,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:x}),e.jsx(v,{variant:"outline",size:"sm",className:"mt-3 min-h-[44px]",onClick:d,children:"Retry"})]}):a.length===0||a.every(c=>c.documents.length===0)?e.jsxs("div",{className:"p-4 text-center",children:[e.jsx(C,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m?"No documents match your search":"No documents yet"})]}):e.jsx("div",{className:"space-y-1",children:a.map(c=>{if(c.documents.length===0)return null;const j=xe[c.name]||{icon:Q,label:c.name||"Documents"},g=j.icon,b=u.has(c.name);return e.jsxs(Z,{open:b,onOpenChange:()=>o(c.name),children:[e.jsx($,{asChild:!0,children:e.jsxs("button",{className:"flex items-center gap-2 w-full px-3 py-2.5 min-h-[44px] rounded-md text-sm font-medium text-muted-foreground hover:bg-accent hover:text-accent-foreground transition-colors",children:[b?e.jsx(ee,{className:"h-4 w-4 shrink-0"}):e.jsx(ne,{className:"h-4 w-4 shrink-0"}),e.jsx(g,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"flex-1 text-left truncate",children:j.label}),e.jsx(D,{variant:"secondary",className:"text-xs font-normal",children:c.documents.length})]})}),e.jsx(se,{children:e.jsx(w.div,{className:"ml-6 mt-1 space-y-0.5",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,ease:F},children:c.documents.map(p=>e.jsx(he,{doc:p,isSelected:(s==null?void 0:s.path)===p.path,onClick:()=>f(p)},p.path))})})]},c.name)})})}function H({selectedDoc:l,docContent:x,isLoadingDoc:a,isMobile:u=!1}){return l?e.jsxs(e.Fragment,{children:[!u&&e.jsx("div",{className:"px-8 py-4 border-b",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-2xl font-semibold tracking-tight truncate",children:l.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-muted-foreground",children:[l.folder&&e.jsx(D,{variant:"outline",className:"capitalize",children:l.folder}),e.jsxs("span",{children:["Updated ",ce(new Date(l.lastModified),{addSuffix:!0})]})]})]})})}),e.jsx("div",{className:y("flex-1 overflow-y-auto",u&&"pb-safe"),children:a?e.jsxs("div",{className:y("space-y-4",u?"p-4":"p-8"),children:[e.jsx(h,{className:"h-8 w-3/4"}),e.jsx(h,{className:"h-4 w-full"}),e.jsx(h,{className:"h-4 w-full"}),e.jsx(h,{className:"h-4 w-2/3"}),e.jsx(h,{className:"h-32 w-full mt-6"})]}):e.jsx("article",{className:y("prose prose-neutral dark:prose-invert max-w-none",u?"p-4":"p-8"),children:e.jsx(le,{remarkPlugins:[oe],components:{h1:({children:s})=>e.jsx("h1",{className:"text-3xl font-bold tracking-tight mt-8 mb-4 first:mt-0 pb-2 border-b",children:s}),h2:({children:s})=>e.jsx("h2",{className:"text-2xl font-semibold tracking-tight mt-8 mb-3 pb-1 border-b border-border/50",children:s}),h3:({children:s})=>e.jsx("h3",{className:"text-xl font-semibold tracking-tight mt-6 mb-2",children:s}),h4:({children:s})=>e.jsx("h4",{className:"text-lg font-semibold mt-4 mb-2",children:s}),p:({children:s})=>e.jsx("p",{className:"leading-7 [&:not(:first-child)]:mt-4",children:s}),ul:({children:s})=>e.jsx("ul",{className:"my-4 ml-6 list-disc [&>li]:mt-2",children:s}),ol:({children:s})=>e.jsx("ol",{className:"my-4 ml-6 list-decimal [&>li]:mt-2",children:s}),li:({children:s})=>e.jsx("li",{className:"leading-7",children:s}),blockquote:({children:s})=>e.jsx("blockquote",{className:"mt-4 border-l-4 border-primary/30 pl-4 italic text-muted-foreground",children:s}),code:({className:s,children:m,...o})=>/language-(\w+)/.exec(s||"")?e.jsx("code",{className:s,...o,children:m}):e.jsx("code",{className:"relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono text-sm",...o,children:m}),pre:({children:s})=>e.jsx("pre",{className:"mt-4 mb-4 overflow-x-auto rounded-lg bg-muted/50 border p-4 font-mono text-sm",children:s}),a:({href:s,children:m})=>e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline underline-offset-4 hover:text-primary/80 transition-colors",children:m}),hr:()=>e.jsx("hr",{className:"my-8 border-border"}),table:({children:s})=>e.jsx("div",{className:"my-6 w-full overflow-auto",children:e.jsx("table",{className:"w-full border-collapse border border-border",children:s})}),th:({children:s})=>e.jsx("th",{className:"border border-border bg-muted/50 px-4 py-2 text-left font-semibold",children:s}),td:({children:s})=>e.jsx("td",{className:"border border-border px-4 py-2",children:s}),img:({src:s,alt:m})=>e.jsx("img",{src:s,alt:m||"",className:"rounded-lg border my-4 max-w-full"})},children:x})})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{className:"h-16 w-16 mx-auto text-muted-foreground/30 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-muted-foreground",children:"Select a document to view"}),e.jsx("p",{className:"text-sm text-muted-foreground/70 mt-1",children:"Choose from the list on the left"})]})})}function he({doc:l,isSelected:x,onClick:a}){return e.jsxs(w.button,{onClick:a,className:y("flex flex-col w-full px-3 py-2.5 min-h-[44px] rounded-md text-left transition-colors",x?"bg-primary/10 text-primary":"hover:bg-accent active:bg-accent/80"),whileTap:{scale:.98},transition:{duration:.1},children:[e.jsx("span",{className:"text-sm font-medium truncate",children:l.title}),e.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:ie(new Date(l.lastModified),"MMM d, yyyy")})]})}export{Fe as SecondBrainPage};
