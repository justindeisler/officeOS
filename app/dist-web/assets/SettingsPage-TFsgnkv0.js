const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DV0Z4ueH.js","assets/core-BDPGcIsz.js","assets/index-CDjnCujr.js","assets/path-E9zjYLSN.js","assets/index-B9wpeZVf.js","assets/vendor-react-DeR5d9Tv.js","assets/vendor-router-9bGSKQ4q.js","assets/index-DEy-KA7P.css","assets/db.web-BP-vL6GE.js"])))=>i.map(i=>d[i]);
var Se=Object.defineProperty;var De=(s,a,t)=>a in s?Se(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var ie=(s,a,t)=>De(s,typeof a!="symbol"?a+"":a,t);import{r as x,j as e}from"./vendor-react-DeR5d9Tv.js";import{c as M,n as me,_ as W,O as q,P as Re,Q as pe,l as d,L as h,I as v,a as f,G as Be,F as Ie,B as Te,C as Pe,f as X,m as H,s as G}from"./index-B9wpeZVf.js";import{getDb as Q,getSchemaVersion as Fe}from"./db.web-BP-vL6GE.js";import{C as D,a as R,b as B,d as F,c as I}from"./card-Do3Kg1xk.js";import{U as xe}from"./user-MfgVYJL9.js";import{F as Oe}from"./folder-open-D4BFGrBf.js";import{S as se,a as te,b as ae,c as re,d as P}from"./select-BY8eQiQN.js";import{S as ce}from"./shield-4mfi7HFb.js";import{R as $}from"./refresh-cw-BMXkLT5Q.js";import{D as he}from"./download-DMg57E9E.js";import{A as Ae,a as Le,b as Me,c as _e,d as Ue,e as He,f as Ge,g as ze,h as Je}from"./alert-dialog-83Lj5Hrs.js";import{D as $e}from"./database-CKBCntCl.js";import{U as Ve}from"./upload-Ddt_p2-Y.js";import{T as We}from"./trash-2-BAQCKdVR.js";import{G as Z}from"./github--rKduYt4.js";import{C as qe}from"./check-BOz78U_D.js";import{C as Ye}from"./circle-alert-DR10Pc3C.js";import{G as Ke,a as Xe,C as Qe}from"./git-pull-request-DJ2Nv1Uk.js";import"./vendor-markdown-PIr_2kdo.js";import"./vendor-recharts-DrMJw15s.js";import"./vendor-radix-sPo3_CXI.js";import"./vendor-floating-ui-CESiY8Ey.js";import"./vendor-router-9bGSKQ4q.js";import"./chevron-up-Csf9Xqjr.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=M("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=M("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=M("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=M("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=M("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=M("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]),oe=me("backupService");function V(){return typeof window<"u"&&"__TAURI__"in window&&!!window.__TAURI__}let z=null,J=null;async function de(){if(!V())throw new Error("Tauri modules not available in web environment");if(!z||!J){const[s,a]=await Promise.all([W(()=>import("./index-DV0Z4ueH.js"),__vite__mapDeps([0,1])),W(()=>import("./index-CDjnCujr.js"),__vite__mapDeps([2,3,1]))]);z=s,J=a}return{save:z.save,open:z.open,writeTextFile:J.writeTextFile,readTextFile:J.readTextFile}}function rs(s,a){const t=new Blob([s],{type:"application/json"}),i=URL.createObjectURL(t),c=document.createElement("a");c.href=i,c.download=a,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i)}function ns(){return new Promise(s=>{const a=document.createElement("input");a.type="file",a.accept=".json",a.onchange=async t=>{var p;const i=(p=t.target.files)==null?void 0:p[0];if(!i){s(null);return}const c=await i.text();s(c)},a.oncancel=()=>s(null),a.click()})}function ue(s){let a=0;for(let t=0;t<s.length;t++){const i=s.charCodeAt(t);a=(a<<5)-a+i,a=a&a}return`hash:${Math.abs(a).toString(16)}`}class is{constructor(){ie(this,"APP_VERSION","1.0.0")}async exportBackup(){try{const a=await Q(),t=await Fe(),[i,c,p,r,l,u,k]=await Promise.all([a.select("SELECT * FROM clients"),a.select("SELECT * FROM projects"),a.select("SELECT * FROM tasks"),a.select("SELECT * FROM time_entries"),a.select("SELECT * FROM invoices"),a.select("SELECT * FROM captures"),a.select("SELECT * FROM settings")]),y={version:this.APP_VERSION,exportedAt:new Date().toISOString(),schemaVersion:t,data:{clients:i,projects:c,tasks:p,time_entries:r,invoices:l,captures:u,settings:k}},b=JSON.stringify(y.data),N=ue(b),j={...y,checksum:N},C=`personal-assistant-backup-${new Date().toISOString().split("T")[0]}.json`,E=JSON.stringify(j,null,2);if(V()){const{save:_,writeTextFile:A}=await de(),T=await _({defaultPath:C,filters:[{name:"JSON",extensions:["json"]}]});return T?(await A(T,E),{success:!0,filePath:T}):{success:!1,error:"Export cancelled"}}else return rs(E,C),{success:!0,filePath:C}}catch(a){return oe.error({err:a},"Backup export failed"),{success:!1,error:a instanceof Error?a.message:"Export failed"}}}async importBackup(){try{let a;if(V()){const{open:u,readTextFile:k}=await de(),y=await u({filters:[{name:"JSON",extensions:["json"]}],multiple:!1});if(!y||Array.isArray(y))return{success:!1,error:"Import cancelled"};a=await k(y)}else a=await ns();if(!a)return{success:!1,error:"Import cancelled"};const t=JSON.parse(a),i=this.validateBackup(t);if(i)return{success:!1,error:i};const c=JSON.stringify(t.data);if(ue(c)!==t.checksum)return{success:!1,error:"Backup file is corrupted (checksum mismatch)"};const r=await Q();await r.execute("DELETE FROM captures"),await r.execute("DELETE FROM time_entries"),await r.execute("DELETE FROM invoices"),await r.execute("DELETE FROM tasks"),await r.execute("DELETE FROM projects"),await r.execute("DELETE FROM clients"),await r.execute("DELETE FROM settings");let l=0;for(const u of t.data.clients)await this.insertRecord(r,"clients",u),l++;for(const u of t.data.projects)await this.insertRecord(r,"projects",u),l++;for(const u of t.data.tasks)await this.insertRecord(r,"tasks",u),l++;for(const u of t.data.time_entries)await this.insertRecord(r,"time_entries",u),l++;for(const u of t.data.invoices)await this.insertRecord(r,"invoices",u),l++;for(const u of t.data.captures)await this.insertRecord(r,"captures",u),l++;for(const u of t.data.settings)await this.insertRecord(r,"settings",u),l++;return{success:!0,stats:{tables:7,records:l}}}catch(a){return oe.error({err:a},"Backup import failed"),{success:!1,error:a instanceof Error?a.message:"Import failed"}}}validateBackup(a){if(!a||typeof a!="object")return"Invalid backup file format";const t=a;if(!t.version||typeof t.version!="string")return"Missing or invalid version";if(!t.exportedAt||typeof t.exportedAt!="string")return"Missing or invalid export date";if(typeof t.schemaVersion!="number")return"Missing or invalid schema version";if(!t.data||typeof t.data!="object")return"Missing or invalid data";if(!t.checksum||typeof t.checksum!="string")return"Missing or invalid checksum";const i=t.data,c=["clients","projects","tasks","time_entries","invoices","captures","settings"];for(const p of c)if(!Array.isArray(i[p]))return`Missing or invalid table: ${p}`;return null}async insertRecord(a,t,i){const c=Object.keys(i),p=c.map(()=>"?").join(", "),r=Object.values(i);await a.execute(`INSERT INTO ${t} (${c.join(", ")}) VALUES (${p})`,r)}async getBackupStats(){var a,t,i,c,p,r;if(V()){const l=await Q(),[u,k,y,b,N,j]=await Promise.all([l.select("SELECT COUNT(*) as count FROM clients"),l.select("SELECT COUNT(*) as count FROM projects"),l.select("SELECT COUNT(*) as count FROM tasks"),l.select("SELECT COUNT(*) as count FROM time_entries"),l.select("SELECT COUNT(*) as count FROM invoices"),l.select("SELECT COUNT(*) as count FROM captures")]);return{clients:((a=u[0])==null?void 0:a.count)||0,projects:((t=k[0])==null?void 0:t.count)||0,tasks:((i=y[0])==null?void 0:i.count)||0,timeEntries:((c=b[0])==null?void 0:c.count)||0,invoices:((p=N[0])==null?void 0:p.count)||0,captures:((r=j[0])==null?void 0:r.count)||0}}else{const{api:l}=await W(async()=>{const{api:C}=await import("./index-B9wpeZVf.js").then(E=>E.ak);return{api:C}},__vite__mapDeps([4,5,6,7])),[u,k,y,b,N,j]=await Promise.all([l.getClients(),l.getProjects(),l.getTasks(),l.getTimeEntries(),l.getInvoices(),l.getCaptures()]);return{clients:u.length,projects:k.length,tasks:y.length,timeEntries:b.length,invoices:N.length,captures:j.length}}}}const ee=new is;async function je(){return q.get("/backups/status")}async function cs(){return q.post("/backups/trigger")}async function ls(){var i;const s=await q.requestBlob("/backups/download"),a=URL.createObjectURL(s),t=document.createElement("a");try{const c=await je();t.download=((i=c.lastBackup)==null?void 0:i.filename)||"pa-backup.enc"}catch{t.download="pa-backup.enc"}t.href=a,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)}async function os(){const s=await q.requestBlob("/backups/export?format=json"),a=URL.createObjectURL(s),t=document.createElement("a"),i=new Date().toISOString().split("T")[0];t.download=`pa-export-${i}.json`,t.href=a,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)}const S=me("useSettings"),ds={fullName:"",jobTitle:"",email:"",phone:"",street:"",postalCode:"",city:"",country:"Deutschland",vatId:"",taxId:"",bankAccountHolder:"",bankName:"",bankIban:"",bankBic:""};function us(){const s=Re(),[a,t]=x.useState(s.workspacePath||""),[i,c]=x.useState(s.userName||""),[p,r]=x.useState(!1),[l,u]=x.useState(!1),[k,y]=x.useState(s.businessProfile||ds),[b,N]=x.useState(!1),[j,C]=x.useState(null),[E,_]=x.useState(null),[A,T]=x.useState(!1),[Y,L]=x.useState(!1),[U,O]=x.useState(!1);x.useEffect(()=>{s.businessProfile&&y(s.businessProfile)},[s.businessProfile]),x.useEffect(()=>{async function o(){try{const m=await ee.getBackupStats();C(m)}catch(m){S.error({err:m},"Failed to load data stats")}}o()},[]);const n=x.useCallback(async()=>{if(pe())try{const o=await je();_(o)}catch(o){S.error({err:o},"Failed to load backup status")}},[]);x.useEffect(()=>{n()},[n]);const g=async()=>{var o;T(!0);try{const m=await cs();m.success?(d.success(`Backup created: ${(o=m.backup)==null?void 0:o.filename}`),await n()):d.error(m.error||"Backup failed")}catch(m){S.error({err:m},"Backup trigger failed"),d.error("Failed to create backup")}finally{T(!1)}},K=async()=>{L(!0);try{await ls(),d.success("Backup download started")}catch(o){S.error({err:o},"Backup download failed"),d.error("Failed to download backup")}finally{L(!1)}},fe=async()=>{O(!0);try{await os(),d.success("JSON export download started")}catch(o){S.error({err:o},"JSON export failed"),d.error("Failed to export data")}finally{O(!1)}},ge=async()=>{a.trim()?(await s.setWorkspacePath(a.trim()),d.success("Workspace path saved")):(await s.setWorkspacePath(void 0),d.success("Workspace path cleared"))},ye=async()=>{i.trim()&&(await s.setUserName(i.trim()),d.success("Name saved"))},ve=async()=>{N(!0);try{await s.setBusinessProfile(k),d.success("Business profile saved")}catch(o){S.error({err:o},"Failed to save business profile"),d.error("Failed to save business profile")}finally{N(!1)}},ne=(o,m)=>{y(w=>({...w,[o]:m}))},ke=o=>o.replace(/\s/g,"").toUpperCase().replace(/(.{4})/g,"$1 ").trim(),Ne=o=>{const m=o.replace(/\s/g,"").toUpperCase();ne("bankIban",m)},be=async()=>{r(!0);try{const o=await ee.exportBackup();o.success?d.success("Backup exported successfully"):o.error!=="Export cancelled"&&d.error(o.error||"Export failed")}catch(o){S.error({err:o},"Export failed"),d.error("Failed to export backup")}finally{r(!1)}},we=async()=>{var o,m;u(!0);try{const w=await ee.importBackup();w.success?(d.success(`Backup restored: ${(o=w.stats)==null?void 0:o.records} records across ${(m=w.stats)==null?void 0:m.tables} tables`),window.location.reload()):w.error!=="Import cancelled"&&d.error(w.error||"Import failed")}catch(w){S.error({err:w},"Import failed"),d.error("Failed to import backup")}finally{u(!1)}},Ce=async()=>{try{const{getDb:o}=await W(async()=>{const{getDb:w}=await import("./db.web-BP-vL6GE.js");return{getDb:w}},__vite__mapDeps([8,4,5,6,7])),m=await o();await m.execute("DELETE FROM captures"),await m.execute("DELETE FROM time_entries"),await m.execute("DELETE FROM invoices"),await m.execute("DELETE FROM tasks"),await m.execute("DELETE FROM projects"),await m.execute("DELETE FROM clients"),await m.execute("DELETE FROM settings"),d.success("All data cleared"),window.location.reload()}catch(o){S.error({err:o},"Clear data failed"),d.error("Failed to clear data")}},Ee=j?j.clients+j.projects+j.tasks+j.timeEntries+j.invoices+j.captures:0;return{...s,pathInput:a,setPathInput:t,nameInput:i,setNameInput:c,profileForm:k,isSavingProfile:b,dataStats:j,totalRecords:Ee,isExporting:p,isImporting:l,backupStatus:E,isBackingUp:A,isDownloadingBackup:Y,isExportingJson:U,handleSaveWorkspacePath:ge,handleSaveUserName:ye,handleSaveBusinessProfile:ve,updateProfileField:ne,formatIban:ke,handleIbanChange:Ne,handleTriggerBackup:g,handleDownloadBackup:K,handleExportJson:fe,handleExportData:be,handleImportData:we,handleClearAllData:Ce}}function ms({nameInput:s,setNameInput:a,onSave:t}){return e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5"}),"Profile"]}),e.jsx(F,{children:"Your personal information displayed in the sidebar."})]}),e.jsx(I,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"user-name",children:"Display Name"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{id:"user-name",value:s,onChange:i=>a(i.target.value),placeholder:"Your name",className:"flex-1"}),e.jsx(f,{onClick:t,children:"Save"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This name appears next to your profile icon in the sidebar."})]})})]})}function ps({profileForm:s,isSavingProfile:a,onUpdateField:t,onIbanChange:i,formatIban:c,onSave:p}){return e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-5 w-5"}),"Business Profile"]}),e.jsx(F,{children:"Your business information for invoices and official documents."})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Personal Information"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-fullName",children:"Full Name"}),e.jsx(v,{id:"bp-fullName",value:s.fullName,onChange:r=>t("fullName",r.target.value),placeholder:"Max Mustermann"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-jobTitle",children:"Job Title"}),e.jsx(v,{id:"bp-jobTitle",value:s.jobTitle,onChange:r=>t("jobTitle",r.target.value),placeholder:"Full-Stack Developer"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-email",children:"Business Email"}),e.jsx(v,{id:"bp-email",type:"email",value:s.email,onChange:r=>t("email",r.target.value),placeholder:"kontakt@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-phone",children:"Phone (optional)"}),e.jsx(v,{id:"bp-phone",type:"tel",value:s.phone||"",onChange:r=>t("phone",r.target.value),placeholder:"+49 123 456789"})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Address"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-street",children:"Street Address"}),e.jsx(v,{id:"bp-street",value:s.street,onChange:r=>t("street",r.target.value),placeholder:"MusterstraÃŸe 123"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-postalCode",children:"Postal Code"}),e.jsx(v,{id:"bp-postalCode",value:s.postalCode,onChange:r=>t("postalCode",r.target.value),placeholder:"12345"})]}),e.jsxs("div",{className:"space-y-2 col-span-1 sm:col-span-2",children:[e.jsx(h,{htmlFor:"bp-city",children:"City"}),e.jsx(v,{id:"bp-city",value:s.city,onChange:r=>t("city",r.target.value),placeholder:"Berlin"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-country",children:"Country"}),e.jsx(v,{id:"bp-country",value:s.country,onChange:r=>t("country",r.target.value),placeholder:"Deutschland"})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),"Tax Information"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-vatId",children:"USt-IdNr (VAT ID)"}),e.jsx(v,{id:"bp-vatId",value:s.vatId||"",onChange:r=>t("vatId",r.target.value.toUpperCase()),placeholder:"DE123456789"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Required for EU B2B invoices"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-taxId",children:"Steuernummer (Tax Number)"}),e.jsx(v,{id:"bp-taxId",value:s.taxId||"",onChange:r=>t("taxId",r.target.value),placeholder:"123/456/78901"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your local tax office number"})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),"Bank Details"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-bankAccountHolder",children:"Account Holder"}),e.jsx(v,{id:"bp-bankAccountHolder",value:s.bankAccountHolder,onChange:r=>t("bankAccountHolder",r.target.value),placeholder:"Max Mustermann"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-bankName",children:"Bank Name"}),e.jsx(v,{id:"bp-bankName",value:s.bankName,onChange:r=>t("bankName",r.target.value),placeholder:"Sparkasse Berlin"})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[e.jsx(h,{htmlFor:"bp-bankIban",children:"IBAN"}),e.jsx(v,{id:"bp-bankIban",value:c(s.bankIban),onChange:r=>i(r.target.value),placeholder:"DE89 3704 0044 0532 0130 00",className:"font-mono"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"bp-bankBic",children:"BIC/SWIFT"}),e.jsx(v,{id:"bp-bankBic",value:s.bankBic,onChange:r=>t("bankBic",r.target.value.toUpperCase()),placeholder:"COBADEFFXXX",className:"font-mono"})]})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx(f,{onClick:p,disabled:a,children:a?"Saving...":"Save Business Profile"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"This information will be used in your invoice PDFs."})]})]})]})}function xs({theme:s,onSetTheme:a}){return e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsx(B,{children:"Appearance"}),e.jsx(F,{children:"Customize the look and feel."})]}),e.jsx(I,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Theme"}),e.jsx("div",{className:"flex gap-2",children:["light","dark","system"].map(t=>e.jsx(f,{variant:s===t?"default":"outline",size:"sm",onClick:()=>a(t),className:"capitalize",children:t},t))})]})})]})}function hs({pathInput:s,setPathInput:a,workspacePath:t,onSave:i}){return e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),"Workspace"]}),e.jsx(F,{children:"Configure your Obsidian workspace location for markdown integration."})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"workspace-path",children:"Workspace Path"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{id:"workspace-path",value:s,onChange:c=>a(c.target.value),placeholder:"/Users/you/Documents/Obsidian/Vault",className:"flex-1"}),e.jsx(f,{onClick:i,children:"Save"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Path to your Obsidian vault or markdown workspace. Used for exporting and linking files."})]}),t&&e.jsxs("div",{className:"rounded-lg bg-muted p-3 text-sm",children:[e.jsx("p",{className:"font-medium",children:"Current workspace:"}),e.jsx("code",{className:"text-xs text-muted-foreground",children:t})]})]})]})}function js({defaultArea:s,defaultCurrency:a,onSetDefaultArea:t,onSetDefaultCurrency:i}){return e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsx(B,{children:"Defaults"}),e.jsx(F,{children:"Set default values for new items."})]}),e.jsx(I,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Default Area"}),e.jsxs(se,{value:s,onValueChange:c=>t(c),children:[e.jsx(te,{children:e.jsx(ae,{})}),e.jsxs(re,{children:[e.jsx(P,{value:"wellfy",children:"Wellfy"}),e.jsx(P,{value:"freelance",children:"Freelance"}),e.jsx(P,{value:"personal",children:"Personal"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Default Currency"}),e.jsxs(se,{value:a,onValueChange:i,children:[e.jsx(te,{children:e.jsx(ae,{})}),e.jsxs(re,{children:[e.jsx(P,{value:"EUR",children:"EUR"}),e.jsx(P,{value:"USD",children:"USD"}),e.jsx(P,{value:"GBP",children:"GBP"}),e.jsx(P,{value:"CHF",children:"CHF"})]})]})]})]})})]})}function fs({backupStatus:s,isBackingUp:a,isDownloadingBackup:t,isExportingJson:i,onTriggerBackup:c,onDownloadBackup:p,onExportJson:r}){return e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"Backup & Export"]}),e.jsx(F,{children:"Automated encrypted backups and data export. Backups are encrypted with AES-256-GCM."})]}),e.jsxs(I,{className:"space-y-4",children:[s&&e.jsxs("div",{className:"rounded-lg bg-muted p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ss,{className:"h-4 w-4"}),"Backup Status"]}),e.jsx(Te,{variant:s.encryptionKeyAvailable?"default":"destructive",children:s.encryptionKeyAvailable?"ðŸ”’ Encryption Active":"âš ï¸ No Key"})]}),s.lastBackup?e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Pe,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:["Last backup:"," ",e.jsx("span",{className:"text-foreground font-medium",children:new Date(s.lastBackup.date).toLocaleString("de-DE",{dateStyle:"medium",timeStyle:"short"})})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground pl-5",children:[s.lastBackup.filename," (",(s.lastBackup.sizeBytes/1024).toFixed(1)," KB)"]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No backups yet. Create your first backup below."}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ðŸ“¦ ",s.totalBackups," backup(s) stored in ",e.jsx("code",{className:"text-xs",children:s.backupDir})]})]}),s&&s.recentBackups.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Recent Backups"}),e.jsx("div",{className:"rounded-lg border divide-y",children:s.recentBackups.map(l=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(ce,{className:"h-3.5 w-3.5 text-green-500 shrink-0"}),e.jsx("span",{className:"truncate font-mono text-xs",children:l.filename})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground shrink-0",children:[e.jsxs("span",{children:[(l.sizeBytes/1024).toFixed(1)," KB"]}),e.jsx("span",{children:new Date(l.date).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})})]})]},l.filename))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[e.jsxs(f,{variant:"default",onClick:c,disabled:a,children:[e.jsx($,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),a?"Backing up...":"Create Backup"]}),e.jsxs(f,{variant:"outline",onClick:p,disabled:t||!(s!=null&&s.lastBackup),children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),t?"Downloading...":"Download Backup"]}),e.jsxs(f,{variant:"outline",onClick:r,disabled:i,children:[e.jsx(es,{className:"h-4 w-4 mr-2"}),i?"Exporting...":"Export JSON"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("strong",{children:"Create Backup:"})," Encrypted backup saved on server (auto-rotated, 30 days).",e.jsx("br",{}),e.jsx("strong",{children:"Download Backup:"})," Download the latest encrypted backup file.",e.jsx("br",{}),e.jsx("strong",{children:"Export JSON:"})," Download all data as unencrypted JSON (for portability)."]})]})]})}function gs({dataStats:s,totalRecords:a,isExporting:t,isImporting:i,onExport:c,onImport:p,onClearAll:r}){return e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Data Management"]}),e.jsx(F,{children:"Your data is stored locally in SQLite. Export backups to keep your data safe."})]}),e.jsxs(I,{className:"space-y-4",children:[s&&e.jsxs("div",{className:"rounded-lg bg-muted p-3 text-sm",children:[e.jsxs("p",{className:"font-medium mb-2",children:["Current Data (",a," total)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s.clients," clients"]}),e.jsxs("span",{children:[s.projects," projects"]}),e.jsxs("span",{children:[s.tasks," tasks"]}),e.jsxs("span",{children:[s.timeEntries," time entries"]}),e.jsxs("span",{children:[s.invoices," invoices"]}),e.jsxs("span",{children:[s.captures," captures"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(f,{variant:"outline",onClick:c,disabled:t,children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),t?"Exporting...":"Export Backup"]}),e.jsxs(f,{variant:"outline",onClick:p,disabled:i,children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),i?"Importing...":"Import Backup"]}),e.jsxs(Ae,{children:[e.jsx(Le,{asChild:!0,children:e.jsxs(f,{variant:"destructive",children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Clear All Data"]})}),e.jsxs(Me,{children:[e.jsxs(_e,{children:[e.jsx(Ue,{children:"Are you absolutely sure?"}),e.jsx(He,{children:"This action cannot be undone. This will permanently delete all your tasks, time entries, clients, projects, invoices, and captures from the database."})]}),e.jsxs(Ge,{children:[e.jsx(ze,{children:"Cancel"}),e.jsx(Je,{onClick:r,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Yes, delete everything"})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Export creates a JSON backup of all your data. Import restores from a previous backup.",e.jsx("strong",{className:"block mt-1",children:"Tip: Export backups regularly to protect your data."})]})]})]})}function ys(){const[s,a]=x.useState([]),[t,i]=x.useState(!1),[c,p]=x.useState(null),[r,l]=x.useState(!1),[u,k]=x.useState(null),[y,b]=x.useState(null),[N,j]=x.useState(""),{projects:C}=X(),E=x.useCallback(async()=>{i(!0);try{const n=await H.getGitHubRepos();a(n.repos||[]),p(n.authenticated!==!1)}catch{d.error("Failed to fetch GitHub repos"),p(!1)}finally{i(!1)}},[]);x.useEffect(()=>{E()},[E]);const _=async()=>{l(!0),k(null);try{const n=await H.syncAllGitHubRepos(7);k(n.results),d.success(`Synced ${n.totalRepos} repos, imported ${n.totalImported} items`)}catch{d.error("Failed to sync GitHub repos")}finally{l(!1)}},A=async n=>{l(!0);try{const g=await H.syncGitHubRepo(n,30);k([g.result]);const K=g.result.commitsImported+g.result.prsImported+g.result.issuesImported;d.success(`Imported ${K} items from ${n}`)}catch{d.error(`Failed to sync ${n}`)}finally{l(!1)}},T=async(n,g)=>{try{await H.linkGitHubRepo(n,g),d.success(`Linked ${g} to project`),b(null),j(""),X.getState().initialize()}catch{d.error("Failed to link repo")}},Y=async n=>{try{await H.unlinkGitHubRepo(n),d.success("Unlinked GitHub repo from project"),X.getState().initialize()}catch{d.error("Failed to unlink repo")}},L=n=>{const g=n;return g.githubRepo||g.github_repo},U=C.filter(n=>L(n)),O=C.filter(n=>!L(n));return e.jsxs(D,{children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),"GitHub Integration"]}),e.jsx(F,{children:"Connect GitHub repositories to projects for automatic activity tracking. Commits, PRs, and issues are imported and time estimates are auto-calculated."})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:c===null?e.jsx(G,{className:"h-4 w-4 animate-spin text-muted-foreground"}):c?e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400",children:["Connected as ",e.jsx("strong",{children:"justindeisler"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"GitHub CLI not authenticated"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:E,disabled:t,children:[t?e.jsx(G,{className:"h-4 w-4 animate-spin mr-1"}):e.jsx($,{className:"h-4 w-4 mr-1"}),"Refresh"]}),e.jsxs(f,{size:"sm",onClick:_,disabled:r||U.length===0,children:[r?e.jsx(G,{className:"h-4 w-4 animate-spin mr-1"}):e.jsx($,{className:"h-4 w-4 mr-1"}),"Sync All"]})]})]}),U.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Linked Repositories"}),e.jsx("div",{className:"space-y-2",children:U.map(n=>{const g=L(n)||"";return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:n.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>A(g),disabled:r,children:r?e.jsx(G,{className:"h-3 w-3 animate-spin"}):e.jsx($,{className:"h-3 w-3"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>Y(n.id),children:e.jsx(as,{className:"h-3 w-3"})})]})]},n.id)})})]}),O.length>0&&s.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Link Repository to Project"}),y?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(se,{value:N,onValueChange:j,children:[e.jsx(te,{className:"flex-1",children:e.jsx(ae,{placeholder:"Select a repository..."})}),e.jsx(re,{children:s.map(n=>e.jsxs(P,{value:n.fullName,children:[n.name,n.description&&e.jsxs("span",{className:"text-muted-foreground ml-2",children:["â€” ",n.description.substring(0,50)]})]},n.fullName))})]}),e.jsxs(f,{size:"sm",onClick:()=>T(y,N),disabled:!N,children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Link"]}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>{b(null),j("")},children:"Cancel"})]}):e.jsxs("div",{className:"flex flex-wrap gap-2",children:[O.slice(0,8).map(n=>e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>b(n.id),children:[e.jsx(le,{className:"h-3 w-3 mr-1"}),n.name]},n.id)),O.length>8&&e.jsxs("span",{className:"text-xs text-muted-foreground self-center",children:["+",O.length-8," more"]})]})]}),s.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-medium",children:["Available Repositories (",s.length,")"]}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:s.map(n=>e.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-muted/50 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{children:n.name}),n.description&&e.jsxs("span",{className:"text-muted-foreground text-xs hidden sm:inline",children:["â€” ",n.description.substring(0,40)]})]}),e.jsx(f,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:()=>A(n.fullName),disabled:r,children:"Sync"})]},n.fullName))})]}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Sync Results"}),e.jsx("div",{className:"space-y-2",children:u.map((n,g)=>e.jsxs("div",{className:"rounded-lg border p-3 text-sm space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:n.repo}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.duration,"ms"]})]}),e.jsxs("div",{className:"flex gap-3 text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ke,{className:"h-3 w-3"}),n.commitsImported," commits"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Xe,{className:"h-3 w-3"}),n.prsImported," PRs"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"h-3 w-3"}),n.issuesImported," issues"]})]}),n.commitsSkipped+n.prsSkipped+n.issuesSkipped>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Skipped ",n.commitsSkipped+n.prsSkipped+n.issuesSkipped," duplicates"]}),n.errors.length>0&&e.jsxs("div",{className:"text-xs text-red-500",children:[n.errors.length," error(s)"]})]},g))})]}),s.length===0&&!t&&c&&e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No repositories found. Make sure you have repos on GitHub."})]})]})}function vs(){return e.jsxs(D,{children:[e.jsx(R,{children:e.jsx(B,{children:"About"})}),e.jsxs(I,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Personal Assistant Dashboard v0.1.0"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Built with Tauri, React, and TypeScript"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Data stored in: ~/Library/Application Support/com.personal-assistant.app/"})]})]})}function Vs(){const s=us();return e.jsxs("div",{className:"space-y-6 max-w-2xl",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Settings"})}),e.jsx(ms,{nameInput:s.nameInput,setNameInput:s.setNameInput,onSave:s.handleSaveUserName}),e.jsx(ps,{profileForm:s.profileForm,isSavingProfile:s.isSavingProfile,onUpdateField:s.updateProfileField,onIbanChange:s.handleIbanChange,formatIban:s.formatIban,onSave:s.handleSaveBusinessProfile}),e.jsx(xs,{theme:s.theme,onSetTheme:s.setTheme}),e.jsx(hs,{pathInput:s.pathInput,setPathInput:s.setPathInput,workspacePath:s.workspacePath,onSave:s.handleSaveWorkspacePath}),e.jsx(js,{defaultArea:s.defaultArea,defaultCurrency:s.defaultCurrency,onSetDefaultArea:s.setDefaultArea,onSetDefaultCurrency:s.setDefaultCurrency}),pe()&&e.jsx(fs,{backupStatus:s.backupStatus,isBackingUp:s.isBackingUp,isDownloadingBackup:s.isDownloadingBackup,isExportingJson:s.isExportingJson,onTriggerBackup:s.handleTriggerBackup,onDownloadBackup:s.handleDownloadBackup,onExportJson:s.handleExportJson}),e.jsx(ys,{}),e.jsx(gs,{dataStats:s.dataStats,totalRecords:s.totalRecords,isExporting:s.isExporting,isImporting:s.isImporting,onExport:s.handleExportData,onImport:s.handleImportData,onClearAll:s.handleClearAllData}),e.jsx(vs,{})]})}export{Vs as SettingsPage};
