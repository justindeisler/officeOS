import{r,j as e}from"./vendor-react-nkeu7MKf.js";import{C as l,c as n,a as b,b as y,d as v}from"./card-DsJqy2wh.js";import{Z as h,a as w,B as c,C as p,j as x,k as i}from"./index-D99RQVTX.js";import{S as C}from"./switch-DRKbXdNS.js";import{R as j}from"./refresh-cw-CWX0EJpK.js";import{C as k}from"./calendar-67c8PS4z.js";import{C as A}from"./circle-check-big-sVOyO8WF.js";import{P as M}from"./play-M2RykHgE.js";import{P}from"./pause-CgvYuUH5.js";import{f as o}from"./vendor-date-fns-BDn9Xvdo.js";import"./vendor-markdown-zaQAhtrl.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-DCQ-pcr5.js";import"./vendor-floating-ui-_Y3uXdsy.js";import"./vendor-router-bCYKpmtI.js";const S={cron:e.jsx(p,{className:"h-4 w-4"}),interval:e.jsx(j,{className:"h-4 w-4"}),trigger:e.jsx(h,{className:"h-4 w-4"})},H={cron:"bg-blue-500/10 text-blue-700 dark:text-blue-400",interval:"bg-purple-500/10 text-purple-700 dark:text-purple-400",trigger:"bg-orange-500/10 text-orange-700 dark:text-orange-400"};function O(){const[t,u]=r.useState([]),[f,d]=r.useState(!0),a=async()=>{d(!0);try{const s=await x.getJamesAutomations();u(s)}catch(s){console.error("Failed to fetch automations:",s),i.error("Failed to load automations")}finally{d(!1)}};r.useEffect(()=>{a()},[]);const g=async(s,m)=>{try{await x.updateJamesAutomation(s,{enabled:!m}),i.success(m?"Automation disabled":"Automation enabled"),a()}catch{i.error("Failed to update automation")}};if(f)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})});const N=t.filter(s=>s.enabled).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight flex items-center gap-2",children:[e.jsx(h,{className:"h-7 w-7"}),"Automations"]}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Scheduled jobs and automated tasks that James runs"})]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:a,children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Automations"}),e.jsx("p",{className:"text-2xl font-bold",children:t.length})]}),e.jsx(k,{className:"h-8 w-8 text-muted-foreground"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:N})]}),e.jsx(A,{className:"h-8 w-8 text-green-600"})]})})})]}),e.jsxs(l,{children:[e.jsxs(b,{children:[e.jsx(y,{className:"text-lg",children:"Scheduled Jobs"}),e.jsx(v,{children:"These automations run automatically based on their schedule"})]}),e.jsx(n,{children:t.length===0?e.jsx("p",{className:"text-muted-foreground text-sm text-center py-8",children:"No automations configured yet."}):e.jsx("div",{className:"space-y-4",children:t.map(s=>e.jsx("div",{className:`p-4 rounded-lg border bg-card ${s.enabled?"":"opacity-60"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs(c,{variant:"outline",className:H[s.type]||"",children:[S[s.type],e.jsx("span",{className:"ml-1",children:s.type})]}),s.enabled?e.jsxs(c,{variant:"outline",className:"bg-green-500/10 text-green-700 dark:text-green-400",children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(c,{variant:"outline",className:"bg-gray-500/10 text-gray-700 dark:text-gray-400",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),"Paused"]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"h-3 w-3"}),s.schedule_human||s.schedule]}),s.last_run&&e.jsxs("span",{children:["Last run: ",o(new Date(s.last_run),"MMM d, HH:mm")]}),s.next_run&&e.jsxs("span",{children:["Next: ",o(new Date(s.next_run),"MMM d, HH:mm")]})]})]}),e.jsx("div",{className:"flex items-center gap-2 shrink-0",children:e.jsx(C,{checked:!!s.enabled,onCheckedChange:()=>g(s.id,s.enabled)})})]})},s.id))})})]})]})}export{O as AutomationsPage};
