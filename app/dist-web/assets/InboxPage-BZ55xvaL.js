import{j as e,r as o}from"./vendor-react-wuMqdllU.js";import{w as Q,B as v,a as p,u as K,e as U,L as N,I as G,x as X,y as Y}from"./index-JZoliObr.js";import{T as ee,a as se,b as L,c as M}from"./tabs-Dlb0lg5z.js";import{C as ae,c as te}from"./card-ByB4Hy19.js";import{D as ie,a as ne,b as le,c as S,d as O}from"./dropdown-menu-Dcpzv9fx.js";import{C as re}from"./confirm-delete-dialog-CQVr6K2O.js";import{n as ce}from"./vendor-date-fns-D0ugVOfH.js";import{m as V,j as P,v as J,t as oe,B as de,$ as me,A as W,O as xe,z as he,K as je,N as pe,g as ge,a0 as ue,a1 as fe,Z as z,I as R,a2 as E}from"./vendor-icons-CHGo4Fp8.js";import{a as Ne}from"./vendor-router-Cm8Qzw9U.js";import{QuickCaptureDialog as ve}from"./QuickCaptureDialog-C42xbsUq.js";import{D as be,a as we,b as Ce,c as ke,d as ye,e as De}from"./dialog-BM5s3xjO.js";import{T as Se}from"./textarea-CvD7_vDa.js";import{S as T,a as _,b as I,c as F,d as c}from"./select-Btjdd6HG.js";import"./vendor-markdown-C3iCDuOK.js";import"./vendor-recharts-tRgwS7-V.js";import"./vendor-radix-BCh4MJnw.js";import"./vendor-floating-ui-BD6aHMKr.js";import"./alert-dialog-WF8eNeVO.js";const Pe={task:{icon:e.jsx(fe,{className:"h-4 w-4"}),color:"bg-blue-500/10 text-blue-500 border-blue-500/20",label:"Task"},note:{icon:e.jsx(ue,{className:"h-4 w-4"}),color:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",label:"Note"},idea:{icon:e.jsx(ge,{className:"h-4 w-4"}),color:"bg-purple-500/10 text-purple-500 border-purple-500/20",label:"Idea"},meeting:{icon:e.jsx(pe,{className:"h-4 w-4"}),color:"bg-green-500/10 text-green-500 border-green-500/20",label:"Meeting"},client_request:{icon:e.jsx(je,{className:"h-4 w-4"}),color:"bg-pink-500/10 text-pink-500 border-pink-500/20",label:"Client Request"}};function $({capture:s,onProcess:g}){const{deleteCapture:t,markProcessed:d,processWithJames:f}=Q(),m=Pe[s.type],[n,l]=o.useState(!1),x=Ne(),h=s.processingStatus==="processing",i=s.processingStatus==="completed"||s.processed,b=s.processingStatus==="failed",C=()=>{t(s.id),l(!1)},k=()=>{d(s.id,"dismissed")},j=()=>{f(s.id)},y=()=>{s.artifactType==="task"&&s.artifactId?x(`/tasks?highlight=${s.artifactId}`):s.artifactType};return e.jsxs(ae,{className:`group ${i?"opacity-60":""}`,children:[e.jsx(te,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${m.color}`,children:m.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx(v,{variant:"outline",className:m.color,children:m.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ce(new Date(s.createdAt),{addSuffix:!0})}),h&&e.jsxs(v,{variant:"secondary",className:"text-xs bg-blue-500/10 text-blue-500 border-blue-500/20",children:[e.jsx(V,{className:"h-3 w-3 mr-1 animate-spin"}),"James is processing..."]}),i&&s.processedBy==="james"&&e.jsxs(v,{variant:"secondary",className:"text-xs bg-green-500/10 text-green-500 border-green-500/20",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),"Processed by James"]}),i&&s.processedBy!=="james"&&e.jsxs(v,{variant:"secondary",className:"text-xs",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"Processed"]}),b&&e.jsxs(v,{variant:"destructive",className:"text-xs",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Failed"]})]}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.content}),s.type==="client_request"&&s.metadata&&e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs",children:[s.metadata.client_name&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-md bg-pink-500/10 text-pink-700 dark:text-pink-400",children:[e.jsx(de,{className:"h-3 w-3"}),s.metadata.client_name]}),s.metadata.client_email&&e.jsx("span",{className:"text-muted-foreground",children:s.metadata.client_email})]}),i&&s.artifactId&&s.artifactType&&e.jsx("div",{className:"mt-2",children:e.jsxs(p,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-muted-foreground hover:text-foreground",onClick:y,children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"View created ",s.artifactType==="calendar_event"?"calendar event":s.artifactType]})})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[!i&&!h&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>g(s),children:[e.jsx(W,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Process"})]}),e.jsxs(p,{variant:"default",size:"sm",onClick:j,className:"bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(P,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"James"})]})]}),h&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 text-sm text-muted-foreground",children:[e.jsx(V,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Processing..."})]}),e.jsxs(ie,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"h-10 w-10 min-h-[44px] min-w-[44px] opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity",children:e.jsx(xe,{className:"h-4 w-4"})})}),e.jsxs(le,{align:"end",children:[!i&&!h&&e.jsxs(e.Fragment,{children:[e.jsxs(S,{onClick:j,children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Process with James"]}),e.jsxs(S,{onClick:k,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Mark as Done"]}),e.jsx(O,{})]}),b&&e.jsxs(e.Fragment,{children:[e.jsxs(S,{onClick:j,children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Retry with James"]}),e.jsx(O,{})]}),e.jsxs(S,{onClick:()=>l(!0),className:"text-destructive focus:text-destructive",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]})}),e.jsx(re,{open:n,onOpenChange:l,title:"Delete capture?",description:"This will permanently delete this capture. This action cannot be undone.",onConfirm:C})]})}function Te({open:s,onOpenChange:g,capture:t,onClose:d}){const{markProcessed:f}=Q(),{addTask:m}=K(),{projects:n}=U(),[l,x]=o.useState(""),[h,i]=o.useState(""),[b,C]=o.useState("backlog"),[k,j]=o.useState(2),[y,D]=o.useState("freelance"),[B,w]=o.useState(void 0),q=(t==null?void 0:t.type)==="client_request",u=t==null?void 0:t.metadata;o.useEffect(()=>{if(t)if(t.type==="client_request"&&t.metadata){if(x(t.metadata.original_title||""),i(t.metadata.original_description||""),t.metadata.project_id){const a=n.find(r=>r.id===t.metadata.project_id);a&&(w(a.id),D(a.area))}j(2)}else{const a=t.content.split(`
`),r=a[0]||"",A=a.slice(1).join(`
`).trim();x(r),i(A),w(void 0),t.type==="meeting"?j(1):j(2)}},[t,s,n]);const H=a=>{if(a.preventDefault(),!l.trim()||!t)return;const r={title:l.trim(),description:h.trim()||void 0,status:b,priority:k,area:y,projectId:B};q&&u&&(r.quickCapture=!0,r.createdBy=u.client_email,r.originalCapture=t.id),m(r),f(t.id,"task"),x(""),i(""),C("backlog"),j(2),D("freelance"),w(void 0),d()},Z=()=>{t&&f(t.id,"dismissed"),d()};return e.jsx(be,{open:s,onOpenChange:g,children:e.jsx(we,{className:"w-[calc(100vw-2rem)] max-w-[500px] max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:H,children:[e.jsxs(Ce,{children:[e.jsxs(ke,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"Process Capture"]}),e.jsx(ye,{children:"Convert this capture into a task or dismiss it."})]}),q&&u&&e.jsx("div",{className:"bg-pink-500/10 border border-pink-500/20 rounded-lg p-3 my-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-pink-700 dark:text-pink-400",children:[e.jsx("span",{className:"font-medium",children:"Client Request"}),u.client_name&&e.jsxs("span",{children:["from ",u.client_name]}),u.client_email&&e.jsxs("span",{className:"text-muted-foreground",children:["(",u.client_email,")"]})]})}),t&&!q&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 my-4 text-sm",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Original capture:"}),e.jsx("p",{className:"whitespace-pre-wrap",children:t.content})]}),e.jsxs("div",{className:"grid gap-4 py-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"title",children:"Task Title"}),e.jsx(G,{id:"title",value:l,onChange:a=>x(a.target.value),placeholder:"Task title...",autoFocus:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"description",children:"Description"}),e.jsx(Se,{id:"description",value:h,onChange:a=>i(a.target.value),placeholder:"Additional details...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"status",children:"Status"}),e.jsxs(T,{value:b,onValueChange:a=>C(a),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(c,{value:"backlog",children:"Backlog"}),e.jsx(c,{value:"queue",children:"Queue"}),e.jsx(c,{value:"in_progress",children:"In Progress"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"priority",children:"Priority"}),e.jsxs(T,{value:String(k),onValueChange:a=>j(Number(a)),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(c,{value:"1",children:"High"}),e.jsx(c,{value:"2",children:"Medium"}),e.jsx(c,{value:"3",children:"Low"})]})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"area",children:"Area"}),e.jsxs(T,{value:y,onValueChange:a=>D(a),children:[e.jsx(_,{children:e.jsx(I,{})}),e.jsxs(F,{children:[e.jsx(c,{value:"wellfy",children:"Wellfy"}),e.jsx(c,{value:"freelance",children:"Freelance"}),e.jsx(c,{value:"personal",children:"Personal"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"project",children:"Project (optional)"}),e.jsxs(T,{value:B||"none",onValueChange:a=>{if(a==="none")w(void 0);else{w(a);const r=n.find(A=>A.id===a);r&&D(r.area)}},children:[e.jsx(_,{children:e.jsx(I,{placeholder:"Select a project..."})}),e.jsxs(F,{children:[e.jsx(c,{value:"none",children:"No project"}),n.filter(a=>a.status==="active"||a.status==="pipeline").map(a=>e.jsx(c,{value:a.id,children:a.name},a.id))]})]})]})]}),e.jsxs(De,{className:"flex justify-between mt-4",children:[e.jsx(p,{type:"button",variant:"ghost",onClick:Z,children:"Dismiss"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(p,{type:"submit",disabled:!l.trim(),children:"Create Task"})]})]})]})})})}function Ze(){const[s,g]=o.useState(!1),[t,d]=o.useState(!1),[f,m]=o.useState(null),n=X(),l=Y(),x=i=>{m(i),d(!0)},h=()=>{d(!1),m(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Inbox"})}),e.jsxs(p,{onClick:()=>g(!0),className:"w-full sm:w-auto min-h-[44px]",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Quick Capture"]})]}),e.jsxs(ee,{defaultValue:"unprocessed",className:"w-full",children:[e.jsxs(se,{children:[e.jsxs(L,{value:"unprocessed",className:"gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Inbox",n.length>0&&e.jsx(v,{variant:"secondary",className:"ml-1",children:n.length})]}),e.jsxs(L,{value:"processed",className:"gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Processed"]})]}),e.jsx(M,{value:"unprocessed",className:"mt-4",children:n.length===0?e.jsxs("div",{className:"rounded-lg border bg-card p-12 text-center",children:[e.jsx(R,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Inbox zero!"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"All captures have been processed. Nice work!"}),e.jsxs(p,{onClick:()=>g(!0),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Capture Something"]})]}):e.jsx("div",{className:"space-y-3",children:n.map(i=>e.jsx($,{capture:i,onProcess:x},i.id))})}),e.jsx(M,{value:"processed",className:"mt-4",children:l.length===0?e.jsxs("div",{className:"rounded-lg border bg-card p-12 text-center",children:[e.jsx(E,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No processed captures"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Processed captures will appear here."})]}):e.jsx("div",{className:"space-y-3",children:l.map(i=>e.jsx($,{capture:i,onProcess:x},i.id))})})]}),e.jsx(ve,{open:s,onOpenChange:g}),e.jsx(Te,{open:t,onOpenChange:d,capture:f,onClose:h})]})}export{Ze as InboxPage};
