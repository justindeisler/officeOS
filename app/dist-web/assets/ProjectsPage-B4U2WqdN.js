import{r,j as e}from"./vendor-react-nkeu7MKf.js";import{f as H,g as ae,B as _,D as le,a as u,o as Y,u as ne,L as x,I as k,l as re,x as ie}from"./index-CJ4fj71d.js";import{S as p,a as j,b as f,c as v,d as n}from"./select-Dd7vmkLO.js";import{C as de,c as oe}from"./card-BM-6Aljj.js";import{D as ce,a as me,b as xe,c as R,d as ue}from"./dropdown-menu-yktQBQE2.js";import{C as q}from"./confirm-delete-dialog-BZdkYIVy.js";import{C as he}from"./calendar-BkRn3Kwz.js";import{E as ge}from"./ellipsis-VrwO2S--.js";import{E as pe}from"./external-link-CqRfk1sj.js";import{P as je}from"./pen-TVVkneXC.js";import{T as J}from"./trash-2-BxcYN-z3.js";import{L as W}from"./vendor-router-bCYKpmtI.js";import{f as S,o as fe}from"./vendor-date-fns-D0ugVOfH.js";import{D as ve,a as we,b as ye,c as be,d as De,e as Ne}from"./dialog-C8XP0moa.js";import{T as Ce}from"./textarea-DDuGbwvN.js";import{a as Se,g as Pe,d as Ee}from"./markdown-DZSA0cWY.js";import{D as ke}from"./download-Fr7kZ0XN.js";import{P as K}from"./plus-DxV0H5cT.js";import"./vendor-markdown-zaQAhtrl.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-Oq5tdvA1.js";import"./vendor-floating-ui-_Y3uXdsy.js";import"./chevron-right-BPJdtVA8.js";import"./circle-CqsrXPRW.js";import"./alert-dialog-CbG9z7pG.js";const Ie={pipeline:"bg-blue-500/10 text-blue-500 border-blue-500/20",active:"bg-green-500/10 text-green-500 border-green-500/20",on_hold:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",completed:"bg-gray-500/10 text-gray-500 border-gray-500/20",cancelled:"bg-red-500/10 text-red-500 border-red-500/20"},Ae={pipeline:"Pipeline",active:"Active",on_hold:"On Hold",completed:"Completed",cancelled:"Cancelled"},Me={wellfy:"bg-purple-500/10 text-purple-500 border-purple-500/20",freelance:"bg-orange-500/10 text-orange-500 border-orange-500/20",personal:"bg-cyan-500/10 text-cyan-500 border-cyan-500/20"};function Fe(t,i){return new Intl.NumberFormat("de-DE",{style:"currency",currency:i}).format(t)}function Te({project:t,onEdit:i}){const{deleteProject:s}=H(),o=ae(t.clientId||""),[w,d]=r.useState(!1),y=()=>{s(t.id),d(!1)};return e.jsxs(de,{className:"group",children:[e.jsx(oe,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx(W,{to:`/projects/${t.id}`,className:"font-medium truncate hover:underline hover:text-primary",children:t.name})}),o&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:o.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsx(_,{variant:"outline",className:Ie[t.status],children:Ae[t.status]}),e.jsx(_,{variant:"outline",className:Me[t.area],children:t.area})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[t.budgetAmount&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"h-3 w-3"}),Fe(t.budgetAmount,t.budgetCurrency)]}),t.targetEndDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"h-3 w-3"}),S(new Date(t.targetEndDate),"MMM d, yyyy")]})]})]}),e.jsxs(ce,{children:[e.jsx(me,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ge,{className:"h-4 w-4"})})}),e.jsxs(xe,{align:"end",children:[e.jsx(R,{asChild:!0,children:e.jsxs(W,{to:`/projects/${t.id}`,children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"View Details"]})}),e.jsxs(R,{onClick:()=>i(t),children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsx(ue,{}),e.jsxs(R,{onClick:()=>d(!0),className:"text-destructive focus:text-destructive",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})}),e.jsx(q,{open:w,onOpenChange:d,title:`Delete "${t.name}"?`,description:"This will permanently delete the project. This action cannot be undone.",onConfirm:y})]})}function Be({open:t,onOpenChange:i,project:s,onClose:o}){const{addProject:w,updateProject:d,deleteProject:y}=H(),{clients:h}=Y(),{tasks:P}=ne(),[b,D]=r.useState(""),[g,N]=r.useState(""),[a,c]=r.useState("none"),[m,I]=r.useState("pipeline"),[z,A]=r.useState("freelance"),[M,F]=r.useState(""),[G,T]=r.useState("EUR"),[B,O]=r.useState(""),[V,U]=r.useState(""),[Q,$]=r.useState(!1),C=!!s;r.useEffect(()=>{var l;s?(D(s.name),N(s.description||""),c(s.clientId||"none"),I(s.status),A(s.area),F(((l=s.budgetAmount)==null?void 0:l.toString())||""),T(s.budgetCurrency),O(s.startDate?S(new Date(s.startDate),"yyyy-MM-dd"):""),U(s.targetEndDate?S(new Date(s.targetEndDate),"yyyy-MM-dd"):"")):(D(""),N(""),c("none"),I("pipeline"),A("freelance"),F(""),T("EUR"),O(S(new Date,"yyyy-MM-dd")),U(S(fe(new Date,1),"yyyy-MM-dd")))},[s,t]);const X=l=>{if(l.preventDefault(),!b.trim())return;const E={name:b.trim(),description:g.trim()||void 0,clientId:a==="none"?void 0:a,status:m,area:z,budgetAmount:M?parseFloat(M):void 0,budgetCurrency:G,startDate:B?new Date(B).toISOString():void 0,targetEndDate:V?new Date(V).toISOString():void 0};C&&s?d(s.id,E):w(E),o()},Z=()=>{s&&(y(s.id),$(!1),o())},ee=()=>{if(!s)return;const l=s.clientId?h.find(L=>L.id===s.clientId):void 0,E=P.filter(L=>L.projectId===s.id),se=Se(s,{client:l,tasks:E}),te=Pe(s.name);Ee(se,te),re.success(`Exported "${s.name}" to markdown`)};return e.jsx(ve,{open:t,onOpenChange:i,children:e.jsxs(we,{className:"w-[calc(100vw-2rem)] max-w-[500px] max-h-[90vh] overflow-y-auto",children:[e.jsxs("form",{onSubmit:X,children:[e.jsxs(ye,{children:[e.jsx(be,{children:C?"Edit Project":"New Project"}),e.jsx(De,{children:C?"Update the project details below.":"Create a new project to track work and time."})]}),e.jsxs("div",{className:"grid gap-4 py-4 max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"name",children:"Name *"}),e.jsx(k,{id:"name",value:b,onChange:l=>D(l.target.value),placeholder:"Project name...",autoFocus:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"description",children:"Description"}),e.jsx(Ce,{id:"description",value:g,onChange:l=>N(l.target.value),placeholder:"Project description...",rows:2})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"client",children:"Client"}),e.jsxs(p,{value:a,onValueChange:c,children:[e.jsx(j,{children:e.jsx(f,{placeholder:"Select a client..."})}),e.jsxs(v,{children:[e.jsx(n,{value:"none",children:"No client"}),h.map(l=>e.jsx(n,{value:l.id,children:l.name},l.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"status",children:"Status"}),e.jsxs(p,{value:m,onValueChange:l=>I(l),children:[e.jsx(j,{children:e.jsx(f,{})}),e.jsxs(v,{children:[e.jsx(n,{value:"pipeline",children:"Pipeline"}),e.jsx(n,{value:"active",children:"Active"}),e.jsx(n,{value:"on_hold",children:"On Hold"}),e.jsx(n,{value:"completed",children:"Completed"}),e.jsx(n,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"area",children:"Area"}),e.jsxs(p,{value:z,onValueChange:l=>A(l),children:[e.jsx(j,{children:e.jsx(f,{})}),e.jsxs(v,{children:[e.jsx(n,{value:"wellfy",children:"Wellfy"}),e.jsx(n,{value:"freelance",children:"Freelance"}),e.jsx(n,{value:"personal",children:"Personal"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"budgetAmount",children:"Budget"}),e.jsx(k,{id:"budgetAmount",type:"number",min:"0",step:"0.01",value:M,onChange:l=>F(l.target.value),placeholder:"0.00"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"currency",children:"Currency"}),e.jsxs(p,{value:G,onValueChange:T,children:[e.jsx(j,{children:e.jsx(f,{})}),e.jsxs(v,{children:[e.jsx(n,{value:"EUR",children:"EUR"}),e.jsx(n,{value:"USD",children:"USD"}),e.jsx(n,{value:"GBP",children:"GBP"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"startDate",children:"Start Date"}),e.jsx(k,{id:"startDate",type:"date",value:B,onChange:l=>O(l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"targetEndDate",children:"Target End Date"}),e.jsx(k,{id:"targetEndDate",type:"date",value:V,onChange:l=>U(l.target.value)})]})]})]}),e.jsxs(Ne,{className:"flex justify-between",children:[C&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{type:"button",variant:"destructive",size:"sm",onClick:()=>$(!0),children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),"Delete"]}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:ee,children:[e.jsx(ke,{className:"h-4 w-4 mr-1"}),"Export"]})]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsx(u,{type:"button",variant:"outline",onClick:o,children:"Cancel"}),e.jsx(u,{type:"submit",children:C?"Save":"Create"})]})]})]},(s==null?void 0:s.id)??`new-${t}`),e.jsx(q,{open:Q,onOpenChange:$,title:`Delete ${s==null?void 0:s.name}?`,description:"This will permanently delete the project. This action cannot be undone.",onConfirm:Z})]})})}const Oe=[{id:"pipeline",title:"Pipeline",color:"bg-blue-500"},{id:"active",title:"Active",color:"bg-green-500"},{id:"on_hold",title:"On Hold",color:"bg-yellow-500"},{id:"completed",title:"Completed",color:"bg-gray-500"}];function ds(){const{projects:t,filter:i,setFilter:s}=H(),{clients:o}=Y(),[w,d]=r.useState(!1),[y,h]=r.useState(null),P=()=>{h(null),d(!0)},b=a=>{h(a),d(!0)},D=()=>{d(!1),h(null)},g=r.useMemo(()=>{const a=t.filter(m=>!(i.area!=="all"&&m.area!==i.area||i.clientId!=="all"&&m.clientId!==i.clientId)),c={pipeline:[],active:[],on_hold:[],completed:[],cancelled:[]};return a.forEach(m=>{m.status!=="cancelled"&&c[m.status].push(m)}),c},[t,i]),N=t.filter(a=>a.status!=="cancelled").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight",children:"Projects"})}),e.jsxs(u,{onClick:P,className:"w-full sm:w-auto",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"New Project"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs(p,{value:i.area,onValueChange:a=>s({area:a}),children:[e.jsx(j,{className:"w-[150px]",children:e.jsx(f,{placeholder:"All Areas"})}),e.jsxs(v,{children:[e.jsx(n,{value:"all",children:"All Areas"}),e.jsx(n,{value:"wellfy",children:"Wellfy"}),e.jsx(n,{value:"freelance",children:"Freelance"}),e.jsx(n,{value:"personal",children:"Personal"})]})]}),o.length>0&&e.jsxs(p,{value:i.clientId,onValueChange:a=>s({clientId:a}),children:[e.jsx(j,{className:"w-[180px]",children:e.jsx(f,{placeholder:"All Clients"})}),e.jsxs(v,{children:[e.jsx(n,{value:"all",children:"All Clients"}),o.map(a=>e.jsx(n,{value:a.id,children:a.name},a.id))]})]})]}),N===0?e.jsxs("div",{className:"rounded-lg border bg-card p-12 text-center",children:[e.jsx(ie,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No projects yet"}),e.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Create your first project to start tracking work."}),e.jsxs(u,{onClick:P,children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"New Project"]})]}):e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 md:grid md:grid-cols-2 lg:grid-cols-4 md:overflow-visible md:pb-0",children:Oe.map(a=>e.jsxs("div",{className:"min-w-[280px] flex-shrink-0 md:min-w-0 rounded-lg border bg-muted/30 p-4 min-h-[400px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${a.color}`}),e.jsx("h3",{className:"font-medium",children:a.title})]}),e.jsx(_,{variant:"secondary",children:g[a.id].length})]}),e.jsx("div",{className:"space-y-3",children:g[a.id].length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No projects"}):g[a.id].map(c=>e.jsx(Te,{project:c,onEdit:b},c.id))})]},a.id))}),e.jsx(Be,{open:w,onOpenChange:d,project:y,onClose:D})]})}export{ds as ProjectsPage};
