import{r as a,j as e}from"./vendor-react-nkeu7MKf.js";import{C as m,c as x,a as D,b as E}from"./card-BM-6Aljj.js";import{a as b,B as v,n as o,m as M,l as R,F as I,E as B}from"./index-CJ4fj71d.js";import{S as w,a as _,b as k,c as S,d as r}from"./select-Dd7vmkLO.js";import{A as u}from"./activity-CTwpCRSg.js";import{R as J}from"./refresh-cw-Bk2Etu6z.js";import{F as P}from"./filter-Bx0rbSBd.js";import{C as V}from"./calendar-BkRn3Kwz.js";import{S as H}from"./sparkles-DRLIDyV8.js";import{f as p,n as O}from"./vendor-date-fns-D0ugVOfH.js";import"./vendor-markdown-zaQAhtrl.js";import"./vendor-recharts-COauwCrp.js";import"./vendor-radix-Oq5tdvA1.js";import"./vendor-floating-ui-_Y3uXdsy.js";import"./vendor-router-bCYKpmtI.js";const z={analysis:e.jsx(H,{className:"h-4 w-4"}),suggestion:e.jsx(B,{className:"h-4 w-4"}),prd_created:e.jsx(I,{className:"h-4 w-4"}),task_created:e.jsx(o,{className:"h-4 w-4"}),implementation:e.jsx(o,{className:"h-4 w-4"}),decision:e.jsx(u,{className:"h-4 w-4"}),automation:e.jsx(o,{className:"h-4 w-4"})},q={analysis:"bg-blue-500/10 text-blue-700 dark:text-blue-400 border-blue-200",suggestion:"bg-yellow-500/10 text-yellow-700 dark:text-yellow-400 border-yellow-200",prd_created:"bg-purple-500/10 text-purple-700 dark:text-purple-400 border-purple-200",task_created:"bg-green-500/10 text-green-700 dark:text-green-400 border-green-200",implementation:"bg-emerald-500/10 text-emerald-700 dark:text-emerald-400 border-emerald-200",decision:"bg-indigo-500/10 text-indigo-700 dark:text-indigo-400 border-indigo-200",automation:"bg-cyan-500/10 text-cyan-700 dark:text-cyan-400 border-cyan-200"},C={analysis:"Analysis",suggestion:"Suggestion",prd_created:"PRD Created",task_created:"Task Created",implementation:"Implementation",decision:"Decision",automation:"Automation"};function ie(){const[i,A]=a.useState([]),[h,j]=a.useState([]),[T,g]=a.useState(!0),[d,L]=a.useState("all"),[l,f]=a.useState(50),y=async()=>{g(!0);try{const s=await M.getJamesActions({limit:l});A(s)}catch(s){console.error("Failed to fetch actions:",s),R.error("Failed to load activity")}finally{g(!1)}};a.useEffect(()=>{y()},[l]),a.useEffect(()=>{j(d==="all"?i:i.filter(s=>s.action_type===d))},[i,d]);const n=h.reduce((s,t)=>{const c=p(new Date(t.created_at),"yyyy-MM-dd");return s[c]||(s[c]=[]),s[c].push(t),s},{}),N=Object.keys(n).sort((s,t)=>t.localeCompare(s)),F=[...new Set(i.map(s=>s.action_type))];return e.jsx(e.Fragment,{children:T?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-semibold tracking-tight flex items-center gap-2",children:[e.jsx(u,{className:"h-7 w-7"}),"Activity Log"]}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:"Audit trail of James's actions and decisions"})]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:y,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsx(m,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Filters:"})]}),e.jsxs(w,{value:d,onValueChange:L,children:[e.jsx(_,{className:"w-[180px]",children:e.jsx(k,{placeholder:"Action Type"})}),e.jsxs(S,{children:[e.jsx(r,{value:"all",children:"All Types"}),F.map(s=>e.jsx(r,{value:s,children:C[s]||s},s))]})]}),e.jsxs(w,{value:String(l),onValueChange:s=>f(parseInt(s)),children:[e.jsx(_,{className:"w-[120px]",children:e.jsx(k,{placeholder:"Limit"})}),e.jsxs(S,{children:[e.jsx(r,{value:"25",children:"Last 25"}),e.jsx(r,{value:"50",children:"Last 50"}),e.jsx(r,{value:"100",children:"Last 100"}),e.jsx(r,{value:"200",children:"Last 200"})]})]})]})})}),N.length===0?e.jsx(m,{children:e.jsx(x,{className:"py-12",children:e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx(u,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No activity recorded yet."})]})})}):e.jsx("div",{className:"space-y-6",children:N.map(s=>e.jsxs(m,{children:[e.jsx(D,{className:"py-3",children:e.jsxs(E,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),p(new Date(s),"EEEE, MMMM d, yyyy"),e.jsxs(v,{variant:"secondary",className:"ml-auto",children:[n[s].length," action",n[s].length!==1?"s":""]})]})}),e.jsx(x,{children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-[17px] top-0 bottom-0 w-px bg-border"}),e.jsx("div",{className:"space-y-4",children:n[s].map((t,c)=>e.jsxs("div",{className:"relative flex gap-4",children:[e.jsx("div",{className:"relative z-10 flex h-9 w-9 shrink-0 items-center justify-center rounded-full border bg-background",children:z[t.action_type]||e.jsx(o,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(v,{variant:"outline",className:q[t.action_type]||"",children:C[t.action_type]||t.action_type}),e.jsx("span",{className:"text-xs text-muted-foreground",children:p(new Date(t.created_at),"HH:mm")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",O(new Date(t.created_at),{addSuffix:!0}),")"]})]}),e.jsx("p",{className:"mt-1 text-sm",children:t.description}),(t.project_id||t.task_id||t.suggestion_id||t.prd_id)&&e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs text-muted-foreground",children:[t.project_id&&e.jsxs("span",{className:"bg-muted px-2 py-0.5 rounded",children:["Project: ",t.project_id.slice(0,8),"..."]}),t.task_id&&e.jsxs("span",{className:"bg-muted px-2 py-0.5 rounded",children:["Task: ",t.task_id.slice(0,8),"..."]}),t.suggestion_id&&e.jsxs("span",{className:"bg-muted px-2 py-0.5 rounded",children:["Suggestion: ",t.suggestion_id.slice(0,8),"..."]}),t.prd_id&&e.jsxs("span",{className:"bg-muted px-2 py-0.5 rounded",children:["PRD: ",t.prd_id.slice(0,8),"..."]})]}),t.metadata&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs text-muted-foreground cursor-pointer hover:text-foreground",children:"View metadata"}),e.jsx("pre",{className:"mt-1 p-2 bg-muted rounded text-xs overflow-x-auto",children:JSON.stringify(JSON.parse(t.metadata),null,2)})]})]})]},t.id))})]})})]},s))}),h.length>=l&&e.jsx("div",{className:"text-center",children:e.jsx(b,{variant:"outline",onClick:()=>f(l+50),children:"Load More"})})]})})}export{ie as ActivityPage};
